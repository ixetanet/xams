"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[187],{9187:function(e,l,a){a.r(l),a.d(l,{default:function(){return v}});var t=a(4558),d=a(9496),i=a(9228),u=a(7152),o=a(2268),n=a(7378);a(7693),a(8311),a(8);let r=(0,n.forwardRef)((e,l)=>{let{image:a,label:t,description:u,...o}=e;return n.createElement("div",{ref:l,...o},n.createElement(d.Z,{noWrap:!0},n.createElement("div",null,n.createElement(i.x,{size:"sm"},t),n.createElement(i.x,{size:"xs",opacity:.65},u))))}),v=(0,n.forwardRef)((e,l)=>{let a=(0,n.useRef)(null),d=(0,t.eG)(),[i,v]=(0,n.useState)(void 0!==e.defaultLabelValue?e.defaultLabelValue:null),[s,m]=(0,n.useState)(void 0!==e.defaultLabelValue?[e.defaultLabelValue]:[]),[c,f]=n.useState(null),[b]=(0,o.c)(c,300,{leading:!0});for(let t of((0,n.useImperativeHandle)(l,()=>a.current),(0,n.useEffect)(()=>{null===b||["CreatedById","UpdatedById"].includes(e.metaDataField.name)||(async()=>{var l,a,t,u,o;let n=["".concat(e.metaDataField.lookupTable,"Id"),e.metaDataField.lookupTableNameField];null!=e.metaDataField.lookupTableDescriptionField&&n.push(e.metaDataField.lookupTableDescriptionField),""!==e.metaDataField.option&&n.push("Value");let r=await d.read({tableName:e.metaDataField.lookupTable,maxResults:20,page:1,fields:n,orderBy:[...""!==e.metaDataField.option?[{field:"Order",order:"asc"}]:[],{field:e.metaDataField.lookupTableNameField,order:null===(l=e.query)||void 0===l?void 0:l.order}],filters:[{field:e.metaDataField.lookupTableNameField,value:null!=i&&i.label===b?"":b},...null!==(o=null===(a=e.query)||void 0===a?void 0:a.filters)&&void 0!==o?o:[],...""!==e.metaDataField.option?[{field:"Name",value:e.metaDataField.option}]:[]],joins:null===(t=e.query)||void 0===t?void 0:t.joins,except:null===(u=e.query)||void 0===u?void 0:u.except,..."OwningUserId"===e.metaDataField.name||"OwningTeamId"===e.metaDataField.name?{parameters:{isOwnerField:!0,tableName:e.owningTableName}}:{}});if(!r||!r.succeeded)return;let v=r.data.results.map(l=>({value:"".concat(l["".concat(e.metaDataField.lookupTable,"Id")]),label:l[e.metaDataField.lookupTableNameField],...null!=e.metaDataField.lookupTableDescriptionField?{description:"".concat(l[e.metaDataField.lookupTableDescriptionField])}:{},...""!==e.metaDataField.option?{data:l.Value}:{}}));void 0!==e.excludeValues&&(v=v.filter(l=>{var a;return void 0===(null===(a=e.excludeValues)||void 0===a?void 0:a.find(e=>e===l.value))})),null!=i&&void 0===v.find(e=>e.value===(null==i?void 0:i.value))&&v.push(i),m(v=v.map(e=>(void 0===e.label&&(e.label=e.value),e)))})()},[b]),(0,n.useEffect)(()=>{void 0!==e.defaultLabelValue&&void 0===s.find(l=>{var a;return l.value===(null===(a=e.defaultLabelValue)||void 0===a?void 0:a.value)})&&m([...s,e.defaultLabelValue])},[e.defaultLabelValue]),s))null==t.label&&(t.label=t.value);return n.createElement(u.Ph,{label:e.label,data:s,className:e.className,itemComponent:null!=e.metaDataField.lookupTableDescriptionField?r:void 0,defaultValue:void 0!==e.defaultLabelValue?e.defaultLabelValue.value:void 0,value:e.value,onSearchChange:f,onChange:l=>{var a,t,d,i,u;void 0!==e.onChange&&e.onChange({id:l,value:null!==(d=null===(a=s.find(e=>e.value===l))||void 0===a?void 0:a.data)&&void 0!==d?d:null,label:null!==(i=null===(t=s.find(e=>e.value===l))||void 0===t?void 0:t.label)&&void 0!==i?i:null}),v(null!==(u=s.find(e=>e.value===l))&&void 0!==u?u:null)},onBlur:e.onBlur,searchable:!0,clearable:e.metaDataField.isNullable,ref:a,readOnly:e.readOnly,withAsterisk:e.required,error:e.error,disabled:e.disabled})});v.displayName="XLookup"}}]);