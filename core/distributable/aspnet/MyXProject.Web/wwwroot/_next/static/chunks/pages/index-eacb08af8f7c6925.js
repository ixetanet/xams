(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{9536:function(e,t,l){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return l(4269)}])},4269:function(e,t,l){"use strict";l.r(t),l.d(t,{default:function(){return eO}});var s=l(4246),a=l(5381),i=l(7628),o=l(9888),r=l(435),n=l(226),d=l(5213),u=l(3260),c=l(7378),m=l(1879),p=l(1331),f=l(6731),h=l(2053),v=l(6283),x=e=>{let t=(0,a.Z)(),[l,o]=c.useState([]),[r,d]=c.useState(!0),m=async()=>{d(!0),await t.execute({url:p.k0,method:"POST",body:{name:"ADMIN_ExportData",parameters:{tables:l.filter(e=>!0===e.checked).map(e=>({name:e.Name,dependencies:e.Dependencies.filter(e=>!0===e.checked).map(e=>({name:e.Name}))}))}},fileName:"export_".concat(new Date().toLocaleString().replaceAll(" ",""),".json")}),e.close()},x=async()=>{d(!0);let e=await t.execute({url:p.k0,method:"POST",body:{name:"ADMIN_ExportDependencies"}});if((null==e?void 0:e.succeeded)===!0){let t=e.data;for(let e of t)for(let t of(e.checked=!1,e.Dependencies))t.checked=!1,t.disabled=!1;o(t)}d(!1)},y=(e,t)=>{let l=!1;for(let s of e)if(s.Name===t){l=!s.checked;break}let s=e.map(e=>e);g(t,s,[],l),o(s)},g=(e,t,l,s)=>{if(!l.includes(e))for(let a of(l.push(e),t))if(a.Name===e)for(let e of(a.checked=s,a.disabled=!1,a.Dependencies))!1===e.Optional&&(e.checked=s,e.disabled=s,g(e.Name,t,l,s));else for(let t of a.Dependencies)t.Name===e&&(t.checked=s,t.disabled=s)};return(0,c.useEffect)(()=>{!0===e.opened&&(d(!1),o([]),x())},[e.opened]),(0,s.jsxs)(f.u,{opened:e.opened,onClose:e.close,title:"Export Data",styles:{body:{overflow:"hidden",position:"relative",padding:"0px"}},centered:!0,children:[!0===r&&(0,s.jsx)("div",{className:"absolute w-full h-full flex justify-center items-center overflow-hidden z-30",children:(0,s.jsx)(i.a,{})}),(0,s.jsxs)("div",{className:"p-4 ".concat(r?"invisible":""),children:[(0,s.jsx)(u.x,{h:650,children:(0,s.jsx)("div",{className:" pl-2 flex flex-col gap-2",children:l.map(e=>(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{children:(0,s.jsx)(h.X,{styles:{input:{cursor:"pointer"},label:{cursor:"pointer"}},checked:e.checked,disabled:e.disabled,onChange:()=>{},onClick:()=>{y(l,e.Name)},label:e.Name})}),(0,s.jsx)("div",{className:"flex flex-col gap-1",children:e.Dependencies.map(e=>(0,s.jsx)("div",{className:"ml-8",children:(0,s.jsx)(h.X,{styles:{input:{cursor:"pointer"},label:{cursor:"pointer"}},label:e.Name,checked:e.checked,onChange:()=>{},disabled:e.disabled,onClick:()=>y(l,e.Name)})},"".concat(v.Z.name,"-").concat(e.Name)))})]},e.Name))})}),(0,s.jsx)("div",{className:"w-full flex justify-end mt-4",children:(0,s.jsx)(n.z,{onClick:m,children:"Export"})})]})]})},y=l(8676),g=e=>{let t=(0,a.Z)(),[l,o]=c.useState(null),[r,d]=c.useState(!1),u=async()=>{if(null===l)return;d(!0);let s=new FormData;s.append("file",l),s.append("name","ADMIN_ImportData"),await t.execute({url:p.mH,method:"POST",body:s}),e.close()};return(0,c.useEffect)(()=>{!0===e.opened&&(d(!1),o(null))},[e.opened]),(0,s.jsxs)(f.u,{opened:e.opened,onClose:e.close,size:"md",title:"Import Data",closeOnEscape:!r,closeOnClickOutside:!r,withCloseButton:!r,styles:{body:{overflow:"hidden",position:"relative",padding:"0px"}},centered:!0,children:[!0===r&&(0,s.jsx)("div",{className:"absolute w-full h-full  flex justify-center items-center overflow-hidden z-30",children:(0,s.jsx)(i.a,{})}),(0,s.jsxs)("div",{className:"p-4 ".concat(r?"invisible":""),children:[(0,s.jsx)(y.S,{label:"File Upload",placeholder:"Click to choose data file",required:!0,value:l,onChange:e=>{o(e)}}),(0,s.jsx)("div",{className:"w-full flex justify-end mt-4",children:(0,s.jsx)(n.z,{onClick:u,disabled:null===l,children:"Upload"})})]})]})},b=l(7302),N=l(823),j=l(6164),I=l(8540),w=l(4215),E=()=>{let e=(0,b.rZ)(),{colorScheme:t,toggleColorScheme:l}=(0,N.X)(),a="dark"===t;return(0,s.jsx)(j.A,{variant:"outline",color:a?"yellow":e.fn.primaryColor(),onClick:()=>l(),title:"Toggle color scheme",children:a?(0,s.jsx)(I.Z,{size:"1.1rem"}):(0,s.jsx)(w.Z,{size:"1.1rem"})})},C=l(9572),T=l(2975),R=l(806);let A=c.lazy(()=>Promise.resolve().then(l.bind(l,2670))),S=(0,c.forwardRef)((e,t)=>{let[l,a]=(0,c.useState)(!1),o=c.useRef(null);if((0,c.useImperativeHandle)(t,()=>o.current),(0,c.useEffect)(()=>{a(!0)},[]),!l)return(0,s.jsx)("div",{className:"w-full h-full flex justify-center items-center",children:(0,s.jsx)(i.a,{})});let r=e.tableName+JSON.stringify(e.filters)+JSON.stringify(e.joins)+JSON.stringify(e.orderBy)+JSON.stringify(e.except)+JSON.stringify(e.additionalFields)+JSON.stringify(e.fields)+JSON.stringify(e.maxResults);return(0,s.jsx)(A,{ref:o,...e},r)});var _=l(3552),D=l(4611),O=l(2230),B=e=>(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("span",{children:["Id: ",e.value]}),(0,s.jsx)(_.q,{value:e.value,children:e=>{let{copied:t,copy:l}=e;return(0,s.jsxs)(n.z,{variant:"subtle",styles:{root:{paddingRight:4,paddingLeft:4}},onClick:l,children:[t?(0,s.jsx)(D.Z,{size:16}):(0,s.jsx)(O.Z,{className:"mr-1",size:16}),t?"Copied":"Copy"]})}})]}),P=()=>{var e;let t=e_();return(0,s.jsx)(s.Fragment,{children:t.tables.length>0&&!(null===(e=t.props.hiddenMenuItems)||void 0===e?void 0:e.includes("Entities"))&&(0,s.jsx)(T.O,{label:"Entities",icon:(0,s.jsx)(R.Z,{size:16,strokeWidth:2,color:t.color}),children:t.tables.filter(e=>{var l,s;return"System"!==e.tag&&(null===(l=t.props.hiddenEntities)||void 0===l?void 0:l.includes(e.tableName))!==!0&&(void 0===t.props.visibleEntities||(null===(s=t.props.visibleEntities)||void 0===s?void 0:s.includes(e.tableName)))}).sort((e,l)=>t.props.showEntityDisplayNames?e.displayName.localeCompare(l.displayName):e.tableName.localeCompare(l.tableName)).map(e=>(0,s.jsx)(T.O,{label:t.props.showEntityDisplayNames?e.displayName:e.tableName,icon:(0,s.jsx)(R.Z,{size:16,strokeWidth:2,color:t.color}),onClick:()=>t.setActiveComponent(t=>({component:(0,s.jsx)(S,{tableName:e.tableName,maxResults:100,formAppendButton:e=>(0,s.jsx)(s.Fragment,{children:"UPDATE"===e.operation&&(0,s.jsx)("div",{className:"w-full flex justify-start items-center gap-1",children:(0,s.jsx)(B,{value:e.data["".concat(e.tableName,"Id")]})})})})}))},e.tableName))})})},L=l(188),k=l(6273),F=l(8122),M=l(4139),U=e=>(0,s.jsxs)("div",{className:"flex justify-center items-center w-full h-full",children:["none"===e.icon&&(0,s.jsx)("svg",{width:"20",height:"20",viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"cursor-pointer",onClick:e.onClick,children:(0,s.jsx)("rect",{x:"2.00024",y:"2",width:"28",height:"28",rx:"6",stroke:"#4B4B4B",strokeWidth:"4"})}),"user"===e.icon&&(0,s.jsxs)("svg",{width:"20",height:"20",viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"cursor-pointer",onClick:e.onClick,children:[(0,s.jsx)("rect",{x:"2.00024",y:"2",width:"28",height:"28",rx:"6",stroke:"#4B4B4B",strokeWidth:"4"}),(0,s.jsx)("mask",{id:"mask0_712_5305",maskUnits:"userSpaceOnUse",x:"4",y:"16",width:"12",height:"12",children:(0,s.jsx)("path",{d:"M4 16V28H16L4 16Z",fill:"#D9D9D9"})}),(0,s.jsx)("g",{mask:"url(#mask0_712_5305)",children:(0,s.jsx)("rect",{x:"4.00024",y:"4",width:"24",height:"24",rx:"4",fill:"#991B1B"})})]}),"team"===e.icon&&(0,s.jsxs)("svg",{width:"20",height:"20",viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"cursor-pointer",onClick:e.onClick,children:[(0,s.jsx)("rect",{x:"2",y:"2",width:"28",height:"28",rx:"6",stroke:"#4B4B4B",strokeWidth:"4"}),(0,s.jsx)("mask",{id:"mask0_712_5300",maskUnits:"userSpaceOnUse",x:"4",y:"4",width:"24",height:"24",children:(0,s.jsx)("path",{d:"M4 28H28L4 4V28Z",fill:"#D9D9D9"})}),(0,s.jsx)("g",{mask:"url(#mask0_712_5300)",children:(0,s.jsx)("rect",{x:"4",y:"4",width:"24",height:"24",rx:"4",fill:"#F59E0B"})})]}),"system"===e.icon&&(0,s.jsxs)("svg",{width:"20",height:"20",viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"cursor-pointer",onClick:e.onClick,children:[(0,s.jsx)("rect",{x:"2",y:"2",width:"28",height:"28",rx:"6",stroke:"#4B4B4B",strokeWidth:"4"}),(0,s.jsx)("rect",{x:"4",y:"4",width:"24",height:"24",rx:"4",fill:"#84CC16"})]})]}),W=l(6521),Z=l(9816),z=l(2063),H=l(2815),V=l(8),G=l(6717);let q=c.createContext(null),J=()=>{let e=c.useContext(q);if(!e)throw Error("useDataGridContext must be used within a DataGridContextProvider");return e},X=c.createContext(null),Y=()=>{let e=c.useContext(X);if(!e)throw Error("useSubGrid must be used within a SubGridContextProvider");return e};var Q=e=>{let t=J();return(0,s.jsx)("div",{children:(0,s.jsx)("input",{type:"text",style:{zIndex:null!=t.props.zIndex?t.props.zIndex+1:2,textAlign:e.rightAlign?"right":"left"},className:"w-full h-full border-none outline-none",value:t.editValue,onChange:e=>{let l=e.target.value;if(t.activeCell&&t.activeCell.onEditing&&t.activeCellLocation){var s;l=t.activeCell.onEditing(l,t.activeCellLocation,null===(s=t.activeCell)||void 0===s?void 0:s.data)}t.setEditValue(l)},autoFocus:!0})})},$=l(2370),K=e=>e.isEditing||null==e.errorMessage||""===e.errorMessage?(0,s.jsx)(s.Fragment,{}):(0,s.jsx)($.u,{label:e.errorMessage,color:"#dc2626",withArrow:!0,children:(0,s.jsx)("div",{className:"absolute w-full h-full flex justify-start items-center",children:(0,s.jsx)("div",{className:"w-4 h-4 text-xs text-white rounded-full bg-red-600 flex justify-center items-center font-bold ml-1",children:"!"})})}),ee=e=>{var t,l,a,i,o;let r=J(),n=Y(),d=(0,c.useRef)(null),u=(0,C.Z)();if(null==r.props.rows[e.rowIndex+n.skipRows])return;let m=r.props.rows[e.rowIndex+n.skipRows].columns[e.columnIndex+n.skipColumns],p={row:e.rowIndex+n.skipRows,col:e.columnIndex+n.skipColumns},f=null!==(a=m.value)&&void 0!==a?a:"",h=null==f?"":f.toString(),v="light"===u.colorScheme?"bg-gray-200":"bg-neutral-800",x=r.props.rightAlignNumbers&&"string"==typeof h&&!isNaN(h)&&!isNaN(parseFloat(h)),y=(e,t)=>{let l=r.props.rows[e+n.skipRows].columns[t+n.skipColumns].onClick;if(null!=l){let s=r.props.rows[e+n.skipRows].columns[t+n.skipColumns].data;l(f,{row:e+n.skipRows,col:t+n.skipColumns},s)}!1!==r.props.editable&&(r.setActiveCellLocation({row:e+n.skipRows,col:t+n.skipColumns}),r.isEditing&&r.onEndEdit())},g=r.props.rows[e.rowIndex+n.skipRows].columns[e.columnIndex+n.skipColumns].style,b=t=>{r.gridResize.setIsResizing(!0),r.gridResize.setResizingStartClientX(t.clientX),r.gridResize.setResizingColNumber(e.columnIndex+n.skipColumns)},N=(null===(t=r.activeCellLocation)||void 0===t?void 0:t.row)===e.rowIndex+n.skipRows&&(null===(l=r.activeCellLocation)||void 0===l?void 0:l.col)===e.columnIndex+n.skipColumns;return(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)("div",{ref:d,style:{...e.style,borderRight:"1px solid gray",borderBottom:"1px solid gray",...null!=g?g:{}},className:"h-full py-0.5 relative whitespace-nowrap text-ellipsis text-sm flex items-center ".concat(m.isDisabled?v:""," ").concat(x?"justify-end":""," ").concat(!1===r.props.editable?"":"cursor-pointer"),onClick:()=>y(e.rowIndex,e.columnIndex),onDoubleClick:()=>r.onKeyDown(window,void 0,h),children:[!N&&null!=m.errorMessage&&(0,s.jsx)(K,{isEditing:N&&r.isEditing,errorMessage:m.errorMessage}),(0,s.jsx)("div",{onMouseDown:e=>b(e),style:{zIndex:(null!==(i=r.props.zIndex)&&void 0!==i?i:0)+2},className:"absolute -right-1 top-0 w-1.5 h-full cursor-ew-resize"}),N?(0,s.jsxs)("div",{style:{boxSizing:r.isEditing?"content-box":"border-box",zIndex:null!==(o=r.props.zIndex)&&void 0!==o?o:1},className:"absolute ".concat(r.isEditing?"-top-0.5 -left-0.5 border-blue-400 border-2":"top-0 left-0 border-blue-600 border-1","  w-full h-full border-solid"),children:[null!=m.errorMessage&&(0,s.jsx)("div",{className:"w-full h-full absolute",children:(0,s.jsx)(K,{isEditing:N&&r.isEditing,errorMessage:m.errorMessage})}),(0,s.jsx)("div",{className:"w-full h-full ".concat(r.isEditing?"border-2 border-solid border-blue-600 flex items-center":""," "),children:r.isEditing&&(0,s.jsx)(Q,{rightAlign:null!=x&&x})})]}):"",null!=m.custom?m.custom(f,p,m.data):"",null==m.custom&&(0,s.jsx)("span",{className:" overflow-hidden px-1",children:""===h.replaceAll(" ","")?"\xa0":h})]},e.columnIndex)})},et=e=>{let[t,l]=(0,c.useState)(!1),[s,a]=(0,c.useState)(void 0),[i,o]=(0,c.useState)(void 0),[r,n]=(0,c.useState)(e.columnWidths),[d,u]=(0,c.useState)(e.columnWidths),[m,p]=(0,c.useState)({startX:0,startY:0,endY:0,clientX:0,clientY:0}),f=()=>{if(t){if(l(!1),null==i)return;let e=m.clientX-s,t=[...d],a=t[i]+e;a<32&&(a=32),t[i]=a,u(t)}};return(0,c.useEffect)(()=>(window.addEventListener("mouseup",f),()=>{window.removeEventListener("mouseup",f)})),(0,c.useEffect)(()=>{if(e.columnWidths.length!==r.length)n(e.columnWidths),u(e.columnWidths);else for(let t=0;t<e.columnWidths.length;t++)if(e.columnWidths[t]!==r[t]){n(e.columnWidths),u(e.columnWidths);break}},[e.columnWidths]),{isResizing:t,setIsResizing:l,resizingStartClientX:s,setResizingStartClientX:a,resizingColNumber:i,setResizingColNumber:o,columnWidths:d,setColWidths:u,onMouseMove:l=>{if(t&&l.preventDefault(),!e.divRef.current)return;let s=e.divRef.current.getBoundingClientRect();p({startX:l.clientX-s.left,startY:0,endY:s.height,clientX:l.clientX,clientY:l.clientY})},mousePosition:m}},el=e=>{if(e.rows.length>0){if(void 0===e.rows[0].columns||0===e.rows[0].columns.length)throw Error("DataGrid: rows must contain columns");let t=e.rows[0].columns.length;for(let l of e.rows){if(null==l.columns)throw Error("DataGrid: rows must contain columns");if(l.columns.length!==t)throw Error("DataGrid: rows must contain the same number of columns")}if("number"!=typeof e.columnWidths&&e.columnWidths.length!==t)throw Error("DataGrid: columnWidths ".concat(e.columnWidths," must be the same length as the number of columns ").concat(t))}};let es=(0,c.forwardRef)((e,t)=>{var l;let[a,i]=(0,c.useState)(void 0),[o,r]=(0,c.useState)(!1),[n,d]=(0,c.useState)(""),[u,m]=(0,c.useState)(!1),p=(0,c.useRef)(null),f=(0,c.useRef)(null),h=(0,c.useRef)(null),v=(0,c.useRef)(null),x=(0,c.useRef)(null);el(e);let y=(0,c.useCallback)(e=>{let{scrollLeft:t,scrollTop:l,scrollUpdateWasRequested:s}=e;if(!s){var a,i;null===(a=h.current)||void 0===a||a.scrollTo({scrollLeft:0,scrollTop:l}),null===(i=v.current)||void 0===i||i.scrollTo({scrollLeft:t,scrollTop:0})}},[]),g=et({rows:e.rows,divRef:p,columnWidths:"number"==typeof e.columnWidths&&e.rows.length>0?Array(e.rows[0].columns.length).fill(e.columnWidths):"object"==typeof e.columnWidths?e.columnWidths:[]}),b=e.rows.length>0&&e.rows[0].columns.length>0?e.rows[0].columns.length:0,N=g.columnWidths.slice(0,null!==(l=e.snapColumns)&&void 0!==l?l:0).reduce((e,t)=>e+t,0),j=!1,I=(t,l,s)=>{if(!1!==e.editable&&((null==l?void 0:l.key)==="Shift"&&m(!0),!j)){if(void 0===l){w(l,s);return}if(a){if(("ArrowDown"===l.key||"ArrowUp"===l.key||"ArrowLeft"===l.key||"ArrowRight"===l.key||"Enter"===l.key||"Escape"===l.key||"Tab"===l.key)&&l.preventDefault(),"ArrowDown"===l.key){if(a.row===e.rows.length-1)return;E(),i({row:a.row+1,col:a.col}),j=!0}else if("ArrowUp"===l.key){if(0===a.row)return;E(),i({row:a.row-1,col:a.col}),j=!0}else if("ArrowLeft"===l.key){if(0===a.col)return;E(),i({row:a.row,col:a.col-1}),j=!0}else if("ArrowRight"===l.key){if(a.col===e.rows[0].columns.length-1)return;E(),i({row:a.row,col:a.col+1}),j=!0}else if("Enter"===l.key){if(E(),a.row===e.rows.length-1)return;i({row:a.row+1,col:a.col})}else if("Escape"===l.key)C();else if("Tab"===l.key){if(E(),u){if(0===a.col)return;i({row:a.row,col:a.col-1})}else{if(a.col===e.rows[0].columns.length-1)return;i({row:a.row,col:a.col+1})}l.stopPropagation()}else w(l)}}},w=(t,l)=>{if(!o&&a){let s=e.rows[a.row].columns[a.col].isReadOnly,i=e.rows[a.row].columns[a.col].isDisabled;if(s||i)return;null==t&&(d(null!=l?l:""),r(!0)),null!=t&&1===t.key.length&&(d(""),r(!0))}j=!1},E=()=>{if(a&&o){let t=e.rows[a.row].columns[a.col];null!=e.onEndEdit&&e.onEndEdit(n,a,t.data),null!=t.onEndEdit&&t.onEndEdit(n,a,t.data),d(""),r(!1)}},C=()=>{d(""),r(!1)};(0,c.useEffect)(()=>{let e=e=>{I(window,e)},t=e=>{"Shift"===e.key&&m(!1)};return window.addEventListener("keydown",e),window.addEventListener("keyup",t),()=>{window.removeEventListener("keydown",e),window.removeEventListener("keyup",t)}},[a,o,n,u]);let T=e=>{p.current&&!p.current.contains(e.target)&&i(void 0)},R=()=>{var e,t,l,s;null==f||null===(e=f.current)||void 0===e||e.resetAfterColumnIndex(0),null===(t=h.current)||void 0===t||t.resetAfterColumnIndex(0),null===(l=v.current)||void 0===l||l.resetAfterColumnIndex(0),null===(s=x.current)||void 0===s||s.resetAfterColumnIndex(0)};return(0,c.useImperativeHandle)(t,()=>({reset:()=>{R()}})),(0,c.useEffect)(()=>{R()},[g.columnWidths]),(0,c.useEffect)(()=>(document.addEventListener("click",T,!0),()=>{document.removeEventListener("click",T,!0)}),[]),(0,s.jsxs)("div",{ref:p,className:"w-full h-full relative",onMouseMove:e=>g.onMouseMove(e),children:[g.isResizing&&(0,s.jsx)("div",{style:{top:g.mousePosition.startY,left:g.mousePosition.startX,border:"1px solid black",width:1,height:g.mousePosition.endY,zIndex:null==e.zIndex?2:e.zIndex+2},className:"absolute"}),(0,s.jsx)(V.ZP,{children:t=>{var l,u,c,m,p,j,w,C,T;let{height:R,width:A}=t;return(0,s.jsx)(q.Provider,{value:{props:e,activeCell:null!=a&&null!=e.rows[a.row]&&null!=e.rows[a.row].columns[a.col]?e.rows[a.row].columns[a.col]:void 0,editValue:n,setEditValue:d,activeCellLocation:a,setActiveCellLocation:i,isEditing:o,setIsEditing:r,onKeyDown:I,onEndEdit:E,gridResize:g},children:(0,s.jsxs)("div",{style:{display:"flex",flexDirection:"row",width:A,height:R},children:[null!=e.snapColumns&&e.snapColumns>0&&(0,s.jsxs)("div",{style:{width:N,height:"100%"},children:[null!=e.snapRows&&e.snapRows>0&&(0,s.jsx)(X.Provider,{value:{skipColumns:0,skipRows:0},children:(0,s.jsx)(G.cd,{ref:f,columnCount:e.snapColumns,rowCount:e.snapRows,columnWidth:e=>g.columnWidths[e],rowHeight:e=>30,height:30*e.snapRows,width:N,style:{overflow:"hidden",...e.styletl},className:" border border-solid border-gray-500",children:ee})}),(0,s.jsx)(X.Provider,{value:{skipColumns:0,skipRows:null!==(l=e.snapRows)&&void 0!==l?l:0},children:(0,s.jsx)(G.cd,{ref:h,columnCount:e.snapColumns,rowCount:e.rows.length-(null!==(u=e.snapRows)&&void 0!==u?u:0),columnWidth:e=>g.columnWidths[e],rowHeight:e=>30,height:R-(null!==(c=e.snapRows)&&void 0!==c?c:0)*30,width:N,style:{overflow:"hidden",...e.stylebl},className:" border border-solid border-gray-500",children:ee})})]}),(0,s.jsxs)("div",{className:"w-full h-full flex flex-col",children:[null!=e.snapRows&&e.snapRows>0&&(0,s.jsx)(X.Provider,{value:{skipColumns:null!==(m=e.snapColumns)&&void 0!==m?m:0,skipRows:0},children:(0,s.jsx)(G.cd,{ref:v,columnCount:b-(null!==(p=e.snapColumns)&&void 0!==p?p:0),rowCount:e.snapRows,columnWidth:t=>{var l;return g.columnWidths[t+(null!==(l=e.snapColumns)&&void 0!==l?l:0)]},rowHeight:e=>30,height:30*e.snapRows,width:null!=e.snapColumns&&e.snapColumns>0?A-N:A,style:{overflow:"hidden",...e.styletr},className:" border border-solid border-gray-500",children:ee})}),(0,s.jsx)(X.Provider,{value:{skipColumns:null!==(j=e.snapColumns)&&void 0!==j?j:0,skipRows:null!==(w=e.snapRows)&&void 0!==w?w:0},children:(0,s.jsx)(G.cd,{ref:x,onScroll:y,columnCount:b-(null!==(C=e.snapColumns)&&void 0!==C?C:0),rowCount:e.rows.length-(null!==(T=e.snapRows)&&void 0!==T?T:0),columnWidth:t=>{var l;return g.columnWidths[t+(null!==(l=e.snapColumns)&&void 0!==l?l:0)]},rowHeight:e=>30,height:null!=e.snapRows&&e.snapRows>0?R-30*e.snapRows:R,width:null!=e.snapColumns&&e.snapColumns>0?A-N:A,style:{...e.style},className:"thin-scrollbar-x border border-solid border-gray-500",children:ee})})]})]})})}})]})});es.displayName="DataGrid";var ea=e=>{let[t,l]=(0,c.useState)([]),a=(t,i,o,r)=>{let n=!r;if(""===o&&n){var d;let t={RoleId:e.roleId,PermissionId:null===(d=e.state.allPermissions.find(e=>e.Name===i))||void 0===d?void 0:d.PermissionId,Permission:"permission.".concat(i)};e.setState(e=>({...e,createRolePermissions:[...e.createRolePermissions,t],deleteRolePermissions:e.deleteRolePermissions.filter(e=>e.Permission!=="permission.".concat(i))}))}else""!==o||n?""===o||n?""!==o&&n&&e.setState(e=>({...e,createRolePermissions:e.createRolePermissions.filter(e=>e.PermissionId!==o||e.Permission!=="permission.".concat(i)),deleteRolePermissions:e.deleteRolePermissions.filter(e=>e.RolePermissionId!==o)})):e.setState(e=>({...e,createRolePermissions:e.createRolePermissions.filter(e=>e.PermissionId!==o||e.Permission!=="permission.".concat(i)),deleteRolePermissions:[...e.deleteRolePermissions,{RolePermissionId:o}]})):e.setState(e=>({...e,createRolePermissions:e.createRolePermissions.filter(e=>e.Permission!=="permission.".concat(i))}));l(e=>{let l=[...e],r=l[t.row],d={...r.columns[t.col]};return d.custom=(e,t)=>(0,s.jsx)(U,{icon:n?"system":"none",onClick:()=>a(t,i,o,n)}),r.columns[t.col]=d,l})},i=(t,a,o,r,n)=>{let d="none",u=t;t.endsWith("NONE")?(u=u.substring(0,t.length-4).concat("USER"),d="user"):t.endsWith("USER")?(u=u.substring(0,t.length-4).concat("TEAM"),d="team"):t.endsWith("TEAM")?(u=u.substring(0,t.length-4).concat("SYSTEM"),d="system"):t.endsWith("SYSTEM")&&(u=u.substring(0,t.length-6).concat("NONE"),d="none"),"none"===d&&null!=o&&e.setState(e=>({...e,deleteRolePermissions:[...e.deleteRolePermissions,{RolePermissionId:o}],updateRolePermissions:e.updateRolePermissions.filter(e=>e.RolePermissionId!==o),createRolePermissions:e.createRolePermissions.filter(e=>e.PermissionId!==o)})),"none"!==d&&null==o&&e.setState(t=>{var l;return{...t,createRolePermissions:[...t.createRolePermissions.filter(e=>e.Permission!=="".concat(r,".").concat(n)),{RolePermissionId:"",RoleId:e.roleId,PermissionId:null===(l=e.state.allPermissions.find(e=>e.Name===u))||void 0===l?void 0:l.PermissionId,Permission:"".concat(r,".").concat(n)}]}}),"none"!==d&&null!=o&&e.setState(t=>{var l;return{...t,updateRolePermissions:[...t.updateRolePermissions.filter(e=>e.RolePermissionId!==o),{RolePermissionId:o,PermissionId:null===(l=e.state.allPermissions.find(e=>e.Name===u))||void 0===l?void 0:l.PermissionId}],deleteRolePermissions:t.deleteRolePermissions.filter(e=>e.RolePermissionId!==o)}}),l(e=>e.map((e,t)=>({columns:e.columns.map((e,l)=>t===a.row&&l===a.col?{...e,custom:(e,t)=>(0,s.jsx)(U,{icon:d,onClick:()=>i(u,t,o,r,n)})}:e)})))};return{toggleBinaryPermission:a,toggleTablePermission:i,rows:t,setRows:l}},ei=e=>{let t=ea(e),l=(e,t,l)=>{var s,a,i,o,r;let n="none",d=e.find(e=>{var s;return null===(s=e.Permission)||void 0===s?void 0:s.startsWith("TABLE_".concat(t,"_").concat(l))});return null==d?{permissionLevel:"none",RolePermissionId:null}:(((null===(s=d.Permission)||void 0===s?void 0:s.endsWith("IMPORT"))||(null===(a=d.Permission)||void 0===a?void 0:a.endsWith("EXPORT")))&&(n="system"),(null===(i=d.Permission)||void 0===i?void 0:i.endsWith("USER"))&&(n="user"),(null===(o=d.Permission)||void 0===o?void 0:o.endsWith("TEAM"))&&(n="team"),(null===(r=d.Permission)||void 0===r?void 0:r.endsWith("SYSTEM"))&&(n="system"),{permissionLevel:n,RolePermissionId:d.RolePermissionId})},a=(a,i)=>{let o=[];for(let r of(o.push({columns:[{value:"Entity",isReadOnly:!0,style:{}},{value:"Create",isReadOnly:!0,style:{justifyContent:"center"}},{value:"Read",isReadOnly:!0,style:{justifyContent:"center"}},{value:"Update",isReadOnly:!0,style:{justifyContent:"center"}},{value:"Delete",isReadOnly:!0,style:{justifyContent:"center"}},{value:"Assign",isReadOnly:!0,style:{justifyContent:"center"}},{value:"Import",isReadOnly:!0,style:{justifyContent:"center"}},{value:"Export",isReadOnly:!0,style:{justifyContent:"center"}}]}),i)){let i=l(a,r.tableName,"CREATE"),n=l(a,r.tableName,"READ"),d=l(a,r.tableName,"UPDATE"),u=l(a,r.tableName,"DELETE"),c=l(a,r.tableName,"ASSIGN"),m=l(a,r.tableName,"IMPORT"),p=l(a,r.tableName,"EXPORT"),f=e.roleId!==eu,h={columns:[{value:r.tableName,isReadOnly:!0,style:{border:"none",userSelect:"none"}},{custom:(e,l)=>(0,s.jsx)(U,{icon:i.permissionLevel,onClick:()=>f&&t.toggleTablePermission("TABLE_".concat(r.tableName,"_CREATE_").concat(i.permissionLevel.toUpperCase()),l,i.RolePermissionId,r.tableName,"CREATE")}),isReadOnly:!0,style:{justifyContent:"center",border:"none",userSelect:"none"}},{custom:(e,l)=>(0,s.jsx)(U,{icon:n.permissionLevel,onClick:()=>f&&t.toggleTablePermission("TABLE_".concat(r.tableName,"_READ_").concat(n.permissionLevel.toUpperCase()),l,n.RolePermissionId,r.tableName,"READ")}),isReadOnly:!0,style:{justifyContent:"center",border:"none",userSelect:"none"}},{custom:(e,l)=>(0,s.jsx)(U,{icon:d.permissionLevel,onClick:()=>f&&t.toggleTablePermission("TABLE_".concat(r.tableName,"_UPDATE_").concat(d.permissionLevel.toUpperCase()),l,d.RolePermissionId,r.tableName,"UPDATE")}),isReadOnly:!0,style:{justifyContent:"center",border:"none",userSelect:"none"}},{custom:(e,l)=>(0,s.jsx)(U,{icon:u.permissionLevel,onClick:()=>f&&t.toggleTablePermission("TABLE_".concat(r.tableName,"_DELETE_").concat(u.permissionLevel.toUpperCase()),l,u.RolePermissionId,r.tableName,"DELETE")}),isReadOnly:!0,style:{justifyContent:"center",border:"none",userSelect:"none"}},{custom:(e,l)=>(0,s.jsx)(U,{icon:c.permissionLevel,onClick:()=>f&&t.toggleTablePermission("TABLE_".concat(r.tableName,"_ASSIGN_").concat(c.permissionLevel.toUpperCase()),l,c.RolePermissionId,r.tableName,"ASSIGN")}),isReadOnly:!0,style:{justifyContent:"center",border:"none",userSelect:"none"}},{custom:(e,l)=>(0,s.jsx)(U,{icon:m.permissionLevel,onClick:()=>{var e;return f&&t.toggleBinaryPermission(l,"TABLE_".concat(r.tableName,"_IMPORT"),null!==(e=m.RolePermissionId)&&void 0!==e?e:"","none"!==m.permissionLevel)}}),isReadOnly:!0,style:{justifyContent:"center",border:"none",userSelect:"none"}},{custom:(e,l)=>(0,s.jsx)(U,{icon:p.permissionLevel,onClick:()=>{var e;return f&&t.toggleBinaryPermission(l,"TABLE_".concat(r.tableName,"_EXPORT"),null!==(e=p.RolePermissionId)&&void 0!==e?e:"","none"!==p.permissionLevel)}}),isReadOnly:!0,style:{justifyContent:"center",border:"none",userSelect:"none"}}]};o.push(h)}t.setRows(o)};return(0,c.useEffect)(()=>{a(e.state.rolePermissions,e.state.tables)},[e.state.rolePermissions,e.state.tables]),(0,s.jsx)(es,{rows:t.rows,columnWidths:[300,100,100,100,100,100,100,100],snapRows:1,snapColumns:1,editable:!1,style:{borderBottomRightRadius:"0.2rem"},styletr:{borderTopRightRadius:"0.2rem"},styletl:{borderTopLeftRadius:"0.2rem"},stylebl:{borderBottomLeftRadius:"0.2rem"}})},eo=e=>{let t=ea(e),l=()=>{let l=[];l.push({columns:[{value:"Permission Name",isReadOnly:!0},{value:"Access",isReadOnly:!0,style:{justifyContent:"center"}}]});let a=e.roleId!==eu;for(let i of e.state.allPermissions){if("System"===i.Tag)continue;let o="",r=!1;for(let t of e.state.rolePermissions)if(t.PermissionId===i.PermissionId){o=t.RolePermissionId,r=!0;break}let n={columns:[{value:i.Name,isReadOnly:!0,style:{border:"none"}},{custom:(e,l)=>(0,s.jsx)(U,{icon:o?"system":"none",onClick:()=>a&&t.toggleBinaryPermission(l,i.Name,o,r)}),style:{justifyContent:"center",border:"none",userSelect:"none"}}]};l.push(n)}t.setRows(l)};return(0,c.useEffect)(()=>{l()},[]),(0,s.jsx)(es,{rows:t.rows,columnWidths:[300,150],snapColumns:1,snapRows:1,editable:!1,style:{borderBottomRightRadius:"0.2rem"},styletr:{borderTopRightRadius:"0.2rem"},styletl:{borderTopLeftRadius:"0.2rem"},stylebl:{borderBottomLeftRadius:"0.2rem"}})},er=e=>{let t=ea(e),l=()=>{let l=[];l.push({columns:[{value:"Permission Name",isReadOnly:!0},{value:"Access",isReadOnly:!0,style:{justifyContent:"center"}}]});let a=e.roleId!==eu;for(let i of e.state.allPermissions){if("System"!==i.Tag||!i.Name.startsWith("JOB_"))continue;let o="",r=!1;for(let t of e.state.rolePermissions)if(t.PermissionId===i.PermissionId){o=t.RolePermissionId,r=!0;break}let n={columns:[{value:i.Name,isReadOnly:!0,style:{border:"none"}},{custom:(e,l)=>(0,s.jsx)(U,{icon:o?"system":"none",onClick:()=>a&&t.toggleBinaryPermission(l,i.Name,o,r)}),style:{justifyContent:"center",border:"none",userSelect:"none"}}]};l.push(n)}t.setRows(l)};return(0,c.useEffect)(()=>{l()},[]),(0,s.jsx)(es,{rows:t.rows,columnWidths:[300,150],snapColumns:1,snapRows:1,editable:!1,style:{borderBottomRightRadius:"0.2rem"},styletr:{borderTopRightRadius:"0.2rem"},styletl:{borderTopLeftRadius:"0.2rem"},stylebl:{borderBottomLeftRadius:"0.2rem"}})},en=e=>{let t=ea(e),l=()=>{let l=[];l.push({columns:[{value:"Permission Name",isReadOnly:!0},{value:"Access",isReadOnly:!0,style:{justifyContent:"center"}}]});let a=e.roleId!==eu;for(let i of e.state.allPermissions){if("System"!==i.Tag||i.Name.startsWith("TABLE_")||i.Name.startsWith("JOB_")||!(i.Name.startsWith("ACTION_ADMIN")||i.Name.startsWith("ACTION_TABLE")||"ACCESS_ADMIN_DASHBOARD"==i.Name))continue;let o="",r=!1;for(let t of e.state.rolePermissions)if(t.PermissionId===i.PermissionId){o=t.RolePermissionId,r=!0;break}let n={columns:[{value:i.Name,isReadOnly:!0,style:{border:"none"}},{custom:(e,l)=>(0,s.jsx)(U,{icon:o?"system":"none",onClick:()=>a&&t.toggleBinaryPermission(l,i.Name,o,r)}),style:{justifyContent:"center",border:"none",userSelect:"none"}}]};l.push(n)}t.setRows(l)};return(0,c.useEffect)(()=>{l()},[]),(0,s.jsx)(es,{rows:t.rows,columnWidths:[300,150],snapColumns:1,snapRows:1,editable:!1,style:{borderBottomRightRadius:"0.2rem"},styletr:{borderTopRightRadius:"0.2rem"},styletl:{borderTopLeftRadius:"0.2rem"},stylebl:{borderBottomLeftRadius:"0.2rem"}})},ed=e=>{let t=ea(e),l=()=>{let l=[];l.push({columns:[{value:"Permission Name",isReadOnly:!0},{value:"Access",isReadOnly:!0,style:{justifyContent:"center"}}]});let a=e.roleId!==eu;for(let i of e.state.allPermissions){if("System"!==i.Tag||i.Name.startsWith("TABLE_")||i.Name.startsWith("JOB_")||i.Name.startsWith("ACTION_ADMIN")||i.Name.startsWith("ACTION_TABLE")||"ACCESS_ADMIN_DASHBOARD"==i.Name)continue;let o="",r=!1;for(let t of e.state.rolePermissions)if(t.PermissionId===i.PermissionId){o=t.RolePermissionId,r=!0;break}let n={columns:[{value:i.Name,isReadOnly:!0,style:{border:"none"}},{custom:(e,l)=>(0,s.jsx)(U,{icon:o?"system":"none",onClick:()=>a&&t.toggleBinaryPermission(l,i.Name,o,r)}),style:{justifyContent:"center",border:"none",userSelect:"none"}}]};l.push(n)}t.setRows(l)};return(0,c.useEffect)(()=>{l()},[]),(0,s.jsx)(es,{rows:t.rows,columnWidths:[300,150],snapColumns:1,snapRows:1,editable:!1,style:{borderBottomRightRadius:"0.2rem"},styletr:{borderTopRightRadius:"0.2rem"},styletl:{borderTopLeftRadius:"0.2rem"},stylebl:{borderBottomLeftRadius:"0.2rem"}})};let eu="64589861-0481-4dbb-a96f-9b8b6546c40d";var ec=e=>{let t=(0,a.Z)(),[l,o]=c.useState(!0),[r,n]=(0,c.useState)({tables:[],allPermissions:[],rolePermissions:[],createRolePermissions:[],updateRolePermissions:[],deleteRolePermissions:[],isLoaded:!1}),[d,u]=(0,c.useState)("entities"),m=async()=>{if(null==e.roleId){o(!1);return}let l=await t.tables();if(!l.succeeded)return;let s=new W.ZP(["*"]).top(999999).from("Permission").orderBy("Name","asc").distinct().toReadRequest(),a=await t.read(s),i=new W.ZP(["*"]).top(999999).from("RolePermission").where("RoleId","==",e.roleId).distinct().toReadRequest(),r=await t.read(i);r.succeeded&&(n(e=>({...e,tables:l.data,allPermissions:a.data.results,rolePermissions:r.data.results,isLoaded:!0})),o(!1))},p=(0,c.useCallback)(async()=>(o(!0),(await t.bulk({creates:r.createRolePermissions.map(e=>({tableName:"RolePermission",fields:{PermissionId:e.PermissionId,RoleId:e.RoleId}})),updates:r.updateRolePermissions.map(e=>({tableName:"RolePermission",fields:e})),deletes:r.deleteRolePermissions.map(e=>({tableName:"RolePermission",fields:e}))})).succeeded)?(o(!1),{continue:!0}):(o(!1),{continue:!1}),[r.deleteRolePermissions,r.createRolePermissions,r.updateRolePermissions]);return(0,c.useEffect)(()=>{m()},[]),(0,s.jsxs)("div",{className:"w-full flex flex-col gap-4",children:[(0,s.jsx)(z.Z,{name:"Name"}),(0,s.jsxs)("div",{className:"w-full h-[500px] relative",children:[l&&(0,s.jsx)("div",{className:"w-full h-full absolute flex justify-center items-center",children:(0,s.jsx)(i.a,{})}),null==e.roleId&&(0,s.jsx)("div",{className:"w-full h-full flex justify-center items-center",children:"Save the role to set permissions"}),null!=e.roleId&&r.isLoaded&&(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)(Z.m,{defaultValue:"entities",className:"h-full flex flex-col",onTabChange:u,children:[(0,s.jsxs)(Z.m.List,{children:[(0,s.jsx)(Z.m.Tab,{value:"entities",children:"Entities"}),(0,s.jsx)(Z.m.Tab,{value:"actions",children:"Actions"}),(0,s.jsx)(Z.m.Tab,{value:"jobs",children:"Jobs"}),(0,s.jsx)(Z.m.Tab,{value:"system",children:"System"}),(0,s.jsx)(Z.m.Tab,{value:"permissions",children:"Custom Permissions"})]}),(0,s.jsx)(Z.m.Panel,{value:"entities",pt:"xs",className:"h-full",children:(0,s.jsx)("div",{className:"w-full h-full",children:(0,s.jsx)(ei,{roleId:e.roleId,state:r,setState:n})})}),(0,s.jsx)(Z.m.Panel,{value:"actions",pt:"xs",className:"h-full",children:(0,s.jsx)("div",{className:"w-full h-full",children:(0,s.jsx)(ed,{roleId:e.roleId,state:r,setState:n})})}),(0,s.jsx)(Z.m.Panel,{value:"permissions",pt:"xs",className:"h-full",children:(0,s.jsx)("div",{className:"w-full h-full",children:(0,s.jsx)(eo,{roleId:e.roleId,state:r,setState:n})})}),(0,s.jsx)(Z.m.Panel,{value:"jobs",pt:"xs",className:"h-full",children:(0,s.jsx)("div",{className:"w-full h-full",children:(0,s.jsx)(er,{roleId:e.roleId,state:r,setState:n})})}),(0,s.jsx)(Z.m.Panel,{value:"system",pt:"xs",className:"h-full",children:(0,s.jsx)("div",{className:"w-full h-full",children:(0,s.jsx)(en,{roleId:e.roleId,state:r,setState:n})})})]})})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsxs)("div",{className:"flex gap-5 w-full",children:[null!=e.roleId&&null!=d&&"entities"===d&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("span",{className:"flex text-sm gap-1 items-center",children:[(0,s.jsx)(U,{icon:"none"}),"None"]}),(0,s.jsxs)("span",{className:"flex text-sm gap-1 items-center",children:[(0,s.jsx)(U,{icon:"user"}),"User"]}),(0,s.jsxs)("span",{className:"flex text-sm gap-1 items-center",children:[(0,s.jsx)(U,{icon:"team"}),"Team"]}),(0,s.jsxs)("span",{className:"flex text-sm gap-1 items-center",children:[(0,s.jsx)(U,{icon:"system"}),"System"]})]}),null!=e.roleId&&null!=d&&("permissions"===d||"system"===d)&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("span",{className:"flex text-sm gap-1 items-center whitespace-nowrap",children:[(0,s.jsx)(U,{icon:"none"}),"Doesn't have permission"]}),(0,s.jsxs)("span",{className:"flex text-sm gap-1 items-center whitespace-nowrap",children:[(0,s.jsx)(U,{icon:"system"}),"Has permission"]})]}),null!=e.roleId&&null!=d&&"actions"===d&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("span",{className:"flex text-sm gap-1 items-center whitespace-nowrap",children:[(0,s.jsx)(U,{icon:"none"}),"Can't execute action"]}),(0,s.jsxs)("span",{className:"flex text-sm gap-1 items-center whitespace-nowrap",children:[(0,s.jsx)(U,{icon:"system"}),"Can execute action"]})]}),null!=e.roleId&&null!=d&&"jobs"===d&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("span",{className:"flex text-sm gap-1 items-center whitespace-nowrap",children:[(0,s.jsx)(U,{icon:"none"}),"Can't start job"]}),(0,s.jsxs)("span",{className:"flex text-sm gap-1 items-center whitespace-nowrap",children:[(0,s.jsx)(U,{icon:"system"}),"Can start job"]})]}),"UPDATE"===e.formBuilder.operation&&(0,s.jsx)("div",{className:"w-full flex justify-start items-center pr-2",children:(0,s.jsx)(B,{value:e.formBuilder.data["".concat(e.formBuilder.tableName,"Id")]})})]}),(0,s.jsx)(H.Z,{onPreSave:p})]})]})},em=()=>{var e,t,l,a,i;let o=e_();return(0,s.jsx)(s.Fragment,{children:o.tables.filter(e=>["User","Role","Team","Permission"].includes(e.tableName)).length>0&&!(null===(e=o.props.hiddenMenuItems)||void 0===e?void 0:e.includes("Security"))&&(0,s.jsxs)(T.O,{label:"Security",icon:(0,s.jsx)(L.Z,{size:16,strokeWidth:2,color:o.color}),children:[o.tables.find(e=>"User"===e.tableName)&&!(null===(t=o.props.hiddenMenuItems)||void 0===t?void 0:t.includes("Users"))&&(0,s.jsx)(T.O,{label:"Users",onClick:()=>o.setActiveComponent({component:(0,s.jsx)("div",{className:"w-full h-full flex flex-col",children:(0,s.jsx)("div",{className:"grow h-1",children:(0,s.jsx)(S,{tableName:"User",maxResults:100,formMaxWidth:72,formAppendButton:e=>(0,s.jsx)(s.Fragment,{children:"UPDATE"===e.operation&&(0,s.jsx)("div",{className:"w-full flex justify-start items-center gap-1",children:(0,s.jsx)(B,{value:e.data["".concat(e.tableName,"Id")]})})}),appendCustomForm:e=>void 0===e.snapshot?(0,s.jsx)(s.Fragment,{}):(0,s.jsxs)("div",{className:" h-96 mt-5 flex justify-stretch gap-4",children:[(0,s.jsx)(S,{title:"Roles",tableName:"UserRole",fields:["RoleId"],filters:[{field:"UserId",value:e.snapshot.UserId}],formZIndex:1e3,formFields:["RoleId"],formFieldDefaults:[{field:"UserId",value:e.snapshot.UserId}],formLookupQueries:[{field:"RoleId",except:[{fromField:"RoleId",query:{tableName:"UserRole",fields:["RoleId"],filters:[{field:"UserId",operator:"==",value:e.snapshot.UserId}]}}]}]}),(0,s.jsx)(S,{title:"Teams",tableName:"TeamUser",fields:["TeamId"],filters:[{field:"UserId",value:e.snapshot.UserId}],formZIndex:1e3,formFields:["TeamId"],formFieldDefaults:[{field:"UserId",value:e.snapshot.UserId}],formLookupQueries:[{field:"TeamId",except:[{fromField:"TeamId",query:{tableName:"TeamUser",fields:["TeamId"],filters:[{field:"UserId",operator:"==",value:e.snapshot.UserId}]}}]}]})]})})})})}),icon:(0,s.jsx)(k.Z,{size:16,strokeWidth:2,color:o.color})}),o.tables.find(e=>"Team"===e.tableName)&&!(null===(l=o.props.hiddenMenuItems)||void 0===l?void 0:l.includes("Teams"))&&(0,s.jsx)(T.O,{label:"Teams",onClick:()=>o.setActiveComponent({component:(0,s.jsx)("div",{className:"w-full h-full flex flex-col",children:(0,s.jsx)("div",{className:"grow h-1",children:(0,s.jsx)(S,{tableName:"Team",formCloseOnCreate:!1,maxResults:100,formMaxWidth:72,formAppendButton:e=>(0,s.jsx)(s.Fragment,{children:"UPDATE"===e.operation&&(0,s.jsx)("div",{className:"w-full flex justify-start items-center gap-1",children:(0,s.jsx)(B,{value:e.data["".concat(e.tableName,"Id")]})})}),appendCustomForm:e=>void 0===e.snapshot?(0,s.jsx)(s.Fragment,{}):(0,s.jsxs)("div",{className:" h-96 mt-5 flex justify-stretch gap-4",children:[(0,s.jsx)(S,{title:"Roles",tableName:"TeamRole",fields:["RoleId"],filters:[{field:"TeamId",value:e.snapshot.TeamId}],formZIndex:1e3,formFields:["RoleId"],formFieldDefaults:[{field:"TeamId",value:e.snapshot.TeamId}],formLookupQueries:[{field:"RoleId",except:[{fromField:"RoleId",query:{tableName:"TeamRole",fields:["RoleId"],filters:[{field:"TeamId",operator:"==",value:e.snapshot.TeamId}]}}]}]}),(0,s.jsx)(S,{title:"Users",tableName:"TeamUser",fields:["UserId"],filters:[{field:"TeamId",value:e.snapshot.TeamId}],formZIndex:1e3,formFields:["UserId"],formFieldDefaults:[{field:"TeamId",value:e.snapshot.TeamId}],formLookupQueries:[{field:"UserId",except:[{fromField:"UserId",query:{tableName:"TeamUser",fields:["UserId"],filters:[{field:"TeamId",operator:"==",value:e.snapshot.TeamId}]}}]}]})]})})})})}),icon:(0,s.jsx)(F.Z,{size:16,strokeWidth:2,color:o.color})}),o.tables.find(e=>"Role"===e.tableName)&&!(null===(a=o.props.hiddenMenuItems)||void 0===a?void 0:a.includes("Roles"))&&(0,s.jsx)(T.O,{label:"Roles",onClick:()=>{o.setActiveComponent({component:(0,s.jsx)(S,{tableName:"Role",formMaxWidth:72,maxResults:100,formCloseOnCreate:!1,customForm:e=>{var t,l;return(0,s.jsx)(ec,{roleId:null===(t=e.snapshot)||void 0===t?void 0:t.RoleId,formBuilder:e},null===(l=e.snapshot)||void 0===l?void 0:l.RoleId)}})})},icon:(0,s.jsx)(M.Z,{size:16,strokeWidth:2,color:o.color})}),o.tables.find(e=>"Permission"===e.tableName)&&!(null===(i=o.props.hiddenMenuItems)||void 0===i?void 0:i.includes("Permissions"))&&(0,s.jsx)(T.O,{label:"Permissions",onClick:()=>o.setActiveComponent({component:(0,s.jsx)("div",{className:"w-full h-full flex flex-col",children:(0,s.jsx)("div",{className:"grow h-1",children:(0,s.jsx)(S,{tableName:"Permission",fields:["Name"],filters:[{field:"Tag",operator:"!=",value:"System"}],formFields:["Name"],formCloseOnCreate:!0,formMaxWidth:36,maxResults:100,formAppendButton:e=>(0,s.jsx)(s.Fragment,{children:"UPDATE"===e.operation&&(0,s.jsx)("div",{className:"w-full flex justify-start items-center gap-1",children:(0,s.jsx)(B,{value:e.data["".concat(e.tableName,"Id")]})})})})})})}),icon:(0,s.jsx)(v.Z,{size:16,strokeWidth:2,color:o.color})})]})})},ep=l(4459),ef=()=>{var e;let t=e_();return(0,s.jsx)(s.Fragment,{children:t.tables.filter(e=>"Option"===e.tableName).length>0&&!(null===(e=t.props.hiddenMenuItems)||void 0===e?void 0:e.includes("Options"))&&(0,s.jsx)(T.O,{label:"Options",icon:(0,s.jsx)(ep.Z,{size:16,strokeWidth:2,color:t.color}),onClick:()=>t.setActiveComponent({component:(0,s.jsx)(S,{tableName:"Option",maxResults:100,formAppendButton:e=>(0,s.jsx)(s.Fragment,{children:"UPDATE"===e.operation&&(0,s.jsx)("div",{className:"w-full flex justify-start items-center gap-1",children:(0,s.jsx)(B,{value:e.data["".concat(e.tableName,"Id")]})})})})})})})},eh=l(2289),ev=l(872),ex=e=>{var t,l,i,o;let r=(0,a.Z)(),d=(0,c.useRef)(null),[u,m]=(0,c.useState)(!1),[p,f]=(0,c.useState)(!1),h=async()=>{var t;m(!0),e.formBuilder.dispatch({type:"SET_FIELD_VALUE",payload:{field:"Status",value:"Running"}}),await r.action("ADMIN_TriggerJob",{jobName:null===(t=e.formBuilder.snapshot)||void 0===t?void 0:t.Name}),m(!1)};return((0,c.useEffect)(()=>{let t=setInterval(async()=>{if(null!=d.current&&!p){f(!0);try{var t;let l=await r.read({tableName:e.formBuilder.tableName,id:null===(t=e.formBuilder.snapshot)||void 0===t?void 0:t.JobId,fields:["*"]});if(null!=l&&l.data.results.length>0){let t=l.data.results[0];"Running"!=t.Status?m(!1):m(!0),e.formBuilder.dispatch({type:"SET_FIELD_VALUE",payload:{field:"Status",value:t.Status}}),e.formBuilder.dispatch({type:"SET_FIELD_VALUE",payload:{field:"LastExecution",value:t.LastExecution}})}}catch(e){console.error(e)}finally{f(!1)}}},2500);return()=>clearInterval(t)},[]),(0,c.useEffect)(()=>{var t;null!=e.formBuilder.snapshot&&(null===(t=e.formBuilder.snapshot)||void 0===t?void 0:t.Status)==="Running"&&m(!0),null!=e.formBuilder.snapshot&&(d.current=e.formBuilder.snapshot)},[e.formBuilder.snapshot]),null==e.formBuilder.snapshot||(null===(t=e.formBuilder.snapshot)||void 0===t?void 0:t.Name)==null||(null===(l=e.formBuilder.snapshot)||void 0===l?void 0:l.name)===""||(null===(i=e.formBuilder.snapshot)||void 0===i?void 0:i._ui_info_)==null)?(0,s.jsx)(s.Fragment,{}):(null===(o=e.formBuilder.snapshot)||void 0===o?void 0:o._ui_info_.canTrigger)===!0?(0,s.jsx)(n.z,{variant:"outline",onClick:h,loading:u,children:"Run Job"}):(0,s.jsx)(s.Fragment,{})},ey=()=>{var e;let t=e_();return(0,s.jsx)(s.Fragment,{children:t.tables.filter(e=>"Job"===e.tableName).length>0&&!(null===(e=t.props.hiddenMenuItems)||void 0===e?void 0:e.includes("Jobs"))&&(0,s.jsx)(T.O,{label:"Jobs",icon:(0,s.jsx)(ev.Z,{size:16,strokeWidth:2,color:t.color}),onClick:()=>t.setActiveComponent({component:(0,s.jsx)(S,{tableName:"Job",orderBy:[{field:"Name",order:"asc"}],fields:["Name","Status","Queue","IsActive","LastExecution"],filters:[{field:"Tag",operator:"!=",value:"System"}],canCreate:!1,canDelete:!1,formCloseOnEscape:!0,formAppendButton:e=>(0,s.jsxs)(s.Fragment,{children:["UPDATE"===e.operation&&(0,s.jsx)("div",{className:"w-full flex justify-start items-center gap-1",children:(0,s.jsx)(B,{value:e.data["".concat(e.tableName,"Id")]})}),(0,s.jsx)("div",{className:"mr-2",children:(0,s.jsx)(ex,{formBuilder:e})})]}),appendCustomForm:e=>{var t;return"CREATE"===e.operation&&s.Fragment,(0,s.jsx)("div",{className:"w-full h-96",children:(0,s.jsx)(S,{title:"History",tableName:"JobHistory",fields:["Status","Message","CreatedDate","CompletedDate"],filters:[{field:"JobId",value:null===(t=e.snapshot)||void 0===t?void 0:t.JobId}],orderBy:[{field:"CreatedDate",order:"desc"}],refreshInterval:1e3,maxResults:100,canUpdate:!1,customForm:e=>(0,s.jsxs)("div",{className:"w-full flex flex-col gap-2",children:[(0,s.jsxs)(eh.r,{children:[(0,s.jsx)(eh.r.Col,{span:4,children:(0,s.jsx)(z.Z,{name:"Name"})}),(0,s.jsx)(eh.r.Col,{span:4,children:(0,s.jsx)(z.Z,{name:"JobId"})}),(0,s.jsx)(eh.r.Col,{span:4,children:(0,s.jsx)(z.Z,{name:"Status"})})]}),(0,s.jsxs)(eh.r,{children:[(0,s.jsx)(eh.r.Col,{span:4,children:(0,s.jsx)(z.Z,{name:"CreatedDate"})}),(0,s.jsx)(eh.r.Col,{span:4,children:(0,s.jsx)(z.Z,{name:"CompletedDate"})}),(0,s.jsx)(eh.r.Col,{span:4})]}),(0,s.jsx)("div",{className:"w-full h-48",children:(0,s.jsx)(z.Z,{name:"Message",varient:"textarea"})})]})})})}})})})})},eg=l(7115),eb=()=>{var e;let t=e_();return(0,s.jsx)(s.Fragment,{children:t.tables.filter(e=>"Setting"===e.tableName).length>0&&!(null===(e=t.props.hiddenMenuItems)||void 0===e?void 0:e.includes("Settings"))&&(0,s.jsx)(T.O,{label:"Settings",icon:(0,s.jsx)(eg.Z,{size:16,strokeWidth:2,color:t.color}),onClick:()=>t.setActiveComponent({component:(0,s.jsx)(S,{tableName:"Setting",maxResults:100,formAppendButton:e=>(0,s.jsx)(s.Fragment,{children:"UPDATE"===e.operation&&(0,s.jsx)("div",{className:"w-full flex justify-start items-center gap-1",children:(0,s.jsx)(B,{value:e.data["".concat(e.tableName,"Id")]})})})})})})})},eN=l(5595),ej=l(950),eI=l(2670),ew=l(5815),eE=e=>{var t,l;let i=(0,a.Z)(),o=(0,c.useRef)(null),[r,n]=(0,c.useState)(!1),[d,u]=(0,c.useState)(!1),[m,p]=(0,c.useState)(!1),f=e=>{e.filter(e=>e.IsCreate).length===e.length?n(!0):n(!1),e.filter(e=>e.IsUpdate).length===e.length?u(!0):u(!1),e.filter(e=>e.IsDelete).length===e.length?p(!0):p(!1)},v=async e=>{var t;return!0===(await i.bulkUpdate(e.map(e=>({tableName:"AuditField",fields:{...e}})))).succeeded||(null===(t=o.current)||void 0===t||t.refresh(),!1)},x=async e=>{var t;return!0===(await i.update("AuditField",e)).succeeded||(null===(t=o.current)||void 0===t||t.refresh(),!1)};return(0,s.jsxs)("div",{className:"w-full flex flex-col gap-4",children:[(0,s.jsx)(ej.b,{icon:(0,s.jsx)(ew.Z,{size:"1rem"}),color:"yellow",children:"In a multi-server environment, Audit configuration changes may take up to 5 minutes to take effect."}),(null===(t=e.formBuilder.snapshot)||void 0===t?void 0:t.IsTable)&&(0,s.jsxs)(eh.r,{children:[(0,s.jsx)(eh.r.Col,{span:4,children:(0,s.jsx)(z.Z,{name:"Name"})}),(0,s.jsx)(eh.r.Col,{span:2,children:(0,s.jsx)(z.Z,{name:"IsCreate"})}),(0,s.jsx)(eh.r.Col,{span:2,children:(0,s.jsx)(z.Z,{name:"IsRead"})}),(0,s.jsx)(eh.r.Col,{span:2,children:(0,s.jsx)(z.Z,{name:"IsUpdate"})}),(0,s.jsx)(eh.r.Col,{span:2,children:(0,s.jsx)(z.Z,{name:"IsDelete"})})]}),(0,s.jsx)("div",{className:"w-full h-[550px]",children:(0,s.jsx)(eI.default,{tableName:"AuditField",columnWidths:["100%","130px","130px","130px"],additionalFields:["IsCreate","IsUpdate","IsDelete"],canDelete:!1,fields:["Name",{header:e=>(0,s.jsx)("div",{children:(0,s.jsx)(h.X,{label:"Create",checked:r,onChange:t=>{n(t.target.checked),e.setRecords(e=>{let l=e.map(e=>({...e,IsCreate:t.target.checked}));return v(l),l})}})}),body:(e,t)=>(0,s.jsx)(h.X,{checked:e.IsCreate,onChange:l=>{t.setRecords(t=>{let s=t.map(t=>t.AuditFieldId===e.AuditFieldId?{...t,IsCreate:l.target.checked}:t);return s.filter(e=>e.IsCreate).length===t.length?n(!0):n(!1),x(s.find(t=>t.AuditFieldId===e.AuditFieldId)),s})}})},{header:e=>(0,s.jsx)("div",{children:(0,s.jsx)(h.X,{label:"Update",checked:d,onChange:t=>{u(t.target.checked),e.setRecords(e=>{let l=e.map(e=>({...e,IsUpdate:t.target.checked}));return v(l),l})}})}),body:(e,t)=>(0,s.jsx)(h.X,{checked:e.IsUpdate,onChange:l=>{t.setRecords(t=>{let s=t.map(t=>t.AuditFieldId===e.AuditFieldId?{...t,IsUpdate:l.target.checked}:t);return s.filter(e=>e.IsUpdate).length===t.length?u(!0):u(!1),x(s.find(t=>t.AuditFieldId===e.AuditFieldId)),s})}})},{header:e=>(0,s.jsx)("div",{children:(0,s.jsx)(h.X,{label:"Delete",checked:m,onChange:t=>{p(t.target.checked),e.setRecords(e=>{let l=e.map(e=>({...e,IsDelete:t.target.checked}));return v(l),l})}})}),body:(e,t)=>(0,s.jsx)(h.X,{checked:e.IsDelete,onChange:l=>{t.setRecords(t=>{let s=t.map(t=>t.AuditFieldId===e.AuditFieldId?{...t,IsDelete:l.target.checked}:t);return s.filter(e=>e.IsDelete).length===t.length?p(!0):p(!1),x(s.find(t=>t.AuditFieldId===e.AuditFieldId)),s})}})}],maxResults:99999,onRowClick:e=>!1,filters:[{field:"AuditId",operator:"==",value:null===(l=e.formBuilder.snapshot)||void 0===l?void 0:l.AuditId}],orderBy:[{field:"Name",order:"asc"}],onDataLoaded:e=>{f(e.results)}})}),(0,s.jsxs)("div",{className:"w-full flex justify-between",children:["UPDATE"===e.formBuilder.operation&&(0,s.jsx)("div",{className:"w-full flex justify-start items-center gap-1",children:(0,s.jsx)(B,{value:e.formBuilder.data["".concat(e.formBuilder.tableName,"Id")]})}),(0,s.jsx)(H.Z,{})]})]})},eC=l(3529),eT=e=>{var t,l,a,i,o,r,n;return(0,c.useEffect)(()=>{var t,l,s;if((null===(t=e.formBuilder.snapshot)||void 0===t?void 0:t.Operation)!=="Read")return;let a=JSON.stringify(JSON.parse(null===(l=e.formBuilder.snapshot)||void 0===l?void 0:l.Query),null,4),i=JSON.stringify(JSON.parse(null===(s=e.formBuilder.snapshot)||void 0===s?void 0:s.Results),null,4);e.formBuilder.setField("Query",a),e.formBuilder.setField("Results",i)},[null===(t=e.formBuilder.snapshot)||void 0===t?void 0:t.Query,null===(l=e.formBuilder.snapshot)||void 0===l?void 0:l.Results]),(0,s.jsxs)("div",{className:"w-full flex flex-col gap-4",children:[(0,s.jsxs)(eh.r,{children:[(0,s.jsx)(eh.r.Col,{span:4,children:(0,s.jsx)(z.Z,{name:"TableName"})}),(0,s.jsx)(eh.r.Col,{span:4,children:(0,s.jsx)(z.Z,{name:"Operation"})}),(0,s.jsx)(eh.r.Col,{span:4,children:(0,s.jsx)(z.Z,{name:"CreatedDate"})})]}),(0,s.jsxs)(eh.r,{children:[(0,s.jsx)(eh.r.Col,{span:4,children:(0,s.jsx)(z.Z,{name:"UserId"})}),(0,s.jsx)(eh.r.Col,{span:4,children:(0,s.jsx)(eC.o,{label:"UserId",value:null===(a=e.formBuilder.snapshot)||void 0===a?void 0:a.UserId,readOnly:!0})})]}),(0,s.jsx)(eh.r,{children:(null===(i=e.formBuilder.snapshot)||void 0===i?void 0:i.Operation)!=="Read"&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(eh.r.Col,{span:4,children:(0,s.jsx)(z.Z,{name:"Name"})}),(0,s.jsx)(eh.r.Col,{span:4,children:(0,s.jsx)(z.Z,{name:"EntityId"})})]})}),(null===(o=e.formBuilder.snapshot)||void 0===o?void 0:o.Operation)==="Read"&&(0,s.jsxs)(eh.r,{children:[(0,s.jsx)(eh.r.Col,{span:6,children:(0,s.jsx)("div",{className:"w-full h-[60vh]",children:(0,s.jsx)(z.Z,{name:"Query",varient:"textarea"})})}),(0,s.jsx)(eh.r.Col,{span:6,children:(0,s.jsx)("div",{className:"w-full h-[60vh]",children:(0,s.jsx)(z.Z,{name:"Results",varient:"textarea"})})})]}),(null===(r=e.formBuilder.snapshot)||void 0===r?void 0:r.Operation)!=="Read"&&(0,s.jsx)("div",{className:"w-full h-[500px] mt-2",children:(0,s.jsx)(eI.default,{tableName:"AuditHistoryDetail",disabledMessage:null==e.formBuilder.snapshot?"Loading...":void 0,fields:["Name","OldValue","NewValue","EntityName"],maxResults:100,orderBy:[{field:"Name",order:"ASC"}],filters:[{field:"AuditHistoryId",value:null===(n=e.formBuilder.snapshot)||void 0===n?void 0:n.AuditHistoryId}]})}),"UPDATE"===e.formBuilder.operation&&(0,s.jsx)("div",{className:"w-full flex justify-start items-center gap-1",children:(0,s.jsx)(B,{value:e.formBuilder.data["".concat(e.formBuilder.tableName,"Id")]})})]})},eR=()=>{var e;let t=e_();return(0,s.jsx)(s.Fragment,{children:t.tables.filter(e=>"Option"===e.tableName).length>0&&!(null===(e=t.props.hiddenMenuItems)||void 0===e?void 0:e.includes("Options"))&&(0,s.jsx)(T.O,{label:"Audit",icon:(0,s.jsx)(eN.Z,{size:16,strokeWidth:2,color:t.color}),onClick:()=>t.setActiveComponent({component:(0,s.jsxs)(Z.m,{defaultValue:"history",styles:{root:{display:"flex",flexDirection:"column",height:"100%",flexGrow:1},panel:{display:"flex",flexDirection:"column",flexGrow:1,height:1}},children:[(0,s.jsxs)(Z.m.List,{children:[(0,s.jsx)(Z.m.Tab,{value:"history",children:"History"}),(0,s.jsx)(Z.m.Tab,{value:"config",children:"Config"})]}),(0,s.jsx)(Z.m.Panel,{value:"history",children:(0,s.jsx)("div",{className:"w-full h-full pt-4",children:(0,s.jsx)(S,{tableName:"AuditHistory",fields:["Operation","TableName","User","Name","CreatedDate"],columnWidths:["125px","100%","100%","100%","100%"],title:"History",maxResults:100,canCreate:!1,orderBy:[{field:"CreatedDate",order:"desc"}],customForm:e=>(0,s.jsx)(eT,{formBuilder:e})})})}),(0,s.jsx)(Z.m.Panel,{value:"config",children:(0,s.jsx)("div",{className:"w-full h-full pt-4",children:(0,s.jsx)(S,{tableName:"Audit",title:"Audit",formTitle:"Audit",maxResults:100,orderBy:[{field:"Name",order:"asc"}],fields:["Name","IsCreate","IsRead","IsUpdate","IsDelete"],columnWidths:["350px","100%","100%","100%","100%"],canCreate:!1,canDelete:!1,formMaxWidth:55,formCloseOnEscape:!0,customForm:e=>(0,s.jsx)(eE,{formBuilder:e})})})})]})})})})};let eA={tableName:"",appendCustomForm:void 0,formAppendButton:void 0,formMaxWidth:void 0,formCloseOnCreate:void 0,formTitle:void 0,fields:void 0,filters:void 0,formFields:void 0,formLookupQueries:void 0,orderBy:void 0,refreshInterval:void 0,canCreate:void 0,canDelete:void 0,maxResults:50},eS=c.createContext(null),e_=()=>{let e=c.useContext(eS);if(!e)throw Error("useAdminDashContext must be used within a AdminDashContextProvider");return e};var eD=e=>{var t;let l=(0,a.Z)(),[p,f]=c.useState(void 0),[h,v]=c.useState(void 0),[y,b]=c.useState([]),[N,j]=(0,m.q)(!1),[I,w]=(0,m.q)(!1),[T,R]=c.useState({canImport:!1,canExport:!1}),A=(0,C.Z)().getIconColor(),S=async()=>{let e=await l.tables();!0===e.succeeded&&b(e.data)},_=async()=>{if(!await l.hasAllPermissions(["ACCESS_ADMIN_DASHBOARD"])){f(!1);return}f(!0);let e=!1,t=!1;await l.hasAllPermissions(["ACTION_ADMIN_ExportDependencies","ACTION_ADMIN_ExportData"])===!0&&(e=!0),await l.hasAllPermissions(["ACTION_ADMIN_ImportData"])&&(t=!0),R({canImport:t,canExport:e})};if((0,c.useEffect)(()=>{_(),S()},[]),void 0===p)return(0,s.jsx)("div",{className:"w-full h-full flex justify-center items-center",children:(0,s.jsx)(i.a,{})});if(!p)return(0,s.jsx)("div",{className:"w-full h-full flex justify-center items-center",children:"You don't have permission to view this page. Please contact your system administrator."});let D=[{order:100,navLink:(0,s.jsx)(P,{})},{order:200,navLink:(0,s.jsx)(em,{})},{order:300,navLink:(0,s.jsx)(ef,{})},{order:400,navLink:(0,s.jsx)(eR,{})},{order:500,navLink:(0,s.jsx)(ey,{})},{order:600,navLink:(0,s.jsx)(eb,{})}];void 0!==e.addMenuItems&&(D=D.concat(e.addMenuItems));let O=D.sort((e,t)=>e.order-t.order);return(0,s.jsxs)(eS.Provider,{value:{props:e,tables:y,color:A,setActiveComponent:v,emptyTableInfo:eA},children:[(0,s.jsx)(x,{opened:N,close:j.close}),(0,s.jsx)(g,{opened:I,close:w.close}),(0,s.jsx)(o.V,{padding:"md",styles:e=>({main:{backgroundColor:"dark"===e.colorScheme?e.colors.dark[8]:e.colors.gray[0],overflow:"hidden",display:"flex"}}),header:(0,s.jsx)(r.h,{height:60,p:"xs",children:(0,s.jsxs)("div",{className:"w-full h-full flex items-center justify-between text-xl",children:[(0,s.jsx)("div",{className:" pl-2",children:null!==(t=e.title)&&void 0!==t?t:"Admin Dashboard"}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[!e.forceHideToggleMode&&(0,s.jsx)(E,{}),!0===T.canImport&&!e.forceHideImportData&&(0,s.jsx)(n.z,{variant:"outline",onClick:w.open,children:"Import Data"}),!0===T.canExport&&!e.forceHideExportData&&(0,s.jsx)(n.z,{onClick:j.open,children:"Export Data"})]})]})}),navbar:(0,s.jsx)(d.w,{width:{base:320},p:"xs",children:(0,s.jsx)(d.w.Section,{grow:!0,component:u.x,mx:"-xs",px:"xs",children:O.map((e,t)=>(0,s.jsx)("span",{children:e.navLink},t))})}),children:(0,s.jsx)("div",{className:"flex w-full",children:(0,s.jsx)("div",{className:"w-full h-full flex flex-col",children:(0,s.jsx)("div",{className:"grow h-1",children:null!=h&&h.component})})})})]})};function eO(){return(0,s.jsx)(eD,{})}},1331:function(e,t,l){"use strict";l.d(t,{BR:function(){return a},F:function(){return d},QC:function(){return n},TO:function(){return s},Vx:function(){return i},bZ:function(){return u},k0:function(){return c},ku:function(){return o},mH:function(){return m},sy:function(){return r}});let s="/data/Permissions",a="/data/MetaData",i="/data/Create",o="/data/Read",r="/data/Update",n="/data/Delete",d="/data/Upsert",u="/data/Bulk",c="/data/Action",m="/data/File"},2670:function(e,t,l){"use strict";l.r(t),l.d(t,{DataTableContext:function(){return eu},default:function(){return ep},useDataTableContext:function(){return ec}});var s=l(4246),a=l(5381),i=l(7378),o=l(7302),r=l(5812),n=l(8176),d=l(9478),u=l(60);let c={page:1,fields:null,orderBy:null,searchField:null,searchValue:null,setData:null,active:null};var m=l(7152),p=l(3529),f=l(2268);function h(e){return null!==e}var v=()=>{var e,t,l;let a=ec(),[o,r]=(0,i.useState)({searchField:null,searchValue:null}),[n]=(0,f.c)(o.searchValue,500),d=()=>a.getFields().filter(e=>"string"==typeof e.displayName&&null!=e.metadataField).map((e,t)=>{var l,s,a,i;let o=null!==(i=null===(l=e.metadataField)||void 0===l?void 0:l.lookupName)&&void 0!==i?i:null===(s=e.metadataField)||void 0===s?void 0:s.name;return{value:"".concat(e.alias).concat(""!==e.alias?".":"").concat(o),label:null===(a=e.metadataField)||void 0===a?void 0:a.displayName}}),u=async()=>{var e,t;let l=null===(t=a.state.metadata)||void 0===t?void 0:null===(e=t.fields.find(e=>e.name===o.searchField))||void 0===e?void 0:e.type,s="";if("DateTime"===l&&(null==n?void 0:n.trim())!==""){let e=-(new Date().getTimezoneOffset()/60);s="~".concat(e)}let i=n+s,r=await a.getData({...c,page:1,searchField:o.searchField,searchValue:i,active:"Active"===a.state.activeSwitch,orderBy:a.state.data.orderBy});a.dispatch({type:"SEARCH_VALUE_CHANGE",payload:{searchValue:i,searchField:o.searchField,data:r.data}})};return(0,i.useEffect)(()=>{null!=n&&u()},[n,o.searchField]),(0,i.useEffect)(()=>{if(null!=a.props.tableName&&""!==a.props.tableName){var e,t,l;r({searchField:null!==(l=null===(t=d())||void 0===t?void 0:null===(e=t[0])||void 0===e?void 0:e.value)&&void 0!==l?l:null,searchValue:null})}},[a.props.tableName]),(0,s.jsxs)("div",{className:"flex",children:[(0,s.jsx)(m.Ph,{placeholder:"Search",style:{width:"auto"},data:null!==(e=d())&&void 0!==e?e:[],value:null!==(t=o.searchField)&&void 0!==t?t:"",onChange:e=>{r({...o,searchField:e})}}),(0,s.jsx)(p.o,{placeholder:"Search...",style:{width:"auto"},value:null!==(l=o.searchValue)&&void 0!==l?l:"",onChange:e=>{r({...o,searchValue:e.currentTarget.value})}})]})},x=l(5371),y=l(8255),g=l(823),b=e=>{let t=(0,o.rZ)(),l=ec(),{colorScheme:a,toggleColorScheme:i}=(0,g.X)(),r="dark"===a?t.colors.gray[4]:t.colors.dark[7],n="",d="";return null!=l.state.data.orderBy&&l.state.data.orderBy.length>0&&(n=l.state.data.orderBy[0].field,d=l.state.data.orderBy[0].order),(0,s.jsx)(s.Fragment,{children:l.getFields().map((e,t)=>{if(null==e.metadataField)return(0,s.jsx)("th",{style:{width:e.width},className:"".concat(e.width.endsWith("px")?"flex-none":""," truncate"),children:(0,s.jsx)("div",{className:"flex items-center",children:"string"==typeof e.displayName?e.displayName:e.displayName(l.refHandle)})},t);let a=e.metadataField,i=(null==a?void 0:a.lookupName)!=null?a.lookupName:a.name,o="".concat(e.alias).concat(""!==e.alias?".":"").concat(i);if(null!=a)return(0,s.jsx)("th",{style:{width:e.width},className:"".concat(e.width.endsWith("px")?"flex-none":""," truncate"),children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("span",{className:"cursor-pointer",onClick:()=>{l.sort(o)},children:a.displayName}),n===o&&"desc"===d&&(0,s.jsx)(x.Z,{size:16,strokeWidth:2,color:r,className:" ml-2"}),n===o&&"asc"===d&&(0,s.jsx)(y.Z,{size:16,strokeWidth:2,color:r,className:"ml-2"})]})},o)})})},N=l(7628),j=e=>{let t=ec();return void 0!==e.disabledMessage?(0,s.jsx)("div",{className:"w-full h-full flex flex-col justify-center items-center",children:e.disabledMessage}):e.isLoadingData?(0,s.jsx)("div",{className:"w-full h-full flex justify-center items-center",children:(0,s.jsx)(N.a,{})}):"MISSING_READ_PERMISSIONS"===t.state.type?(0,s.jsx)("div",{className:"w-full h-full flex flex-col justify-center items-center",children:(0,s.jsxs)("div",{children:["Missing read permission for ",e.tableName,"."]})}):void 0},I=l(8117),w=l(226),E=l(1198),C=l(633),T=l(3792),R=l(8076),A=l(9572),S=l(1331),_=l(6805);let D={getHighestPermissionLevel:e=>void 0!==e.find(e=>e.endsWith("_SYSTEM"))?"SYSTEM":void 0!==e.find(e=>e.endsWith("_TEAM"))?"TEAM":void 0!==e.find(e=>e.endsWith("_USER"))?"USER":"NONE"};var O=l(6521);let B=(0,_.Ue)()((e,t)=>({tablePermissions:[],teams:[],getTablePermissions:async(e,l)=>{let s=t().tablePermissions.find(e=>e.tableName===l);if(void 0!==s)return s.permissions;let a="".concat("TABLE_{tableName}_READ_SYSTEM, TABLE_{tableName}_READ_TEAM, TABLE_{tableName}_READ_USER".replaceAll("{tableName}",l),", ").concat("TABLE_{tableName}_CREATE_SYSTEM, TABLE_{tableName}_CREATE_TEAM, TABLE_{tableName}_CREATE_USER".replaceAll("{tableName}",l),", ").concat("TABLE_{tableName}_DELETE_SYSTEM, TABLE_{tableName}_DELETE_TEAM, TABLE_{tableName}_DELETE_USER".replaceAll("{tableName}",l),", ").concat("TABLE_{tableName}_UPDATE_SYSTEM, TABLE_{tableName}_UPDATE_TEAM, TABLE_{tableName}_UPDATE_USER".replaceAll("{tableName}",l)),i=await e.execute({url:S.TO,method:"POST",body:{method:"has_permissions",parameters:{permissionNames:a.split(",").map(e=>e.trim())}}});if((null==i?void 0:i.succeeded)===!0){let e=i.data;if(e.length>0){let t=e.filter(e=>e.startsWith("TABLE_".concat(l,"_READ"))),s=e.filter(e=>e.startsWith("TABLE_".concat(l,"_CREATE"))),a=e.filter(e=>e.startsWith("TABLE_".concat(l,"_DELETE"))),i=e.filter(e=>e.startsWith("TABLE_".concat(l,"_UPDATE")));return{read:D.getHighestPermissionLevel(t),create:D.getHighestPermissionLevel(s),delete:D.getHighestPermissionLevel(a),update:D.getHighestPermissionLevel(i)}}}return{read:"NONE",create:"NONE",delete:"NONE",update:"NONE"}},getPermissions:async(e,l)=>{let s=t().tablePermissions,a=l.filter(e=>null!=s.find(t=>t.tableName===e));if(a.length===l.length)return a;let i=await e.execute({url:S.TO,method:"POST",body:{method:"has_permissions",parameters:{permissionNames:l}}});return(null==i?void 0:i.succeeded)===!0?i.data:[]},getTeams:async l=>{var s,a;if(t().teams.length>0)return t().teams;let i=new O.ZP(["Name"]).top(99999).from("Team").join("Team.TeamId","TeamUser.TeamId","tu").join("tu.UserId","User.UserId","u").distinct().toReadRequest(),o=await l.read(i);return o.succeeded?(e({teams:null!==(s=o.data.results.map(e=>e.Name))&&void 0!==s?s:[]}),null!==(a=o.data.results.map(e=>e.Name))&&void 0!==a?a:[]):[]}}));var P=l(6731),L=l(8676),k=e=>{let t=(0,a.Z)(),l=ec(),[o,r]=i.useState(null),[n,d]=i.useState(!1),[u,c]=i.useState("create,update"),[p,f]=i.useState([]),h=async()=>{if(null===o)return;d(!0);let s=new FormData;s.append("file",o),s.append("name","TABLE_ImportData"),s.append("parameters",JSON.stringify({tableName:l.props.tableName,operation:u}));let a=await t.execute({url:S.mH,method:"POST",body:s,hideFailureMessage:!0});if((null==a?void 0:a.succeeded)===!1){let e=a.data;if(null!=e&&null!=e.errors&&e.errors.length>0)f(e.errors);else{var i;f([null!==(i=a.friendlyMessage)&&void 0!==i?i:"Unknown error"])}}else(null==a?void 0:a.succeeded)===!0&&(l.refresh(),e.close());d(!1)};return(0,i.useEffect)(()=>{!0===e.opened&&(d(!1),r(null),f([]))},[e.opened]),(0,s.jsx)(P.u,{opened:e.opened,onClose:e.close,title:"Import Data",size:"lg",closeOnEscape:!n,closeOnClickOutside:!n,withCloseButton:!n,centered:!0,styles:{overlay:{zIndex:4e3},inner:{zIndex:4001}},children:p.length>0?(0,s.jsx)("div",{className:"w-full flex flex-col gap-4 h-96",children:(0,s.jsx)("div",{className:"w-full h-full flex flex-col gap-2 overflow-y-auto",children:p.map((e,t)=>(0,s.jsx)("div",{className:"w-full bg-red-100 py-2 rounded-md",children:e},t))})}):(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)("div",{className:"w-full relative",children:[!0===n&&(0,s.jsx)("div",{className:"absolute w-full h-full flex justify-center items-center",children:(0,s.jsx)(N.a,{})}),(0,s.jsxs)("div",{className:"w-full flex flex-col gap-4 ".concat(n?"invisible":""),children:[(0,s.jsx)(m.Ph,{label:"Operation",placeholder:"Select Operation",data:[{value:"create,update",label:"Create and Update"},{value:"create",label:"Create Only"},{value:"update",label:"Update Only"}],value:u,onChange:e=>{c(e)}}),(0,s.jsx)(L.S,{placeholder:"Click to choose import file",label:"File Upload",required:!0,value:o,onChange:e=>{r(e)}}),(0,s.jsx)("div",{className:"w-full flex justify-end",children:(0,s.jsx)(w.z,{onClick:h,disabled:null===o,children:"Upload"})})]})]})})})},F=l(1879),M=()=>{let[e,t]=(0,i.useState)(!1),[l,o]=(0,i.useState)(void 0),r=(0,A.Z)().getIconColor(),n=(0,a.Z)(),d=ec(),u=B(),[c,m]=(0,F.q)(!1),p=async()=>{let e=await u.getPermissions(n,["TABLE_".concat(d.props.tableName,"_IMPORT"),"TABLE_".concat(d.props.tableName,"_EXPORT"),"ACTION_TABLE_ImportData","ACTION_TABLE_ExportData"]),l=await u.getTablePermissions(n,d.props.tableName),s=!1,a=!1;e.find(e=>e==="TABLE_".concat(d.props.tableName,"_IMPORT"))&&e.find(e=>"ACTION_TABLE_ImportData"===e)&&"NONE"!==l.create&&"NONE"!==l.update&&(null==d.props.canImport||d.props.canImport)&&(s=!0),e.find(e=>e==="TABLE_".concat(d.props.tableName,"_EXPORT"))&&e.find(e=>"ACTION_TABLE_ExportData"===e)&&"NONE"!==l.read&&(null==d.props.canExport||d.props.canExport)&&(a=!0),o({Import:s,Export:a}),null==d.props.disabledMessage&&(s||a)&&t(!0)},f=async()=>{await n.action("TABLE_ImportTemplate",{tableName:d.props.tableName},"ImportTemplate_".concat(d.props.tableName,".xlsx"))},h=async()=>{await n.action("TABLE_ExportData",{query:{tableName:d.props.tableName,fields:["*"],orderBy:d.props.orderBy,filters:d.props.filters,joins:d.props.joins,except:d.props.except,maxResults:999999}},"ExportData_".concat(d.props.tableName,".xlsx"))};return((0,i.useEffect)(()=>{l||p()},[l,d.state.isLoadingData]),(0,i.useEffect)(()=>{null==d.props.disabledMessage&&((null==l?void 0:l.Import)||(null==l?void 0:l.Export))&&t(!0)},[d.props.disabledMessage]),e&&null!=d.state.metadata)?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(k,{opened:c,close:m.close}),(0,s.jsxs)(I.v,{shadow:"md",width:200,children:[(0,s.jsx)(I.v.Target,{children:(0,s.jsx)(w.z,{radius:"xl",variant:"subtle",styles:{root:{padding:6}},children:(0,s.jsx)(E.Z,{size:24,strokeWidth:2,color:r})})}),(0,s.jsxs)(I.v.Dropdown,{children:[((null==l?void 0:l.Import)||(null==l?void 0:l.Export))&&(0,s.jsx)(I.v.Label,{children:"Data"}),(null==l?void 0:l.Import)&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(I.v.Item,{icon:(0,s.jsx)(C.Z,{size:14}),onClick:f,children:"Import Template"}),(0,s.jsx)(I.v.Item,{icon:(0,s.jsx)(T.Z,{size:14}),onClick:m.open,children:"Import Data"})]}),(null==l?void 0:l.Export)&&(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(I.v.Item,{icon:(0,s.jsx)(R.Z,{size:14}),onClick:h,children:"Export Data"})})]})]})]}):(0,s.jsx)(s.Fragment,{})},U=e=>{var t,l,a,i,m,p,f,h,x,y,g;let N=ec(),I=(0,o.rZ)(),w=void 0!==N.state.metadata,E=!0===N.props.scrollable||void 0===N.props.scrollable,C=(void 0===N.props.canCreate||!0===N.props.canCreate)&&"NONE"!==N.state.permissions.create&&void 0===N.props.disabledMessage,T=null==N.props.disabledMessage&&"NONE"!==N.state.permissions.read,R=null!=N.props.customCreateButton?null===(t=(l=N.props).customCreateButton)||void 0===t?void 0:t.call(l,()=>N.openForm(void 0)):void 0,A="NONE"!==N.state.permissions.read&&void 0===N.props.disabledMessage&&(null==N.props.searchable||!0===N.props.searchable),S=!0===N.props.showActiveSwitch&&"NONE"!==N.state.permissions.read&&void 0===N.props.disabledMessage,_=!0===N.props.showOptions||null==N.props.showOptions,D=void 0!==N.props.disabledMessage||"NONE"===N.state.permissions.read||!0===N.state.isLoadingData?(0,s.jsx)(j,{tableName:N.props.tableName,permissions:N.state.permissions,isLoadingData:N.state.isLoadingData,disabledMessage:N.props.disabledMessage}):void 0,O=void 0===N.props.title||""!==N.props.title||_||S||A||C||null!=R,B=async e=>{await N.getData({...c,page:e,orderBy:N.state.data.orderBy,setData:!0}),void 0!==N.props.onPageChange&&N.props.onPageChange(e)},P=async e=>{let t=await N.getData({...c,page:1,active:"Active"===e,setData:!0,searchField:N.state.searchField,searchValue:N.state.searchValue,orderBy:N.state.data.orderBy});N.dispatch({type:"ACTIVE_SWITCH_CHANGE",payload:{activeSwitch:e,data:t.data}})};return(0,s.jsxs)("div",{className:"relative flex flex-col h-full w-full rtable",children:[void 0!==D&&(0,s.jsx)("div",{className:" absolute w-full h-full pt-11",children:(0,s.jsx)("div",{className:"w-full h-full",children:D})}),(0,s.jsxs)("div",{className:"text-lg flex justify-between items-center",children:[(0,s.jsx)("div",{className:"flex items-center",children:w?void 0!==N.props.title?N.props.title:"Manage ".concat(void 0===N.state.metadata?N.props.tableName:null===(a=N.state.metadata)||void 0===a?void 0:a.displayName,"s"):""}),(0,s.jsxs)("div",{className:"".concat(O?"flex":"hidden"," items-center gap-2"),children:[_&&(0,s.jsx)(M,{}),S&&(0,s.jsx)("div",{className:" m-2",children:(0,s.jsx)(r.s,{data:["Active","Inactive"],size:"sm",styles:{label:{paddingLeft:"0.5125rem",paddingRight:"0.5125rem",paddingTop:0,paddingBottom:0}},onChange:e=>{P(e)}})}),!0===A?(0,s.jsx)(v,{}):(0,s.jsx)("div",{className:" w-1 h-9"}),C&&null==R&&(0,s.jsx)("div",{onClick:()=>{N.openForm(void 0),null!=N.props.formOnOpen&&N.props.formOnOpen("CREATE",void 0)},className:"p-1 rounded-full w-8 h-8 flex justify-center items-center cursor-pointer",style:{backgroundColor:I.fn.primaryColor()},children:(0,s.jsx)(u.Z,{size:22,strokeWidth:2,color:"white"})}),C&&null!=R&&R]})]}),(0,s.jsxs)(n.i,{"aria-label":N.props.title,highlightOnHover:null===(h=null===(i=N.props.tableStyle)||void 0===i?void 0:i.highlighOnHover)||void 0===h||h,striped:null!==(x=null===(m=N.props.tableStyle)||void 0===m?void 0:m.striped)&&void 0!==x&&x,withBorder:null!==(y=null===(p=N.props.tableStyle)||void 0===p?void 0:p.withBorder)&&void 0!==y&&y,withColumnBorders:null!==(g=null===(f=N.props.tableStyle)||void 0===f?void 0:f.withColumnBorders)&&void 0!==g&&g,className:"".concat(E?"  overflow-x-hidden":""," flex flex-col grow"),children:[(0,s.jsx)("thead",{className:"".concat(E?"px-2":""),children:(0,s.jsx)("tr",{className:"flex",children:(0,s.jsx)(b,{})})}),(0,s.jsx)("tbody",{className:"relative overflow-x-hidden ".concat(E?"grow overflow-y-scroll pl-2 pr-0.5":""," "),children:e.children})]}),!0===T&&(0,s.jsxs)("div",{className:"w-full flex justify-between items-center mt-4 px-2",children:[(0,s.jsx)("div",{className:" text-sm",children:void 0!==N.state.data.totalResults&&N.state.data.maxResults&&N.state.data.currentPage&&(0,s.jsxs)(s.Fragment,{children:[0===N.state.data.results.length?0:N.state.data.currentPage*N.state.data.maxResults-(N.state.data.maxResults-1)," - ",N.state.data.currentPage*N.state.data.maxResults>N.state.data.totalResults?N.state.data.totalResults:N.state.data.currentPage*N.state.data.maxResults," of ",N.state.data.totalResults]})}),(null==N.props.pagination||!0===N.props.pagination)&&(0,s.jsx)(d.t,{value:N.state.data.currentPage,total:N.state.data.pages<1?1:N.state.data.pages,onChange:e=>{B(e)},size:"sm",withEdges:!0})]})]})},W=l(2289),Z=l(2063),z=l(8971);let H=()=>({type:"INSTANTIATED",tableName:void 0,data:void 0,snapshot:void 0,dirtyFields:[],validationMessages:[],metadata:void 0,canUpdate:!0,canCreate:!0,canRead:{canRead:!0,message:""},isLoading:!0,forceIsLoading:!1,isSubmitted:!1,eventListeners:[]}),V=(e,t)=>{var l,s,a;switch(console.log("FormBuilder: "+t.type),t.type){case"START_INITIAL_LOAD":return{...H(),data:t.payload.data,snapshot:void 0,metadata:e.metadata,isLoading:!0,forceIsLoading:null!==(l=t.payload.forceIsLoading)&&void 0!==l&&l,type:"START_INITIAL_LOAD"};case"INITIAL_LOAD_COMPLETE":return{...e,...t.payload,isLoading:!1,dirtyFields:[],type:"INITIAL_LOAD_COMPLETE"};case"SET_FIELD_VALUE":let i=t.payload.field;return{...e,...e.dirtyFields.includes(i)?{dirtyFields:[...e.dirtyFields]}:{dirtyFields:[...e.dirtyFields,i]},data:{...e.data,[i]:t.payload.value},type:"SET_FIELD_VALUE"};case"SET_IS_LOADING":return{...e,isLoading:!0,type:"SET_IS_LOADING"};case"SUBMIT_COMPLETE":return{...e,isLoading:!1,isSubmitted:!0,validationMessages:[],dirtyFields:[],type:"SUBMIT_COMPLETE"};case"SUBMIT_CANCELLED":return{...e,isLoading:!1,type:"SUBMIT_CANCELLED"};case"SET_VALIDATION_MESSAGES":return{...e,validationMessages:t.payload,type:"SET_VALIDATION_MESSAGES"};case"SET_VALIDATION_MESSAGE":let o=t.payload;return{...e,validationMessages:[...e.validationMessages.filter(e=>e.field!==o.field),o],type:"SET_VALIDATION_MESSAGE"};case"SET_DATA_TO_EDIT":let r=t.payload;return{...e,validationMessages:[],snapshot:t.payload.snapshot,data:t.payload.data,canUpdate:null!=t.payload.data&&(null==r.canUpdate||!1!=r.canUpdate)&&null!==(s=null==r?void 0:r.data._ui_info_.canUpdate)&&void 0!==s&&s,forceIsLoading:null!==(a=r.forceIsLoading)&&void 0!==a&&a,type:"SET_DATA_TO_EDIT"};case"CLEAR_EDIT_DATA":return{...e,type:"CLEAR_EDIT_DATA",data:e.snapshot};case"CLEAR":return{...e,type:"CLEAR",data:void 0,snapshot:void 0};case"SET_SHOW_FORCE_LOADING":return{...e,forceIsLoading:t.payload.forceIsLoading,type:"SET_SHOW_FORCE_LOADING"}}return{...e}};var G=l(8788),q=l(6052),J=()=>({get:()=>(0,G.Z)(),validate:e=>(0,q.Z)(e)}),X=e=>{var t,l;let s=(0,a.Z)(),o=B(),r=J(),n=(0,z.Z)(),d=(0,i.useRef)(null),[u,c]=(0,i.useReducer)(V,H()),[m,p]=(0,i.useState)([]),f=[],h=[],v=[],x=async t=>{if(null==e.tableName||""===e.tableName)return;if(!t.refresh){var l,a;c({type:"START_INITIAL_LOAD",payload:{tableName:e.tableName,data:null!=u.metadata?await y(u.metadata,void 0):void 0,forceIsLoading:null!==(a=null!==(l=t.forceShowLoading)&&void 0!==l?l:e.forceShowLoading)&&void 0!==a&&a}})}let i=e.metadata;null==i&&(i=await s.metadata(e.tableName));let r=e.snapshot,n=!1,d=!1,f=!1;if(null==e.snapshot&&null!=t.id||t.refresh){let l=await s.read({tableName:e.tableName,fields:["*"],maxResults:1,page:1,id:t.refresh?u.snapshot["".concat(e.tableName,"Id")]:t.id});if(null==l||!l.succeeded)return;null==l.data.results||0===l.data.results.length?n=!0:d=(r=l.data.results[0])._ui_info_.canUpdate}null!=e.snapshot&&(d=e.snapshot._ui_info_.canUpdate);let h=await y(i,r);"NONE"!==(await o.getTablePermissions(s,e.tableName)).create&&(f=!0),null!=e.canUpdate&&!1===e.canUpdate&&(d=!1),null!=e.canCreate&&!1===e.canCreate&&(f=!1),t.refreshDatatables&&await N(),c({type:"INITIAL_LOAD_COMPLETE",payload:{metadata:i,snapshot:r,data:h,canUpdate:d,canCreate:f,canRead:{canRead:!n,message:n?"This record doesn't exist or you are missing the required permissions to access ".concat(e.tableName):""}}}),m.length>0&&(b(m.pop()),p([]))},y=async(t,l)=>{if(void 0!==t){if(void 0===l){var s;return{...await g(t),...null===(s=e.defaults)||void 0===s?void 0:s.reduce((e,t)=>({...e,[t.field]:t.value}),{})}}if(null!=l){let s=Object.keys(l).reduce((s,a)=>(null!==l[a]&&(void 0!==t.fields.find(e=>e.name===a)||["_ui_info_"].includes(a)||a==="".concat(e.tableName,"Id"))&&(s[a]=l[a]),s),{});return{...await g(t),...s}}}},g=async t=>{var l,a;let i=t.fields.filter(e=>"Single"===e.type||"Int32"===e.type||"Int64"===e.type||"Double"===e.type||"Decimal"===e.type).map(e=>({field:e.name,value:e.isNullable?"":0})),o=null==t?void 0:t.fields.filter(e=>"String"===e.type||"Guid"===e.type).map(e=>({field:e.name,value:""})),r=null==t?void 0:t.fields.filter(e=>"Boolean"===e.type).map(e=>({field:e.name,value:!1})),d=new Date;d.setUTCHours(0,0,0,0);let u=null==t?void 0:t.fields.filter(e=>"DateTime"===e.type).map(e=>({field:e.name,value:e.isNullable?null:d.toISOString()})),c=null==t?void 0:t.fields.filter(e=>"Lookup"===e.type).map(t=>{var l,s,a;return{field:t.name,value:null!==(a=null===(s=e.defaults)||void 0===s?void 0:null===(l=s.find(e=>e.field===t.name))||void 0===l?void 0:l.value)&&void 0!==a?a:null}});for(let i of null!==(l=t.fields)&&void 0!==l?l:[])if("Lookup"===i.type&&void 0!==e.defaults)for(let t of null!==(a=e.defaults)&&void 0!==a?a:[])t.field===i.name&&await n.getLookupLabel(s,i.name,i.lookupTable,i.lookupTableNameField,t.value);return{...null==i?void 0:i.reduce((e,t)=>({...e,[t.field]:t.value}),{}),...null==o?void 0:o.reduce((e,t)=>({...e,[t.field]:t.value}),{}),...null==r?void 0:r.reduce((e,t)=>({...e,[t.field]:t.value}),{}),...null==u?void 0:u.reduce((e,t)=>({...e,[t.field]:t.value}),{}),...null==c?void 0:c.reduce((e,t)=>({...e,[t.field]:t.value}),{}),_ui_info_:{canUpdate:!0,canDelete:!0}}},b=async(t,l)=>{void 0!==u.metadata?c({type:"SET_DATA_TO_EDIT",payload:{data:await y(u.metadata,t),snapshot:t,...null!=e.canUpdate?{canUpdate:e.canUpdate}:{},forceIsLoading:null!=l&&l}}):p(e=>[...e,t])},N=()=>{for(let e of f)e.refresh()},j=async(t,l,a)=>{var i;let o={...u.data},r={};if(null!=t){let e=await t(o);if(!e.continue)return;r={...r,...e.parameters}}if(!w())return;if(c({type:"SET_IS_LOADING"}),null!=e.onPreSave){let t=await e.onPreSave(o);if(!1===t.continue){c({type:"SUBMIT_CANCELLED"});return}r={...r,...t.parameters}}for(let e of h)if("PRE_SAVE"===e.eventName&&!1===await e.callback(o,r)){c({type:"SUBMIT_CANCELLED"});return}if(null!=l){let e=await l(o);if(!1===e.continue){c({type:"SUBMIT_CANCELLED"});return}r={...r,...e.parameters}}let n=await s.execute({url:void 0===u.snapshot?S.Vx:S.sy,method:void 0===u.snapshot?"POST":"PATCH",body:{tableName:null===(i=u.metadata)||void 0===i?void 0:i.tableName,fields:o,parameters:r}});if((null==n?void 0:n.succeeded)===!0){for(let t of(void 0!==e.onPostSave&&await e.onPostSave(void 0===u.snapshot?"CREATE":"UPDATE",n.data["".concat(e.tableName,"Id")],n.data),h))"POST_SAVE"===t.eventName&&t.callback(void 0===u.snapshot?"CREATE":"UPDATE",n.data["".concat(e.tableName,"Id")],n.data);null!=a&&a(void 0===u.snapshot?"CREATE":"UPDATE",n.data["".concat(e.tableName,"Id")],n.data)}else{for(let t of(void 0!==e.onPostSave&&await e.onPostSave("FAILED","",{}),h))"POST_SAVE"===t.eventName&&t.callback("FAILED","",{});null!=a&&a("FAILED","",{})}c({type:"SUBMIT_COMPLETE"}),N()},I=async e=>{var t;return(await s.execute({url:void 0===u.snapshot?S.Vx:S.sy,method:void 0===u.snapshot?"POST":"PATCH",body:{tableName:null===(t=u.metadata)||void 0===t?void 0:t.tableName,fields:u.data,parameters:e}})).data},w=()=>{var e,t;let l=[];for(let s of null!==(t=null===(e=u.metadata)||void 0===e?void 0:e.fields)&&void 0!==t?t:[]){let e=u.data[s.name];if(!["CreatedById","UpdatedById"].includes(s.name)){if(["Single","Int32","Int64","Double","Decimal"].includes(s.type)&&("-"===e||"."===e)){let t='"'.concat(e,'" is not a valid number');l.push({field:s.name,message:t})}if(("Lookup"===s.type||"DateTime"===s.type)&&(!1===s.isNullable||s.isRequired||v.includes(s.name))&&null==e){let e="".concat(s.displayName," is required");l.push({field:s.name,message:e}),console.warn(e)}if((!0===s.isRequired||v.includes(s.name))&&(null==e||""===e)){let e="".concat(s.displayName," is required");l.push({field:s.name,message:e}),console.warn(e)}if("Guid"===s.type&&""!==e&&!r.validate(e)){let e="".concat(s.displayName," is not a valid Id");l.push({field:s.name,message:e}),console.warn(e)}}}return!(l.length>0)||(c({type:"SET_VALIDATION_MESSAGES",payload:l}),!1)},E=async(e,t)=>{await x({id:e,refresh:!1,refreshDatatables:!0,forceShowLoading:t})};return(0,i.useEffect)(()=>{null!=e.tableName&&""!==e.tableName&&x({id:e.id,refresh:!1,refreshDatatables:!1})},[e.tableName,e.id]),(0,i.useEffect)(()=>{u.snapshot!=e.snapshot&&b(e.snapshot)},[e.snapshot]),(0,i.useEffect)(()=>{m.length>0&&"INITIAL_LOAD_COMPLETE"===u.type&&(b(m.pop()),p([]))},[u.type,m]),{metadata:u.metadata,dispatch:c,data:u.data,snapshot:u.snapshot,setSnapshot:b,firstInputRef:d,lookupExclusions:null!==(t=e.lookupExclusions)&&void 0!==t?t:[],lookupQueries:null!==(l=e.lookupQueries)&&void 0!==l?l:[],canUpdate:u.canUpdate,canCreate:u.canCreate,canRead:u.canRead,defaults:e.defaults,validationMessages:u.validationMessages,isLoading:u.isLoading||u.forceIsLoading,isSubmitted:u.isSubmitted,operation:null!=e.snapshot||null!=u.snapshot?"UPDATE":"CREATE",stateType:u.type,tableName:e.tableName,reload:function(){let t=!(arguments.length>0)||void 0===arguments[0]||arguments[0];return x({id:u.snapshot["".concat(e.tableName,"Id")],refresh:!0,refreshDatatables:t})},setField:(e,t)=>{c({type:"SET_FIELD_VALUE",payload:{field:e,value:t}})},setFieldError:(e,t)=>{c({type:"SET_VALIDATION_MESSAGE",payload:{field:e,message:t}})},isDirty:e=>null==e?u.dirtyFields.length>0:u.dirtyFields.includes(e),addDataTable:e=>{null!=f.find(t=>t.dataTableId===e.dataTableId)&&(f=f.filter(t=>t.dataTableId!==e.dataTableId)),f.push(e)},addRequiredField:e=>{v.includes(e)||v.push(e)},removeRequiredField:e=>{v=v.filter(t=>t!==e)},reloadDataTables:N,save:j,saveSilent:I,load:E,on:(e,t)=>{h.push({eventName:e,callback:t})},clearEdits:()=>{c({type:"CLEAR_EDIT_DATA"})},clear:()=>{c({type:"CLEAR"})},validate:w,setShowForceLoading:e=>{c({type:"SET_FORCE_LOADING",payload:{forceIsLoading:e}})}}},Y=l(2815),Q=l(4323),$=e=>{let t=(()=>{if(!0===e.formBuilder.isLoading)return!0;if(void 0!==e.formBuilder&&void 0!==e.formBuilder.metadata&&void 0!==e.formBuilder.data){for(let t of e.formBuilder.metadata.fields)if(void 0===e.formBuilder.data[t.name])return console.warn("No data for field: "+t.name+". Ensure lookup fields are spelled correctly."),!0}return!1})()||!0===e.showLoading;return(0,s.jsx)(Q.ZP,{formBuilder:e.formBuilder,children:(0,s.jsxs)("div",{className:"".concat(!t&&!0!==e.showLoading&&e.formBuilder.canRead.canRead&&e.formBuilder.canCreate?"":"relative overflow-hidden"," ").concat(e.className),children:[t&&(0,s.jsx)("div",{className:"absolute w-full h-full flex justify-center items-center",style:{zIndex:4e3},children:(0,s.jsx)(N.a,{})}),!t&&!1===e.formBuilder.canRead.canRead&&(0,s.jsx)("div",{className:"absolute w-full h-full flex justify-center items-center text-center",style:{zIndex:10},children:e.formBuilder.canRead.message}),!t&&"CREATE"===e.formBuilder.operation&&!1===e.formBuilder.canCreate&&(0,s.jsx)("div",{className:"absolute w-full h-full flex justify-center items-center text-center",style:{zIndex:10},children:"This record doesn't exist or you are missing the required permissions to create ".concat(e.formBuilder.tableName)}),(0,s.jsx)("div",{className:"".concat(t||!1===e.formBuilder.canRead.canRead||"CREATE"===e.formBuilder.operation&&!1===e.formBuilder.canCreate?"invisible":""," ").concat(e.className),children:e.children})]})})};let K=(0,i.forwardRef)((e,t)=>{var l,a,o;let r=ec(),n=X({tableName:null!==(a=null===(l=r.state.metadata)||void 0===l?void 0:l.tableName)&&void 0!==a?a:"",id:r.state.editRecordId,metadata:r.state.metadata,defaults:r.props.formFieldDefaults,lookupExclusions:r.props.formLookupExclusions,lookupQueries:r.props.formLookupQueries,canCreate:"NONE"!==r.state.permissions.create,canUpdate:r.props.canUpdate,onPreSave:async e=>(!0===r.props.formCloseOnCreate||r.props.formCloseOnCreate,null!=r.props.formOnPreSave&&r.props.formOnPreSave(e),{continue:!0}),onPostSave:async(e,t,l)=>{if("FAILED"===e);else if("CREATE"===e&&!1===r.props.formCloseOnCreate&&n.setSnapshot(l),"UPDATE"===e&&!1===r.props.formCloseOnUpdate&&n.setSnapshot(l),null!=r.props.formOnPostSave&&r.props.formOnPostSave(e,n.data),"CREATE"===e&&(!0===r.props.formCloseOnCreate||void 0===r.props.formCloseOnCreate)||"UPDATE"===e&&(!0===r.props.formCloseOnUpdate||void 0===r.props.formCloseOnUpdate)){var s,a;r.closeForm(),r.getData({...c,page:null===(s=r.state.data)||void 0===s?void 0:s.currentPage,orderBy:null===(a=r.state.data)||void 0===a?void 0:a.orderBy,setData:!0})}}}),d=()=>{if(void 0!==r.state.metadata){let e=r.state.metadata.fields.filter(e=>void 0===r.props.formFields||r.props.formFields.includes(e.name));if(e.length<=3)return 12/e.length}return 4};return(0,i.useImperativeHandle)(t,()=>({formBuilder:n})),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(P.u,{opened:"START_INITIAL_LOAD"===n.stateType,onClose:()=>{},withCloseButton:!1,size:"auto",closeOnClickOutside:!1,closeOnEscape:!1,overlayProps:{blur:3},styles:{overlay:{...void 0!==r.props.formZIndex&&{zIndex:r.props.formZIndex}},inner:{...void 0!==r.props.formZIndex&&{zIndex:r.props.formZIndex+1}},content:{display:"none"}},centered:!0}),(0,s.jsx)(P.u,{title:(()=>{var e;if(null!=r.props.formTitle)return r.props.formTitle;let t="";"UPDATE"===n.operation&&null!=n.data&&!0===n.data._ui_info_.canUpdate&&(t="Edit"),"CREATE"===n.operation&&"NONE"!==r.state.permissions.create&&(t="Create");let l=void 0===r.state.metadata?r.props.tableName:null===(e=r.state.metadata)||void 0===e?void 0:e.displayName;return""!==t?"".concat(t," ").concat(l):l})(),opened:r.formDisclosure.opened&&null!=n.metadata&&"START_INITIAL_LOAD"!==n.stateType,onClose:()=>{if(null!=r.props.formOnClose&&r.props.formOnClose(),n.isSubmitted){var e,t;r.closeForm(),r.getData({...c,page:null===(e=r.state.data)||void 0===e?void 0:e.currentPage,orderBy:null===(t=r.state.data)||void 0===t?void 0:t.orderBy,setData:!0})}else r.formDisclosure.close()},transitionProps:{transition:"fade",duration:100},closeOnClickOutside:!1,closeOnEscape:null===(o=r.props.formCloseOnEscape)||void 0===o||o,size:(()=>{if(null!=r.props.formMaxWidth)return"".concat(r.props.formMaxWidth,"rem");if(void 0!==r.state.metadata){let e=r.state.metadata.fields.filter(e=>void 0===r.props.formFields||r.props.formFields.includes(e.name));if(e.length<=3){let t=e.length/3*72;return void 0!==r.props.formMaxWidth&&t<r.props.formMaxWidth?"".concat(r.props.formMaxWidth,"rem"):"".concat(t,"rem")}}return void 0!==r.props.formMaxWidth&&r.props.formMaxWidth>72?"".concat(r.props.formMaxWidth,"rem"):"72rem"})(),overlayProps:{blur:3},styles:{root:{overflow:"visible"},body:{...!0===n.isLoading&&{position:"relative",overflow:"hidden",paddingLeft:0,paddingRight:0}},overlay:{...void 0!==r.props.formZIndex&&{zIndex:r.props.formZIndex}},inner:{...void 0!==r.props.formZIndex&&{zIndex:r.props.formZIndex+1}}},centered:!0,children:(0,s.jsxs)($,{formBuilder:n,children:[void 0!==r.props.customForm?r.props.customForm(n,r.formDisclosure):void 0!==r.state.metadata&&(void 0!==r.props.formFields?r.props.formFields:r.state.metadata.fields).map((e,t)=>{if(t%3==0){var l,a;return(0,s.jsx)(W.r,{children:void 0!==r.state.metadata&&(null===(l=void 0!==r.props.formFields?r.props.formFields:null===(a=r.state.metadata)||void 0===a?void 0:a.fields.map(e=>e.name))||void 0===l?void 0:l.slice(t,t+3).map((e,l)=>{var a;let i=null===(a=r.state.metadata)||void 0===a?void 0:a.fields.find(t=>t.name===e);return void 0===i?("function"!=typeof e&&"object"!=typeof e&&console.warn("Couldn't find field named ".concat(e,".")),(0,s.jsx)("div",{className:"hidden"},"".concat(t).concat(l))):("function"==typeof e&&"".concat(t).concat(l),(0,s.jsx)(W.r.Col,{span:d(),children:(0,s.jsx)(Z.Z,{focus:0===t&&0===l,name:i.name})},"".concat(i.name).concat(t).concat(l,"}")))}))},t)}return(0,s.jsx)("div",{className:"hidden"},t)}),void 0!==r.props.appendCustomForm?(0,s.jsx)("div",{className:" mt-2",children:r.props.appendCustomForm(n)}):(0,s.jsx)(s.Fragment,{}),null==r.props.customForm&&(0,s.jsxs)("div",{className:"w-full flex justify-end mt-4",children:[null!=r.props.formAppendButton?(0,s.jsx)(s.Fragment,{children:r.props.formAppendButton(n)}):(0,s.jsx)(s.Fragment,{}),!0!==r.props.formHideSaveButton&&(void 0!==n.snapshot&&!0===n.canUpdate||void 0===n.snapshot&&!0===n.canCreate)?(0,s.jsx)(Y.Z,{}):(0,s.jsx)(s.Fragment,{})]})]})})]})});K.displayName="DataForm";let ee={type:"START_INITIAL_LOAD",id:"",isLoadingData:!0,permissions:{read:"NONE",create:"NONE",delete:"NONE",update:"NONE"},isTableNotFound:!1,isFormOpen:!1,metadata:void 0,joinMetadata:[],data:{pages:0,currentPage:1,totalResults:0,orderBy:[],tableName:"",maxResults:10,results:[]},searchField:"",searchValue:"",activeSwitch:null,editRecordId:null},et=(e,t)=>{switch(console.log("DataTable: "+t.type),t.type){case"START_INITIAL_LOAD":return{...ee,isLoadingData:!0,type:"START_INITIAL_LOAD"};case"MISSING_READ_PERMISSIONS":return{...ee,isLoadingData:!1,permissions:{...e.permissions,read:"NONE"},type:"MISSING_READ_PERMISSIONS"};case"TABLE_NOT_FOUND":return{...ee,isLoadingData:!1,isTableNotFound:!0,type:"TABLE_NOT_FOUND"};case"INITIAL_LOAD_COMPLETE":return{...ee,...t.payload,editRecordId:e.editRecordId,type:e.editRecordId?"OPEN_FORM":"INITIAL_LOAD_COMPLETE"};case"SET_IS_LOADING":return{...e,isLoadingData:!0,type:"SET_IS_LOADING"};case"SET_DONE_LOADING":return{...e,isLoadingData:!1,data:t.payload,type:"SET_DONE_LOADING"};case"SEARCH_VALUE_CHANGE":return{...e,searchValue:t.payload.searchValue,searchField:t.payload.searchField,data:t.payload.data,type:"SEARCH_VALUE_CHANGE"};case"ACTIVE_SWITCH_CHANGE":return{...e,activeSwitch:t.payload.activeSwitch,type:"ACTIVE_SWITCH_CHANGE"};case"SET_METADATA":return{...e,metadata:t.payload.metadata,joinMetadata:t.payload.joinMetadata,type:"SET_METADATA"};case"SET_DATA":return{...e,data:{...e.data,results:t.payload.setDataFunction(e.data.results)},type:"SET_DATA"};case"OPEN_FORM":var l;return{...e,isFormOpen:!0,editRecordId:t.payload.editRecordId,formTableName:null===(l=e.metadata)||void 0===l?void 0:l.tableName,type:"OPEN_FORM"};case"CLOSE_FORM":return{...e,isFormOpen:!1,editRecordId:void 0,formTableName:void 0,type:"CLOSE_FORM"}}return{...e,...t.payload}};var el=l(496),es=l(5279),ea=l(3660),ei=l(4611),eo=l(7693),er=l.n(eo),en=e=>{var t,l,r,n;let d;let u=(0,a.Z)(),c=(0,i.useContext)(el.Il),m=ec(),p=(0,o.rZ)(),{colorScheme:f,toggleColorScheme:h}=(0,g.X)(),v=null!=e.record.IsActive&&!0===e.record.IsActive,x="dark"===f?p.colors[p.primaryColor][p.fn.primaryShade()-3]:p.colors[p.primaryColor][p.fn.primaryShade()],y=async e=>{let t=e[m.props.tableName+"Id"];if("Delete"===m.props.deleteBehavior||null==m.props.deleteBehavior){if(void 0===m.props.confirmDelete||!0===m.props.confirmDelete){let a="Confirm",i="Are you sure you want to delete this record?",o=!0;if(null!=m.props.deleteConfirmation){var l,s;let t=await m.props.deleteConfirmation(e);a=null!==(l=t.title)&&void 0!==l?l:a,i=null!==(s=t.message)&&void 0!==s?s:i,o=void 0===t.showPrompt||t.showPrompt}o?null==c||c.showConfirm(i,async()=>{await N(e,m.props.tableName,t)},()=>{},a):await N(e,m.props.tableName,t)}else await N(e,m.props.tableName,t)}"Deactivate"===m.props.deleteBehavior&&b(m.props.tableName,t,!v)},b=async(e,t,l)=>{m.dispatch({type:"SET_IS_LOADING"}),await u.update(e,{["".concat(m.props.tableName,"Id")]:t,IsActive:l}),await m.refresh()},N=async(e,t,l)=>{m.dispatch({type:"SET_IS_LOADING"}),await u.delete(t,l),null!=m.props.onPostDelete&&m.props.onPostDelete(e),await m.refresh()},j="";if(null!=e.fieldInfo.metadataField){let t="".concat(e.fieldInfo.alias).concat(""!==e.fieldInfo.alias?".":"").concat(e.fieldInfo.metadataField.name);void 0!==e.record[e.fieldInfo.metadataField.lookupName]?j=e.record[e.fieldInfo.metadataField.lookupName]:void 0!==e.record[t]&&(j=((t,l)=>{if("Boolean"===t)return l?"Yes":"No";if("DateTime"===t){var s;if(null==l||"0001-01-01T00:00:00"===l)return"";if((null===(s=e.fieldInfo.metadataField)||void 0===s?void 0:s.dateFormat)!=null)return er()(Date.parse(l)).format(e.fieldInfo.metadataField.dateFormat);let t=new Date(l.replace("Z","")),a=String(t.getMonth()+1).padStart(2,"0"),i=String(t.getDate()).padStart(2,"0"),o=t.getFullYear();return"".concat(a,"/").concat(i,"/").concat(o)}return l})(e.fieldInfo.metadataField.type,e.record[t]))}return(0,s.jsxs)("td",{className:"".concat((null===(t=m.props.tableStyle)||void 0===t?void 0:t.truncate)===!0||(null===(l=m.props.tableStyle)||void 0===l?void 0:l.truncate)==null?"truncate":""," cursor-pointer relative ").concat(e.fieldInfo.width.endsWith("px")?"flex-none":""),style:{width:e.fieldInfo.width,height:(null===(r=m.props.tableStyle)||void 0===r?void 0:r.truncate)===!0||(null===(n=m.props.tableStyle)||void 0===n?void 0:n.truncate)==null?"36.7px":""},children:[null!=e.fieldInfo.body?e.fieldInfo.body(e.record,m.refHandle):j,!0===e.record._ui_info_.canDelete&&(void 0===m.props.canDelete||!0===m.props.canDelete)&&(d=e.record,(0,s.jsx)("div",{onClick:e=>{e.stopPropagation(),y(d)},className:"absolute right-0 top-0 bottom-0 flex items-center cursor-pointer xams_delete",children:(0,s.jsx)("div",{className:"flex items-center p-0.5 rounded",style:{backgroundColor:"dark"===f?p.colors.gray[p.fn.primaryShade()+2]:p.colors.gray[p.fn.primaryShade()-5]},children:null==m.props.deleteBehavior||"Delete"===m.props.deleteBehavior?(0,s.jsx)(es.Z,{size:26,strokeWidth:2,color:x}):v?(0,s.jsx)(ea.Z,{size:26,strokeWidth:2,color:x}):(0,s.jsx)(ei.Z,{size:26,strokeWidth:2,color:x})})}))]})},ed=()=>{var e;let t=ec();return(0,s.jsx)(s.Fragment,{children:!1===t.state.isLoadingData&&(null===(e=t.state.data)||void 0===e?void 0:e.results)!=null&&t.state.data.results.filter(e=>{var l;return t.props.tableName===(null===(l=t.state.metadata)||void 0===l?void 0:l.tableName)}).map((e,l)=>void 0!==t.props.customRow?(0,s.jsx)("tr",{className:"w-full",children:t.props.customRow(e)},e[t.props.tableName+"Id"]):(0,s.jsx)("tr",{className:"flex relative items-start",onClick:()=>{t.openForm(e),null!=t.props.formOnOpen&&t.props.formOnOpen("UPDATE",e)},children:t.getFields().map((l,a)=>{let i="".concat(e[t.props.tableName+"Id"],"-").concat(a);return(0,s.jsx)(en,{record:e,fieldInfo:l},i)})},e[t.props.tableName+"Id"]))})};let eu=i.createContext(null),ec=()=>{let e=i.useContext(eu);if(null==e)throw Error("useDataTableContext must be used within a DataTableContextProvider");return e},em=(0,i.forwardRef)((e,t)=>{let l=(0,a.Z)(),o=(0,i.useContext)(Q.q3),r=B(),n=J(),d=(0,i.useRef)(null),[u,m]=(0,i.useState)(n.get()),[p,f]=(0,i.useReducer)(et,{...ee,id:u}),v=(0,i.useRef)(p);if(null!=e.fields&&null!=e.columnWidths&&e.fields.length!==e.columnWidths.length)throw Error("Fields and columnWidths must be the same length in DataTable");let x=async()=>{var t;f({type:"START_INITIAL_LOAD"});let s=null!=p.metadata&&p.metadata.tableName===e.tableName?p.metadata:await l.metadata(e.tableName),a=[];if(null!=e.joins)for(let t of e.joins){let e=await l.metadata(t.toTable);null!=e&&a.push(e)}if(null==s){f({type:"TABLE_NOT_FOUND"});return}if(e.disabledMessage){f({type:"SET_METADATA",payload:{metadata:s,joinMetadata:a}});return}let i=await r.getTablePermissions(l,e.tableName);if("NONE"===i.read){f({type:"MISSING_READ_PERMISSIONS"});return}let o=null!==(t=e.fields)&&void 0!==t?t:s.fields.map(e=>e.name).slice(0,7),n=await g({...c,metadata:s,joinMetadata:a,fields:o,page:1,active:!0===e.showActiveSwitch||null,orderBy:e.orderBy,searchField:"",searchValue:""});(null==n?void 0:n.succeeded)&&(y(s),null!=e.onInitialLoad&&e.onInitialLoad(n.data.results),f({type:"INITIAL_LOAD_COMPLETE",payload:{permissions:i,metadata:s,joinMetadata:a,data:n.data,isLoadingData:!1,activeSwitch:!0===e.showActiveSwitch?"Active":null}}))},y=t=>{void 0!==e.fields&&e.fields.forEach(l=>{"function"!=typeof l&&(void 0!==t.fields.find(e=>e.name===l)||l===e.tableName+"Id"||"object"==typeof l||l.includes(".")||console.warn("Field ".concat(l," not found in metadata for table ").concat(e.tableName)))})},g=async t=>{var s,a,i,o,r,n,d,u,c,m,h,v,x,y;(null==t?void 0:t.setData)!=null&&!0===t.setData&&!1===p.isLoadingData&&(null==t.showLoading||!0===t.showLoading)&&f({type:"SET_IS_LOADING"});let g=null!==(r=null!==(o=null==t?void 0:t.metadata)&&void 0!==o?o:p.metadata)&&void 0!==r?r:await l.metadata(e.tableName),b=null!==(d=null!==(n=null===(s=e.fields)||void 0===s?void 0:s.filter(e=>"string"==typeof e&&!e.includes(".")))&&void 0!==n?n:null==t?void 0:null===(a=t.fields)||void 0===a?void 0:a.filter(e=>"string"==typeof e&&!e.includes(".")))&&void 0!==d?d:null==g?void 0:g.fields.map(e=>e.name).slice(0,7),N=[];if(null==b||b.forEach(e=>{if(e.endsWith("Id")){let t=null==g?void 0:g.fields.find(t=>t.name===e);(null==t?void 0:t.type)==="Lookup"&&void 0===b.find(e=>e===t.lookupName)&&N.push(t.lookupName)}}),null==b||b.push(...N),null!=e.additionalFields)for(let t of e.additionalFields)void 0===b.find(e=>e===t)&&b.push(t);(null==b?void 0:b.find(t=>t===e.tableName+"Id"))===void 0&&(null==b||b.push(e.tableName+"Id")),"Deactivate"===e.deleteBehavior&&void 0===b.find(e=>"IsActive"===e)&&b.push("IsActive");let j=await l.read({tableName:e.tableName,page:null==t?1:t.page,fields:b,maxResults:null!==(u=e.maxResults)&&void 0!==u?u:10,except:e.except,orderBy:null!==(m=null!==(c=null==t?void 0:t.orderBy)&&void 0!==c?c:null===(i=p.data)||void 0===i?void 0:i.orderBy)&&void 0!==m?m:[],filters:[{field:null==t?"":null!==(v=null!==(h=t.searchField)&&void 0!==h?h:p.searchField)&&void 0!==v?v:"",value:null==t?"":null!==(y=null!==(x=t.searchValue)&&void 0!==x?x:p.searchValue)&&void 0!==y?y:""},...!0===e.showActiveSwitch?[{field:"IsActive",operator:"==",value:(null==t?void 0:t.active)!=null?null==t?void 0:t.active.toString():"true"}]:[],...void 0!==e.filters?e.filters.map(e=>({field:e.field,operator:e.operator,value:e.value})):[]],joins:void 0!==e.joins?e.joins:[]});return(null==t?void 0:t.setData)!=null&&!0===t.setData&&f({type:"SET_DONE_LOADING",payload:j.data}),null!=e.onDataLoaded&&e.onDataLoaded(j.data),j},b=async t=>{if(null==e.disabledMessage){var l,s;let a=null===(l=p.data)||void 0===l?void 0:l.orderBy;(null==a||0===a.length)&&(a=null!==(s=e.orderBy)&&void 0!==s?s:[]),await g({...c,page:v.current.data.currentPage,showLoading:t,searchField:v.current.searchField,searchValue:v.current.searchValue,orderBy:a,active:"Active"===v.current.activeSwitch,setData:!0})}},N=t=>null!=e.columnWidths&&e.columnWidths.length>=t?e.columnWidths[t]:"100%",j=function(t){let l=!(arguments.length>1)||void 0===arguments[1]||arguments[1];(void 0===e.onRowClick||!0!==l||!1!==e.onRowClick(t))&&f({type:"OPEN_FORM",payload:{editRecordId:null!=t?t[e.tableName+"Id"]:null}})},I=()=>{f({type:"CLOSE_FORM"})},w=async e=>{null!=p.data.orderBy&&p.data.orderBy.length>0&&p.data.orderBy[0].field===e&&"asc"===p.data.orderBy[0].order?g({...c,page:p.data.currentPage,orderBy:[{field:e,order:"desc"}],setData:!0}):g({...c,page:p.data.currentPage,orderBy:[{field:e,order:"asc"}],setData:!0})};(0,i.useEffect)(()=>{v.current=p},[p.data]),(0,i.useEffect)(()=>{void 0!==e.tableName&&x()},[e.tableName,e.disabledMessage]),(0,i.useEffect)(()=>{if(p.isFormOpen&&null!=e.refreshInterval){let t=setInterval(async()=>{await b(!1)},e.refreshInterval);return()=>clearInterval(t)}},[e.refreshInterval,p.type]);let E={refresh:b,openForm:e=>j(e,!1),dataTableId:u,getRecords:()=>{var e;return null===(e=p.data)||void 0===e?void 0:e.results},setRecords:e=>{f({type:"SET_DATA",payload:{setDataFunction:e}})},showLoading:()=>{f({type:"SET_IS_LOADING"})},sort:w};return(null!=o&&o.formBuilder.addDataTable(E),(0,i.useImperativeHandle)(t,()=>E),!0===p.isTableNotFound)?(0,s.jsx)("div",{className:"w-full h-full flex justify-center items-center",children:"Table not found."}):(0,s.jsxs)(eu.Provider,{value:{props:e,state:p,refHandle:E,dispatch:f,openForm:j,closeForm:I,refresh:b,formDisclosure:{opened:p.isFormOpen,close:I},getData:g,getFields:()=>{if(null!=e.fields&&null!=p.metadata)return e.fields.map((t,l)=>{if("string"==typeof t){let a=t,i=p.metadata,o="";if(t.includes(".")){var s;let l=t.split(".");o=l[0],a=l[1];let r=null===(s=e.joins)||void 0===s?void 0:s.find(e=>e.alias===o);null!=r&&(i=p.joinMetadata.find(e=>e.tableName===r.toTable))}let r=null==i?void 0:i.fields.find(e=>e.name===a);return null==r?null:{displayName:a,metadataField:r,body:null,width:N(l),alias:o}}return"object"==typeof t?{displayName:t.header,body:t.body,width:N(l),alias:""}:null}).filter(h);if(null==e.fields&&null!=p.metadata){var t;return null===(t=p.metadata)||void 0===t?void 0:t.fields.map((e,t)=>t<=6?{displayName:e.name,metadataField:e,body:null,width:N(t),alias:""}:null).filter(h)}return[]},sort:w},children:[p.isFormOpen&&(0,s.jsx)(K,{ref:d}),p.data&&(0,s.jsx)(U,{children:(0,s.jsx)(ed,{})})]})});em.displayName="DataTable";var ep=em},2063:function(e,t,l){"use strict";var s=l(4246),a=l(7378),i=l(2370),o=l(386),r=l(3529),n=l(2053),d=l(174),u=l(8971),c=l(4323);let m=a.lazy(()=>Promise.all([l.e(345),l.e(608),l.e(68)]).then(l.bind(l,871))),p=a.lazy(()=>l.e(642).then(l.bind(l,8642)));t.Z=e=>{var t,l,a,f,h,v,x,y,g,b,N,j;let I=(0,c.Gc)(),w=null===(t=I.formBuilder.metadata)||void 0===t?void 0:t.fields.find(t=>t.name===e.name),E=(0,u.Z)();if(null==I.formBuilder.metadata)return(0,s.jsx)(s.Fragment,{});if(null==w)throw Error("Field ".concat(e.name," not found on ").concat(I.formBuilder.metadata.tableName," metadata."));e.required?I.formBuilder.addRequiredField(w.name):I.formBuilder.removeRequiredField(w.name);let C=w.isReadOnly||e.readOnly,T=(t,l)=>{let s=!1,a=t.name,i=t.type,o=t.isNullable,r=["Single","Int32","Int64","Double","Decimal"];if(r.includes(i)&&(l.endsWith("-")&&!l.startsWith("-")&&(l="-"+l.replace("-","")),l.startsWith("-0")||l.startsWith("0")))try{i.startsWith("Int")&&0!==parseInt(l)?l=parseInt(l).toString():i.startsWith("Int")||0===parseFloat(l)||(l=parseFloat(l).toString())}catch(e){}if(!o&&r.includes(i)?("-"===l&&(s=!0),"0-"===l&&(l="-0"),"-00"===l&&(l="-0"),"."===l&&(s=!0),/^-0[1-9]$/.test(l)&&(l=l.replace("0",""))):o&&("-"===l||"."===l)&&r.includes(i)&&(s=!0),r.includes(i)&&(!1===e.allowNegative&&l.startsWith("-")&&""===(l=l.replace("-",""))&&(l="0"),null!=t.numberRange)){let e=t.numberRange.split("-"),s=parseFloat(e[0]),a=parseFloat(e[1]);try{let e=parseFloat(l);e<=s&&(l=s.toString()),e>a&&(l=a.toString())}catch(e){console.log(e)}}("String"===i||"Guid"===i)&&(t.characterLimit&&(l.length<=t.characterLimit||(l=l.substring(0,t.characterLimit))),s=!0),"Single"===i&&(l=l.replace("Infinity","").replace("-Infinity","").replace("NaN",""),/^-?(\d+(\.\d*)?|\.\d+)$/.test(l)&&(s=!0)),"Int32"===i&&/^-?(?:[0-9]{1,10}|[1-9][0-9]{0,8}|[12][0-9]{9}|20[0-9]{8}|21[0-4][0-9]{7}|214[0-6][0-9]{6}|2147[0-3][0-9]{5}|214748[0-2][0-9]{4}|2147483[0-5][0-9]{3}|21474836[0-3][0-9]{2}|214748364[0-7])$/.test(l)&&(s=!0),"Int64"===i&&/^-?(?:[0-9]{1,19}|[1-8][0-9]{0,18}|[9][0-1][0-9]{0,17}|92[0-1][0-9]{0,16}|922[0-2][0-9]{0,15}|9223[0-2][0-9]{0,14}|92233[0-6][0-9]{0,13}|922337[0-1][0-9]{0,12}|92233720[0-2][0-9]{0,10}|922337203[0-5][0-9]{0,9}|9223372036[0-4][0-9]{0,8}|92233720367[0-4][0-9]{0,7}|922337203685[0-3][0-9]{0,6}|9223372036854[0-6][0-9]{0,5}|92233720368547[0-4][0-9]{0,4}|922337203685477[0-4][0-9]{0,3}|9223372036854775[0-7][0-9]{0,2}|922337203685477580[0-7])$/.test(l)&&(s=!0),"Double"===i&&(l=l.replace("Infinity","").replace("-Infinity","").replace("NaN",""),/^-?(\d+(\.\d*)?|\.\d+)$/.test(l)&&(s=!0)),"Decimal"===i&&/^-?(\d+(\.\d*)?|\.\d+)$/.test(l)&&(s=!0),["Single","Int32","Int64","Double","Decimal"].includes(i)?(o&&"-"===l&&(s=!0),!0===o&&""===l?R(a,""):!1===o&&""===l?R(a,"0"):s&&R(a,l)):s&&R(a,l)},R=function(t,l){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;I.formBuilder.dispatch({type:"SET_FIELD_VALUE",payload:{field:t,value:l}}),null!=e.onChange&&((null==w?void 0:w.type)==="Lookup"?e.onChange(l,s):e.onChange(l))},A=e=>null==e||!["h","m","s","A","a","H","k","K","m","s","S","Z","X","LT","LTS","LLL","LLLL","lll","llll"].some(t=>e.includes(t));if(null==w||void 0===I.formBuilder.data||void 0===I.formBuilder.data[w.name])return(0,s.jsx)(s.Fragment,{});let S=t=>{let{field:l}=t;return(0,s.jsxs)(s.Fragment,{children:[null!=e.label?e.label:l.displayName," ",!0===l.isRecommended?(0,s.jsx)(i.u,{label:"Recommended",withArrow:!0,children:(0,s.jsx)("span",{className:" text-blue-600",children:"+"})}):(0,s.jsx)(s.Fragment,{})]})};return(0,s.jsxs)(s.Fragment,{children:["Lookup"===w.type&&(0,s.jsx)(p,{label:(0,s.jsx)(S,{field:w}),className:!1===I.formBuilder.canRead.canRead?"invisible":"",metaDataField:w,owningTableName:null===(l=I.formBuilder.metadata)||void 0===l?void 0:l.tableName,ref:!0===e.focus?I.formBuilder.firstInputRef:void 0,onChange:t=>{R(w.name,null==t?void 0:t.id,null==t?void 0:t.value),null!=e.onChange&&e.onChange(null==t?void 0:t.id,null==t?void 0:t.label)},onBlur:e.onBlur,defaultLabelValue:void 0!==I.formBuilder.snapshot?(N=I.formBuilder.snapshot[w.lookupName],j=I.formBuilder.snapshot[w.name],null==N&&null!=j?{label:j,value:j}:null!=N&&null!=j?{label:N,value:j}:void 0):((e,t)=>{var l;if(void 0!==(null===(l=I.formBuilder.defaults)||void 0===l?void 0:l.find(t=>t.field===e)))return E.lookups.find(l=>l.fieldName===e&&l.lookupTable===t)})(w.name,w.lookupTable),value:I.formBuilder.data[w.name],excludeValues:null===(f=I.formBuilder.lookupExclusions)||void 0===f?void 0:null===(a=f.find(e=>e.fieldName===w.name))||void 0===a?void 0:a.values,query:null===(h=I.formBuilder.lookupQueries)||void 0===h?void 0:h.find(e=>e.field===w.name),readOnly:["CreatedById","UpdatedById"].includes(w.name)||!1===I.formBuilder.canUpdate&&void 0!==I.formBuilder.snapshot||["OwningUserId","OwningTeamId"].includes(w.name)&&void 0!==I.formBuilder.snapshot&&!1===I.formBuilder.snapshot._ui_info_.canAssign||C,required:!1===w.isNullable&&!["CreatedById","UpdatedById"].includes(w.name)||!0===w.isRequired||!0===e.required,error:null===(v=I.formBuilder.validationMessages.find(e=>e.field===w.name))||void 0===v?void 0:v.message,disabled:e.disabled}),"String"===w.type&&"rich"===e.varient&&(0,s.jsx)(m,{value:I.formBuilder.data[w.name],onChange:e=>{T(w,e)}}),"String"===w.type&&"textarea"===e.varient&&(0,s.jsx)(o.g,{styles:{root:{height:"100%",display:"flex",flexDirection:"column"},wrapper:{flexGrow:1},input:{height:"100%"}},label:(0,s.jsx)(S,{field:w}),placeholder:e.placeholder,value:I.formBuilder.data[w.name],required:!0===w.isRequired||!0===e.required||!w.isNullable,onChange:e=>{T(w,e.currentTarget.value)},onBlur:e.onBlur,readOnly:!1===I.formBuilder.canUpdate&&void 0!==I.formBuilder.snapshot||C,error:null===(x=I.formBuilder.validationMessages.find(e=>e.field===w.name))||void 0===x?void 0:x.message,disabled:e.disabled}),["String","Guid","Int32","Single","Int64","Double","Decimal"].includes(w.type)&&null==e.varient&&null!=I.formBuilder.data[w.name]&&(0,s.jsx)(r.o,{label:(0,s.jsx)(S,{field:w}),ref:!0===e.focus?I.formBuilder.firstInputRef:void 0,value:I.formBuilder.data[w.name],onChange:e=>{T(w,e.currentTarget.value)},onBlur:e.onBlur,readOnly:!1===I.formBuilder.canUpdate&&void 0!==I.formBuilder.snapshot||C,error:null===(y=I.formBuilder.validationMessages.find(e=>e.field===w.name))||void 0===y?void 0:y.message,required:!0===w.isRequired||!0===e.required||!w.isNullable,placeholder:e.placeholder,disabled:e.disabled}),"DateTime"===w.type&&(0,s.jsx)(d.W,{ref:!0===e.focus?I.formBuilder.firstInputRef:void 0,label:(0,s.jsx)(S,{field:w}),...null!=w.dateFormat&&""!==w.dateFormat?{valueFormat:w.dateFormat}:{},value:void 0!==I.formBuilder.data&&void 0!==I.formBuilder.data[w.name]&&null!==I.formBuilder.data[w.name]&&"0001-01-01T00:00:00"!==I.formBuilder.data[w.name]?new Date(A(w.dateFormat)?I.formBuilder.data[w.name].replace("Z",""):I.formBuilder.data[w.name]):null,onChange:e=>{R(w.name,null==e?null:A(w.dateFormat)?(null==e||e.setUTCHours(0,0,0,0),null==e?void 0:e.toISOString().replace("Z","")):null==e?void 0:e.toISOString())},onBlur:e.onBlur,clearable:w.isNullable,readOnly:["CreatedDate","UpdatedDate"].includes(w.name)||void 0!==I.formBuilder.snapshot&&!1===I.formBuilder.canUpdate||C,required:!0===w.isRequired||e.required||!w.isNullable,error:null===(g=I.formBuilder.validationMessages.find(e=>e.field===w.name))||void 0===g?void 0:g.message,...e.dateInput,disabled:e.disabled}),"Boolean"===w.type&&(0,s.jsx)("div",{className:"w-full h-full flex items-end",children:(0,s.jsx)("div",{className:"w-full h-9 flex items-center",children:(0,s.jsx)(n.X,{ref:!0===e.focus?I.formBuilder.firstInputRef:void 0,label:(0,s.jsx)(S,{field:w}),checked:void 0!==I.formBuilder.data&&void 0!==I.formBuilder.data[w.name]&&null!==I.formBuilder.data[w.name]?I.formBuilder.data[w.name]:void 0,onChange:t=>{void 0!==I.formBuilder.snapshot&&!1===I.formBuilder.canUpdate||C||R(w.name,t.currentTarget.checked),null!=e.onChange&&e.onChange(t.currentTarget.checked)},onBlur:e.onBlur,readOnly:void 0!==I.formBuilder.snapshot&&!1===I.formBuilder.canUpdate||C,error:null===(b=I.formBuilder.validationMessages.find(e=>e.field===w.name))||void 0===b?void 0:b.message,required:!0===w.isRequired||e.required,disabled:e.disabled})})})]})}},2815:function(e,t,l){"use strict";var s=l(4246),a=l(226);l(7378);var i=l(4323);t.Z=e=>{let t=(0,i.Gc)().formBuilder;return void 0!==t.snapshot&&!1===t.canUpdate||void 0===t.snapshot&&!1===t.canCreate?(0,s.jsx)(s.Fragment,{}):(0,s.jsxs)(a.z,{className:e.className,onClick:()=>t.save(e.onPreValidate,e.onPreSave,e.onPostSave),variant:e.varient,children:[void 0!==e.label?e.label:"",void 0===e.label&&(void 0!==t.snapshot?"Update":"Create")]})}},4323:function(e,t,l){"use strict";l.d(t,{Gc:function(){return o},q3:function(){return i}});var s=l(4246),a=l(7378);let i=a.createContext(null),o=()=>{let e=a.useContext(i);if(!e)throw Error("useFormContext must be used within a FormContextProvider");return e};t.ZP=e=>(0,s.jsx)(i.Provider,{value:{formBuilder:e.formBuilder},children:e.children})},5381:function(e,t,l){"use strict";var s=l(7378),a=l(496),i=l(1331),o=l(6180),r=l(7172);t.Z=e=>{let t=(0,s.useContext)(a.Il),l=(0,s.useContext)(r.Vo),n=(0,o.t)(),d=(e,t)=>{let l=document.createElement("a");l.href=URL.createObjectURL(e),l.download=t,document.body.appendChild(l),l.click(),setTimeout(()=>{document.body.removeChild(l),URL.revokeObjectURL(l.href)},0)},u=async e=>{try{var s,a,i;let o=(null!==(s=null==l?void 0:l.apiUrl)&&void 0!==s?s:"")+e.url;void 0!==e.searchParams&&(o+="?".concat(e.searchParams.toString()));let r=n.accessToken,u=await fetch(o,{method:e.method,headers:{Authorization:"Bearer ".concat(r),UserId:null!==(a=n.userId)&&void 0!==a?a:"",...void 0!==e.body&&!(e.body instanceof FormData)&&{"Content-Type":"application/json"},...e.headers,...(null==l?void 0:l.headers)!==void 0&&(null==l?void 0:l.headers)},...void 0!==e.body&&!(e.body instanceof FormData)&&{body:JSON.stringify(e.body)},...void 0!==e.body&&e.body instanceof FormData&&{body:e.body}});if(401===u.status)return(null==l?void 0:l.onUnauthorized)!==void 0&&l.onUnauthorized(),{succeeded:!1,data:void 0,friendlyMessage:"",logMessage:"",response:u};if(400===u.status&&!e.hideFailureMessage){if(void 0!==e.failureMessage)null==t||t.showError(e.failureMessage);else{let e=await u.json();return null==t||t.showError(e.friendlyMessage),console.error(e.logMessage),e}}if(!1===u.ok){let e=await u.text();return{succeeded:!1,data:void 0,friendlyMessage:e,logMessage:e,response:u}}let c=u.headers.get("content-type");if(c&&-1!==c.indexOf("application/octet-stream")&&d(await u.blob(),null!==(i=e.fileName)&&void 0!==i?i:"file"),!c||-1===c.indexOf("application/json"))return{succeeded:!0,data:u.body,friendlyMessage:"",logMessage:"",response:u};{let l=await u.json();return!1===l.succeeded&&((void 0===e.hideFailureMessage||!1===e.hideFailureMessage)&&(null==t||t.showError(l.friendlyMessage)),console.error(l.logMessage)),l}}catch(l){return console.error(l),(void 0===e.hideFailureMessage||!1===e.hideFailureMessage)&&void 0!==e.failureMessage&&(null==t||t.showError(JSON.stringify(l))),{succeeded:!1,data:void 0,friendlyMessage:"",logMessage:"",response:void 0}}},c=async e=>{let t=await u({url:i.TO,method:"POST",body:{method:"has_permissions",parameters:{permissionNames:e}}});return!0===t.succeeded&&t.data.length===e.length},m=async e=>{let t=await u({url:i.TO,method:"POST",body:{method:"has_permissions",parameters:{permissionNames:e}}});return!0===t.succeeded&&t.data.length>0},p=async e=>{let t=await u({url:i.BR,method:"POST",body:{method:"table_metadata",parameters:{tableName:e}}});return null==t?void 0:t.data},f=async e=>await u({url:i.BR,method:"POST",body:{method:"table_list",parameters:{tag:e}}}),h=async function(e,t){let l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return await u({method:"POST",url:i.Vx,body:{tableName:e,fields:t,parameters:l}})},v=async(e,t,l)=>await u({method:"PATCH",url:i.sy,body:{tableName:e,fields:t,parameters:l}}),x=async(e,t,l)=>await u({method:"DELETE",url:i.QC,body:{tableName:e,fields:{["".concat(e,"Id")]:t},parameters:l}}),y=async(e,t,l)=>await u({method:"POST",url:i.F,body:{tableName:e,fields:t,parameters:l}}),g=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return await u({method:"POST",url:i.Vx,body:{entities:e,parameters:t}})},b=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return await u({method:"PATCH",url:i.sy,body:{entities:e,parameters:t}})},N=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return await u({method:"DELETE",url:i.QC,body:{entities:e,parameters:t}})},j=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return await u({method:"POST",url:i.F,body:{entities:e,parameters:t}})},I=async function(e){return arguments.length>1&&void 0!==arguments[1]&&arguments[1],await u({url:i.bZ,method:"POST",body:e})},w=async e=>await u({method:"POST",url:i.ku,body:e}),E=async(e,t,l)=>await u({method:"POST",url:i.k0,body:{name:e,parameters:t},fileName:l}),C=async e=>await u({method:"POST",url:i.mH,body:e});return(0,s.useMemo)(()=>({execute:u,hasAllPermissions:c,hasAnyPermissions:m,tables:f,metadata:p,create:h,read:w,update:v,delete:x,upsert:y,bulkCreate:g,bulkUpdate:b,bulkDelete:N,bulkUpsert:j,bulk:I,action:E,file:C}),[null==l?void 0:l.apiUrl,null==l?void 0:l.headers,null==l?void 0:l.onUnauthorized,n.accessToken,n.userId])}},9572:function(e,t,l){"use strict";var s=l(7302),a=l(823);l(7378),t.Z=()=>{let e=(0,s.rZ)(),{colorScheme:t,toggleColorScheme:l}=(0,a.X)(),i="dark"===t?e.colors.gray[4]:e.colors.dark[7];return{getIconColor:()=>i,getPrimaryColor:()=>e.fn.primaryColor(),colorScheme:t}}},8971:function(e,t,l){"use strict";var s=l(1331);let a=(0,l(6805).Ue)()((e,t)=>({lookups:[],getLookupLabel:async(l,a,i,o,r)=>{let n=t().lookups.find(e=>e.fieldName===a&&e.lookupTable===i&&e.lookupTableNameField==o&&e.value===r);if(void 0!==n)return n;let d=await l.execute({url:s.ku,method:"POST",body:{fields:["*"],tableName:i,maxResults:1,page:1,id:r}});if(((null==d?void 0:d.succeeded)!==!0||null!==d.data)&&(null==d?void 0:d.succeeded)===!0&&void 0!==d.data.results&&d.data.results.length>0){let l=d.data.results[0][o],s={fieldName:a,lookupTable:i,lookupTableNameField:o,value:r,label:l};return e({lookups:[...t().lookups,s]}),s}},getAnyLookup:async(l,a,i,o)=>{let r=t().lookups.find(e=>e.fieldName===a&&e.lookupTable===i&&e.lookupTableNameField==o);if(void 0!==r)return r;let n=await l.execute({url:s.ku,method:"POST",body:{fields:["*"],tableName:i,maxResults:1,page:1}});if(((null==n?void 0:n.succeeded)!==!0||null!==n.data)&&(null==n?void 0:n.succeeded)===!0&&void 0!==n.data.results&&n.data.results.length>0){let l={fieldName:a,lookupTable:i,lookupTableNameField:o,value:n.data.results[0]["".concat(i,"Id")],label:n.data.results[0][o]};return e({lookups:[...t().lookups,l]}),l}}}));t.Z=a},6521:function(e,t,l){"use strict";class s{top(e){return this._maxResults=e,this}page(e){return this._page=e,this}from(e){return this._tableName=e,this}where(e,t,l){return e instanceof i?this._filters.push(e):this._filters.push(o(e,t,l)),this}and(e,t,l){return e instanceof i?this._filters[this._filters.length-1].and(e):this._filters[this._filters.length-1].and(e,t,l),this}or(e,t,l){return e instanceof i?this._filters[this._filters.length-1].or(e):this._filters[this._filters.length-1].or(e,t,l),this}join(e,t,l){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return this._joins.push(new a(e,t,l,s,"inner")),this}leftJoin(e,t,l){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return this._joins.push(new a(e,t,l,s,"left")),this}except(e){return this._except.push(e),this}orderBy(e,t){return this._orderBy||(this._orderBy=[]),this._orderBy.push({field:e,order:t}),this}distinct(){return this._distinct=!0,this}denormalize(){return this._denoramlize=!0,this}toReadRequest(){var e,t,l;return{tableName:this._tableName,fields:this._fields,page:null!==(e=this._page)&&void 0!==e?e:1,maxResults:null!==(t=this._maxResults)&&void 0!==t?t:null,orderBy:null!==(l=this._orderBy)&&void 0!==l?l:[],filters:this._filters.length>0?[this._filters[0].getJson()]:[],joins:this._joins,distinct:this._distinct,denormalize:this._denoramlize,except:this._except}}constructor(e){return this._page=1,this._tableName="",this._filters=[],this._joins=[],this._distinct=!1,this._denoramlize=!1,this._except=[],this._fields=e,this}}class a{constructor(e,t,l=null,s=null,a){this.alias=null;let i=e.split("."),o=t.split(".");if(i.length<2||o.length<2)throw Error("Join must include a table and field part ie: tableName.fieldName");this.fromTable=i[0],this.fromField=i[1],this.toTable=o[0],this.toField=o[1],this.alias=l,this.fields=null!=s?s:[],this.type=a}}class i{and(e,t,l){if(e instanceof i)this.filters.push(e);else{if("OR"==this.logicalOperator){let s;let a=this.conditions[this.conditions.length-1];return this.lastCondition==a?(s=new i,this.conditions.pop(),s.conditions.push(a)):s=this.filters[this.filters.length-1],this.lastCondition={field:e,operator:t,value:l},s.conditions.push(this.lastCondition),this.filters.push(s),this}this.lastCondition={field:e,operator:t,value:l},this.conditions.push(this.lastCondition)}return this}or(e,t,l){if(e instanceof i)this.filters.push(e);else{if("AND"===this.logicalOperator){this.logicalOperator="OR";let e=new i;e.conditions=this.conditions,this.filters.push(e),this.conditions=[]}this.lastCondition={field:e,operator:t,value:l},this.conditions.push(this.lastCondition)}return this}getJson(){return{logicalOperator:this.logicalOperator,filters:[...this.conditions,...this.filters.map(e=>e.getJson())]}}getStr(){let e=[];for(let t of this.conditions)e.push("".concat(t.field," ").concat(t.operator," ").concat(t.value));for(let t of this.filters)e.push("(".concat(t.getStr(),")"));return e.join(" ".concat(this.logicalOperator," "))}print(){return console.log(this.getStr()),this}constructor(){this.logicalOperator="AND",this.filters=[],this.conditions=[]}}let o=(e,t,l)=>{let s=new i;return s.logicalOperator="AND",s.conditions=[],s.conditions.push({field:e,operator:t,value:l}),s};t.ZP=s}},function(e){e.O(0,[578,888,774,179],function(){return e(e.s=9536)}),_N_E=e.O()}]);