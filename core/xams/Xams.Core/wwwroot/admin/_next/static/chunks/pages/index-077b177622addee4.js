(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{9536:function(e,t,l){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return l(8683)}])},8683:function(e,t,l){"use strict";l.r(t),l.d(t,{default:function(){return eF}});var a=l(4246),s=l(830),i=l(1835),o=l(8280),r=l(656),n=l(7201),d=l(7378),u=l(7075),c=l(121),m=l(6127),p=l(9610),f=l(4188),h=l(8082),v=e=>{let t=(0,s.Z)(),[l,o]=d.useState([]),[r,u]=d.useState(!0),v=async()=>{u(!0),await t.execute({url:c.k0,method:"POST",body:{name:"ADMIN_ExportData",parameters:{tables:l.filter(e=>!0===e.checked).map(e=>({name:e.Name,dependencies:e.Dependencies.filter(e=>!0===e.checked).map(e=>({name:e.Name}))}))}},fileName:"export_".concat(new Date().toLocaleString().replaceAll(" ",""),".json")}),e.close()},x=async()=>{u(!0);let e=await t.execute({url:c.k0,method:"POST",body:{name:"ADMIN_ExportDependencies"}});if((null==e?void 0:e.succeeded)===!0){let t=e.data;for(let e of t)for(let t of(e.checked=!1,e.Dependencies))t.checked=!1,t.disabled=!1;o(t)}u(!1)},y=(e,t)=>{let l=!1;for(let a of e)if(a.Name===t){l=!a.checked;break}let a=e.map(e=>e);g(t,a,[],l),o(a)},g=(e,t,l,a)=>{if(!l.includes(e))for(let s of(l.push(e),t))if(s.Name===e)for(let e of(s.checked=a,s.disabled=!1,s.Dependencies))!1===e.Optional&&(e.checked=a,e.disabled=a,g(e.Name,t,l,a));else for(let t of s.Dependencies)t.Name===e&&(t.checked=a,t.disabled=a)};return(0,d.useEffect)(()=>{!0===e.opened&&(u(!1),o([]),x())},[e.opened]),(0,a.jsxs)(m.u,{opened:e.opened,onClose:e.close,title:"Export Data",styles:{body:{overflow:"hidden",position:"relative",padding:"0px"}},centered:!0,children:[!0===r&&(0,a.jsx)("div",{className:"absolute w-full h-full flex justify-center items-center overflow-hidden z-30",children:(0,a.jsx)(i.a,{})}),(0,a.jsxs)("div",{className:"p-4 ".concat(r?"invisible":""),children:[(0,a.jsx)(p.x,{h:650,children:(0,a.jsx)("div",{className:" pl-2 flex flex-col gap-2",children:l.map(e=>(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{children:(0,a.jsx)(f.X,{styles:{input:{cursor:"pointer"},label:{cursor:"pointer"}},checked:e.checked,disabled:e.disabled,onChange:()=>{},onClick:()=>{y(l,e.Name)},label:e.Name})}),(0,a.jsx)("div",{className:"flex flex-col gap-1",children:e.Dependencies.map(e=>(0,a.jsx)("div",{className:"ml-8",children:(0,a.jsx)(f.X,{styles:{input:{cursor:"pointer"},label:{cursor:"pointer"}},label:e.Name,checked:e.checked,onChange:()=>{},disabled:e.disabled,onClick:()=>y(l,e.Name)})},"".concat(h.Z.name,"-").concat(e.Name)))})]},e.Name))})}),(0,a.jsx)("div",{className:"w-full flex justify-end mt-4",children:(0,a.jsx)(n.z,{onClick:v,children:"Export"})})]})]})},x=l(4310),y=e=>{let t=(0,s.Z)(),[l,o]=d.useState(null),[r,u]=d.useState(!1),p=async()=>{if(null===l)return;u(!0);let a=new FormData;a.append("file",l),a.append("name","ADMIN_ImportData"),await t.execute({url:c.mH,method:"POST",body:a}),e.close()};return(0,d.useEffect)(()=>{!0===e.opened&&(u(!1),o(null))},[e.opened]),(0,a.jsxs)(m.u,{opened:e.opened,onClose:e.close,size:"md",title:"Import Data",closeOnEscape:!r,closeOnClickOutside:!r,withCloseButton:!r,styles:{body:{overflow:"hidden",position:"relative",padding:"0px"}},centered:!0,children:[!0===r&&(0,a.jsx)("div",{className:"absolute w-full h-full  flex justify-center items-center overflow-hidden z-30",children:(0,a.jsx)(i.a,{})}),(0,a.jsxs)("div",{className:"p-4 ".concat(r?"invisible":""),children:[(0,a.jsx)(x.S,{label:"File Upload",placeholder:"Click to choose data file",required:!0,value:l,onChange:e=>{o(e)}}),(0,a.jsx)("div",{className:"w-full flex justify-end mt-4",children:(0,a.jsx)(n.z,{onClick:p,disabled:null===l,children:"Upload"})})]})]})},g=l(7040),b=l(4827),N=l(4971),j=l(9419),I=l(9918),w=()=>{let e=(0,g.rZ)(),{colorScheme:t,toggleColorScheme:l}=(0,b.X)(),s="dark"===t;return(0,a.jsx)(N.A,{variant:"outline",color:s?"yellow":e.primaryColor,onClick:()=>l(),title:"Toggle color scheme",children:s?(0,a.jsx)(j.Z,{size:"1.1rem"}):(0,a.jsx)(I.Z,{size:"1.1rem"})})},E=l(2485),C=l(1582),T=l(1224);let R=d.lazy(()=>Promise.resolve().then(l.bind(l,6955))),A=(0,d.forwardRef)((e,t)=>{let[l,s]=(0,d.useState)(!1),o=d.useRef(null);if((0,d.useImperativeHandle)(t,()=>o.current),(0,d.useEffect)(()=>{s(!0)},[]),!l)return(0,a.jsx)("div",{className:"w-full h-full flex justify-center items-center",children:(0,a.jsx)(i.a,{})});let r=e.tableName+JSON.stringify(e.filters)+JSON.stringify(e.joins)+JSON.stringify(e.orderBy)+JSON.stringify(e.except)+JSON.stringify(e.additionalFields)+JSON.stringify(e.fields)+JSON.stringify(e.maxResults);return(0,a.jsx)(R,{ref:o,...e},r)});var S=l(5348),D=l(7290),_=l(2666),L=e=>(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("span",{children:["Id: ",e.value]}),(0,a.jsx)(S.q,{value:e.value,children:e=>{let{copied:t,copy:l}=e;return(0,a.jsxs)(n.z,{variant:"subtle",styles:{root:{paddingRight:4,paddingLeft:4}},onClick:l,children:[t?(0,a.jsx)(D.Z,{size:16}):(0,a.jsx)(_.Z,{className:"mr-1",size:16}),t?"Copied":"Copy"]})}})]}),B=()=>{var e;let t=eP();return(0,a.jsx)(a.Fragment,{children:t.tables.length>0&&!(null===(e=t.props.hiddenMenuItems)||void 0===e?void 0:e.includes("Entities"))&&(0,a.jsx)(C.O,{label:"Entities",leftSection:(0,a.jsx)(T.Z,{size:16,strokeWidth:2,color:t.color}),children:t.tables.filter(e=>{var l,a;return"System"!==e.tag&&(null===(l=t.props.hiddenEntities)||void 0===l?void 0:l.includes(e.tableName))!==!0&&(void 0===t.props.visibleEntities||(null===(a=t.props.visibleEntities)||void 0===a?void 0:a.includes(e.tableName)))}).sort((e,l)=>t.props.showEntityDisplayNames?e.displayName.localeCompare(l.displayName):e.tableName.localeCompare(l.tableName)).map(e=>(0,a.jsx)(C.O,{label:t.props.showEntityDisplayNames?e.displayName:e.tableName,leftSection:(0,a.jsx)(T.Z,{size:16,strokeWidth:2,color:t.color}),onClick:()=>t.setActiveComponent(t=>({component:(0,a.jsx)(A,{tableName:e.tableName,maxResults:100,formAppendButton:e=>(0,a.jsx)(a.Fragment,{children:"UPDATE"===e.operation&&(0,a.jsx)("div",{className:"w-full flex justify-start items-center gap-1",children:(0,a.jsx)(L,{value:e.data["".concat(e.tableName,"Id")]})})})})}))},e.tableName))})})},O=l(8991),P=l(1743),k=l(9898),F=l(6239),U=e=>(0,a.jsxs)("div",{className:"flex justify-center items-center w-full h-full",children:["none"===e.icon&&(0,a.jsx)("svg",{width:"20",height:"20",viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"cursor-pointer",onClick:e.onClick,children:(0,a.jsx)("rect",{x:"2.00024",y:"2",width:"28",height:"28",rx:"6",stroke:"#4B4B4B",strokeWidth:"4"})}),"user"===e.icon&&(0,a.jsxs)("svg",{width:"20",height:"20",viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"cursor-pointer",onClick:e.onClick,children:[(0,a.jsx)("rect",{x:"2.00024",y:"2",width:"28",height:"28",rx:"6",stroke:"#4B4B4B",strokeWidth:"4"}),(0,a.jsx)("mask",{id:"mask0_712_5305",maskUnits:"userSpaceOnUse",x:"4",y:"16",width:"12",height:"12",children:(0,a.jsx)("path",{d:"M4 16V28H16L4 16Z",fill:"#D9D9D9"})}),(0,a.jsx)("g",{mask:"url(#mask0_712_5305)",children:(0,a.jsx)("rect",{x:"4.00024",y:"4",width:"24",height:"24",rx:"4",fill:"#991B1B"})})]}),"team"===e.icon&&(0,a.jsxs)("svg",{width:"20",height:"20",viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"cursor-pointer",onClick:e.onClick,children:[(0,a.jsx)("rect",{x:"2",y:"2",width:"28",height:"28",rx:"6",stroke:"#4B4B4B",strokeWidth:"4"}),(0,a.jsx)("mask",{id:"mask0_712_5300",maskUnits:"userSpaceOnUse",x:"4",y:"4",width:"24",height:"24",children:(0,a.jsx)("path",{d:"M4 28H28L4 4V28Z",fill:"#D9D9D9"})}),(0,a.jsx)("g",{mask:"url(#mask0_712_5300)",children:(0,a.jsx)("rect",{x:"4",y:"4",width:"24",height:"24",rx:"4",fill:"#F59E0B"})})]}),"system"===e.icon&&(0,a.jsxs)("svg",{width:"20",height:"20",viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"cursor-pointer",onClick:e.onClick,children:[(0,a.jsx)("rect",{x:"2",y:"2",width:"28",height:"28",rx:"6",stroke:"#4B4B4B",strokeWidth:"4"}),(0,a.jsx)("rect",{x:"4",y:"4",width:"24",height:"24",rx:"4",fill:"#84CC16"})]})]}),M=l(5387),W=l(6436),Z=l(2237),V=l(8993),z=l(8),H=l(6717);let G=d.createContext(null),q=()=>{let e=d.useContext(G);if(!e)throw Error("useDataGridContext must be used within a DataGridContextProvider");return e},J=d.createContext(null),X=()=>{let e=d.useContext(J);if(!e)throw Error("useSubGrid must be used within a SubGridContextProvider");return e};var Y=e=>{let t=q();return(0,a.jsx)("div",{className:"w-full",children:(0,a.jsx)("input",{type:"text",style:{zIndex:null!=t.props.zIndex?t.props.zIndex+1:2,textAlign:e.rightAlign?"right":"left"},className:"w-full h-full border-none outline-none",value:t.editValue,onChange:e=>{let l=e.target.value;if(t.activeCell&&t.activeCell.onEditing&&t.activeCellLocation){var a;l=t.activeCell.onEditing(l,t.activeCellLocation,null===(a=t.activeCell)||void 0===a?void 0:a.data)}t.setEditValue(l)},autoFocus:!0})})},K=l(5208),Q=e=>e.isEditing||null==e.errorMessage||""===e.errorMessage?(0,a.jsx)(a.Fragment,{}):(0,a.jsx)(K.u,{label:e.errorMessage,color:"#dc2626",withArrow:!0,children:(0,a.jsx)("div",{className:"absolute w-full h-full flex justify-start items-center",children:(0,a.jsx)("div",{className:"w-4 h-4 text-xs text-white rounded-full bg-red-600 flex justify-center items-center font-bold ml-1",children:"!"})})}),$=e=>{var t,l,s,i,o;let r=q(),n=X(),u=(0,d.useRef)(null),c=(0,E.Z)();if(null==r.props.rows[e.rowIndex+n.skipRows])return;let m=r.props.rows[e.rowIndex+n.skipRows].columns[e.columnIndex+n.skipColumns],p={row:e.rowIndex+n.skipRows,col:e.columnIndex+n.skipColumns},f=null!==(s=m.value)&&void 0!==s?s:"",h=null==f?"":f.toString(),v="light"===c.colorScheme?"bg-gray-200":"bg-neutral-800",x=r.props.rightAlignNumbers&&"string"==typeof h&&!isNaN(h)&&!isNaN(parseFloat(h)),y=(e,t)=>{let l=r.props.rows[e+n.skipRows].columns[t+n.skipColumns].onClick;if(null!=l){let a=r.props.rows[e+n.skipRows].columns[t+n.skipColumns].data;l(f,{row:e+n.skipRows,col:t+n.skipColumns},a)}!1!==r.props.editable&&(r.setActiveCellLocation({row:e+n.skipRows,col:t+n.skipColumns}),r.isEditing&&r.onEndEdit())},g=r.props.rows[e.rowIndex+n.skipRows].columns[e.columnIndex+n.skipColumns].style,b=t=>{r.gridResize.setIsResizing(!0),r.gridResize.setResizingStartClientX(t.clientX),r.gridResize.setResizingColNumber(e.columnIndex+n.skipColumns)},N=(null===(t=r.activeCellLocation)||void 0===t?void 0:t.row)===e.rowIndex+n.skipRows&&(null===(l=r.activeCellLocation)||void 0===l?void 0:l.col)===e.columnIndex+n.skipColumns;return(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)("div",{ref:u,style:{...e.style,borderRight:"1px solid gray",borderBottom:"1px solid gray",...null!=g?g:{}},className:"h-full ".concat(null==m.custom?"py-0.5":""," relative whitespace-nowrap text-ellipsis text-sm flex items-center ").concat(m.isDisabled?v:""," ").concat(x?"justify-end":""," ").concat(!1===r.props.editable?"":"cursor-pointer"),onClick:()=>y(e.rowIndex,e.columnIndex),onDoubleClick:()=>r.onKeyDown(window,void 0,h),children:[!N&&null!=m.errorMessage&&(0,a.jsx)(Q,{isEditing:N&&r.isEditing,errorMessage:m.errorMessage}),(0,a.jsx)("div",{onMouseDown:e=>b(e),style:{zIndex:(null!==(i=r.props.zIndex)&&void 0!==i?i:0)+2},className:"absolute -right-1 top-0 w-1.5 h-full cursor-ew-resize"}),N?(0,a.jsxs)("div",{style:{pointerEvents:"none",boxSizing:r.isEditing?"content-box":"border-box",zIndex:null!==(o=r.props.zIndex)&&void 0!==o?o:1},className:"absolute ".concat(r.isEditing?"-top-0.5 -left-0.5 border-blue-400 border-2":"top-0 left-0 border-blue-600 border-1","  w-full h-full border-solid"),children:[null!=m.errorMessage&&(0,a.jsx)("div",{className:"w-full h-full absolute",children:(0,a.jsx)(Q,{isEditing:N&&r.isEditing,errorMessage:m.errorMessage})}),(0,a.jsx)("div",{className:"w-full h-full ".concat(r.isEditing?"border-2 border-solid border-blue-600 flex items-center":""," "),children:r.isEditing&&(0,a.jsx)(Y,{rightAlign:null!=x&&x})})]}):"",null!=m.custom?m.custom(f,p,m.data):"",null==m.custom&&(0,a.jsx)("span",{className:" overflow-hidden px-1",children:""===h.replaceAll(" ","")?"\xa0":h})]},e.columnIndex)})},ee=e=>{let[t,l]=(0,d.useState)(!1),[a,s]=(0,d.useState)(void 0),[i,o]=(0,d.useState)(void 0),[r,n]=(0,d.useState)(e.columnWidths),[u,c]=(0,d.useState)(e.columnWidths),[m,p]=(0,d.useState)({startX:0,startY:0,endY:0,clientX:0,clientY:0}),f=()=>{if(t){if(l(!1),null==i)return;let e=m.clientX-a,t=[...u],s=t[i]+e;s<32&&(s=32),t[i]=s,c(t)}};return(0,d.useEffect)(()=>(window.addEventListener("mouseup",f),()=>{window.removeEventListener("mouseup",f)})),(0,d.useEffect)(()=>{if(e.columnWidths.length!==r.length)n(e.columnWidths),c(e.columnWidths);else for(let t=0;t<e.columnWidths.length;t++)if(e.columnWidths[t]!==r[t]){n(e.columnWidths),c(e.columnWidths);break}},[e.columnWidths]),{isResizing:t,setIsResizing:l,resizingStartClientX:a,setResizingStartClientX:s,resizingColNumber:i,setResizingColNumber:o,columnWidths:u,setColWidths:c,onMouseMove:l=>{if(t&&l.preventDefault(),!e.divRef.current)return;let a=e.divRef.current.getBoundingClientRect();p({startX:l.clientX-a.left,startY:0,endY:a.height,clientX:l.clientX,clientY:l.clientY})},mousePosition:m}},et=e=>{if(e.rows.length>0){if(void 0===e.rows[0].columns||0===e.rows[0].columns.length)throw Error("DataGrid: rows must contain columns");let t=e.rows[0].columns.length;for(let l of e.rows){if(null==l.columns)throw Error("DataGrid: rows must contain columns");if(l.columns.length!==t)throw Error("DataGrid: rows must contain the same number of columns")}if("number"!=typeof e.columnWidths&&e.columnWidths.length!==t)throw Error("DataGrid: columnWidths ".concat(e.columnWidths," must be the same length as the number of columns ").concat(t))}};let el=(0,d.forwardRef)((e,t)=>{var l;let[s,i]=(0,d.useState)(void 0),[o,r]=(0,d.useState)(!1),[n,u]=(0,d.useState)(""),[c,m]=(0,d.useState)(!1),p=(0,d.useRef)(null),f=(0,d.useRef)(null),h=(0,d.useRef)(null),v=(0,d.useRef)(null),x=(0,d.useRef)(null);et(e);let y=(0,d.useCallback)(e=>{let{scrollLeft:t,scrollTop:l,scrollUpdateWasRequested:a}=e;if(!a){var s,i;null===(s=h.current)||void 0===s||s.scrollTo({scrollLeft:0,scrollTop:l}),null===(i=v.current)||void 0===i||i.scrollTo({scrollLeft:t,scrollTop:0})}},[]),g=ee({rows:e.rows,divRef:p,columnWidths:"number"==typeof e.columnWidths&&e.rows.length>0?Array(e.rows[0].columns.length).fill(e.columnWidths):"object"==typeof e.columnWidths?e.columnWidths:[]}),b=e.rows.length>0&&e.rows[0].columns.length>0?e.rows[0].columns.length:0,N=g.columnWidths.slice(0,null!==(l=e.snapColumns)&&void 0!==l?l:0).reduce((e,t)=>e+t,0),j=!1,I=(t,l,a)=>{if(!1!==e.editable&&((null==l?void 0:l.key)==="Shift"&&m(!0),!j)){if(void 0===l){w(l,a);return}if(s){if(("ArrowDown"===l.key||"ArrowUp"===l.key||"ArrowLeft"===l.key||"ArrowRight"===l.key||"Enter"===l.key||"Escape"===l.key||"Tab"===l.key)&&l.preventDefault(),"ArrowDown"===l.key){if(s.row===e.rows.length-1)return;E(),i({row:s.row+1,col:s.col}),j=!0}else if("ArrowUp"===l.key){if(0===s.row)return;E(),i({row:s.row-1,col:s.col}),j=!0}else if("ArrowLeft"===l.key){if(0===s.col)return;E(),i({row:s.row,col:s.col-1}),j=!0}else if("ArrowRight"===l.key){if(s.col===e.rows[0].columns.length-1)return;E(),i({row:s.row,col:s.col+1}),j=!0}else if("Enter"===l.key){if(E(),s.row===e.rows.length-1)return;i({row:s.row+1,col:s.col})}else if("Escape"===l.key)C();else if("Tab"===l.key){if(E(),c){if(0===s.col)return;i({row:s.row,col:s.col-1})}else{if(s.col===e.rows[0].columns.length-1)return;i({row:s.row,col:s.col+1})}l.stopPropagation()}else w(l)}}},w=(t,l)=>{if(!o&&s){let a=e.rows[s.row].columns[s.col].isReadOnly,i=e.rows[s.row].columns[s.col].isDisabled;if(a||i)return;null==t&&(u(null!=l?l:""),r(!0)),null!=t&&1===t.key.length&&(u(""),r(!0))}j=!1},E=()=>{if(s&&o){let t=e.rows[s.row].columns[s.col];null!=e.onEndEdit&&e.onEndEdit(n,s,t.data),null!=t.onEndEdit&&t.onEndEdit(n,s,t.data),u(""),r(!1)}},C=()=>{u(""),r(!1)};(0,d.useEffect)(()=>{let e=e=>{I(window,e)},t=e=>{"Shift"===e.key&&m(!1)};return window.addEventListener("keydown",e),window.addEventListener("keyup",t),()=>{window.removeEventListener("keydown",e),window.removeEventListener("keyup",t)}},[s,o,n,c]);let T=e=>{p.current&&!p.current.contains(e.target)&&i(void 0)},R=()=>{var e,t,l,a;null==f||null===(e=f.current)||void 0===e||e.resetAfterColumnIndex(0),null===(t=h.current)||void 0===t||t.resetAfterColumnIndex(0),null===(l=v.current)||void 0===l||l.resetAfterColumnIndex(0),null===(a=x.current)||void 0===a||a.resetAfterColumnIndex(0)};(0,d.useImperativeHandle)(t,()=>({reset:()=>{R()}})),(0,d.useEffect)(()=>{R()},[g.columnWidths]),(0,d.useEffect)(()=>(document.addEventListener("click",T,!0),()=>{document.removeEventListener("click",T,!0)}),[]);let A="";if(null!=e.columnWidths&&"object"==typeof e.columnWidths)for(let e=0;e<g.columnWidths.length;e++)A+=g.columnWidths[e];else A=e.columnWidths.toString();return(0,a.jsxs)("div",{ref:p,className:"w-full h-full relative",onMouseMove:e=>g.onMouseMove(e),children:[g.isResizing&&(0,a.jsx)("div",{style:{top:g.mousePosition.startY,left:g.mousePosition.startX,border:"1px solid black",width:1,height:g.mousePosition.endY,zIndex:null==e.zIndex?2:e.zIndex+2},className:"absolute"}),(0,a.jsx)(z.ZP,{children:t=>{var l,d,c,m,p,j,w,C,T;let{height:R,width:A}=t;return(0,a.jsx)(G.Provider,{value:{props:e,activeCell:null!=s&&null!=e.rows[s.row]&&null!=e.rows[s.row].columns[s.col]?e.rows[s.row].columns[s.col]:void 0,editValue:n,setEditValue:u,activeCellLocation:s,setActiveCellLocation:i,isEditing:o,setIsEditing:r,onKeyDown:I,onEndEdit:E,gridResize:g},children:(0,a.jsxs)("div",{style:{display:"flex",flexDirection:"row",width:A,height:R},children:[null!=e.snapColumns&&e.snapColumns>0&&(0,a.jsxs)("div",{style:{width:N,height:"100%"},children:[null!=e.snapRows&&e.snapRows>0&&(0,a.jsx)(J.Provider,{value:{skipColumns:0,skipRows:0},children:(0,a.jsx)(H.cd,{ref:f,columnCount:e.snapColumns,rowCount:e.snapRows,columnWidth:e=>g.columnWidths[e],rowHeight:e=>30,height:30*e.snapRows,width:N,style:{overflow:"hidden",...e.styletl},className:" border border-solid border-gray-500",children:$})}),(0,a.jsx)(J.Provider,{value:{skipColumns:0,skipRows:null!==(l=e.snapRows)&&void 0!==l?l:0},children:(0,a.jsx)(H.cd,{ref:h,columnCount:e.snapColumns,rowCount:e.rows.length-(null!==(d=e.snapRows)&&void 0!==d?d:0),columnWidth:e=>g.columnWidths[e],rowHeight:e=>30,height:R-(null!==(c=e.snapRows)&&void 0!==c?c:0)*30,width:N,style:{overflow:"hidden",...e.stylebl},className:" border border-solid border-gray-500",children:$})})]}),(0,a.jsxs)("div",{className:"w-full h-full flex flex-col",children:[null!=e.snapRows&&e.snapRows>0&&(0,a.jsx)(J.Provider,{value:{skipColumns:null!==(m=e.snapColumns)&&void 0!==m?m:0,skipRows:0},children:(0,a.jsx)(H.cd,{ref:v,columnCount:b-(null!==(p=e.snapColumns)&&void 0!==p?p:0),rowCount:e.snapRows,columnWidth:t=>{var l;return g.columnWidths[t+(null!==(l=e.snapColumns)&&void 0!==l?l:0)]},rowHeight:e=>30,height:30*e.snapRows,width:null!=e.snapColumns&&e.snapColumns>0?A-N:A,style:{overflow:"hidden",...e.styletr},className:" border border-solid border-gray-500",children:$})}),(0,a.jsx)(J.Provider,{value:{skipColumns:null!==(j=e.snapColumns)&&void 0!==j?j:0,skipRows:null!==(w=e.snapRows)&&void 0!==w?w:0},children:(0,a.jsx)(H.cd,{ref:x,onScroll:y,columnCount:b-(null!==(C=e.snapColumns)&&void 0!==C?C:0),rowCount:e.rows.length-(null!==(T=e.snapRows)&&void 0!==T?T:0),columnWidth:t=>{var l;return console.log(e.snapColumns),g.columnWidths[t+(null!==(l=e.snapColumns)&&void 0!==l?l:0)]},rowHeight:e=>30,height:null!=e.snapRows&&e.snapRows>0?R-30*e.snapRows:R,width:null!=e.snapColumns&&e.snapColumns>0?A-N:A,style:{...e.style},className:"thin-scrollbar-x border border-solid border-gray-500",children:$})})]})]})})}})]},"".concat(e.snapColumns,"-").concat(e.snapRows,"-").concat(A))});el.displayName="DataGrid";var ea=e=>{let[t,l]=(0,d.useState)([]),s=(t,i,o,r)=>{let n=!r;if(""===o&&n){var d;let t={RoleId:e.roleId,PermissionId:null===(d=e.state.allPermissions.find(e=>e.Name===i))||void 0===d?void 0:d.PermissionId,Permission:"permission.".concat(i)};e.setState(e=>({...e,createRolePermissions:[...e.createRolePermissions,t],deleteRolePermissions:e.deleteRolePermissions.filter(e=>e.Permission!=="permission.".concat(i))}))}else""!==o||n?""===o||n?""!==o&&n&&e.setState(e=>({...e,createRolePermissions:e.createRolePermissions.filter(e=>e.PermissionId!==o||e.Permission!=="permission.".concat(i)),deleteRolePermissions:e.deleteRolePermissions.filter(e=>e.RolePermissionId!==o)})):e.setState(e=>({...e,createRolePermissions:e.createRolePermissions.filter(e=>e.PermissionId!==o||e.Permission!=="permission.".concat(i)),deleteRolePermissions:[...e.deleteRolePermissions,{RolePermissionId:o}]})):e.setState(e=>({...e,createRolePermissions:e.createRolePermissions.filter(e=>e.Permission!=="permission.".concat(i))}));l(e=>{let l=[...e],r=l[t.row],d={...r.columns[t.col]};return d.custom=(e,t)=>(0,a.jsx)(U,{icon:n?"system":"none",onClick:()=>s(t,i,o,n)}),r.columns[t.col]=d,l})},i=(t,s,o,r,n)=>{let d="none",u=t;t.endsWith("NONE")?(u=u.substring(0,t.length-4).concat("USER"),d="user"):t.endsWith("USER")?(u=u.substring(0,t.length-4).concat("TEAM"),d="team"):t.endsWith("TEAM")?(u=u.substring(0,t.length-4).concat("SYSTEM"),d="system"):t.endsWith("SYSTEM")&&(u=u.substring(0,t.length-6).concat("NONE"),d="none"),"none"===d&&null!=o&&e.setState(e=>({...e,deleteRolePermissions:[...e.deleteRolePermissions,{RolePermissionId:o}],updateRolePermissions:e.updateRolePermissions.filter(e=>e.RolePermissionId!==o),createRolePermissions:e.createRolePermissions.filter(e=>e.PermissionId!==o)})),"none"!==d&&null==o&&e.setState(t=>{var l;return{...t,createRolePermissions:[...t.createRolePermissions.filter(e=>e.Permission!=="".concat(r,".").concat(n)),{RolePermissionId:"",RoleId:e.roleId,PermissionId:null===(l=e.state.allPermissions.find(e=>e.Name===u))||void 0===l?void 0:l.PermissionId,Permission:"".concat(r,".").concat(n)}]}}),"none"!==d&&null!=o&&e.setState(t=>{var l;return{...t,updateRolePermissions:[...t.updateRolePermissions.filter(e=>e.RolePermissionId!==o),{RolePermissionId:o,PermissionId:null===(l=e.state.allPermissions.find(e=>e.Name===u))||void 0===l?void 0:l.PermissionId}],deleteRolePermissions:t.deleteRolePermissions.filter(e=>e.RolePermissionId!==o)}}),l(e=>e.map((e,t)=>({columns:e.columns.map((e,l)=>t===s.row&&l===s.col?{...e,custom:(e,t)=>(0,a.jsx)(U,{icon:d,onClick:()=>i(u,t,o,r,n)})}:e)})))};return{toggleBinaryPermission:s,toggleTablePermission:i,rows:t,setRows:l}},es=e=>{let t=ea(e),l=(e,t,l)=>{var a,s,i,o,r;let n="none",d=e.find(e=>{var a;return null===(a=e.Permission)||void 0===a?void 0:a.startsWith("TABLE_".concat(t,"_").concat(l))});return null==d?{permissionLevel:"none",RolePermissionId:null}:(((null===(a=d.Permission)||void 0===a?void 0:a.endsWith("IMPORT"))||(null===(s=d.Permission)||void 0===s?void 0:s.endsWith("EXPORT")))&&(n="system"),(null===(i=d.Permission)||void 0===i?void 0:i.endsWith("USER"))&&(n="user"),(null===(o=d.Permission)||void 0===o?void 0:o.endsWith("TEAM"))&&(n="team"),(null===(r=d.Permission)||void 0===r?void 0:r.endsWith("SYSTEM"))&&(n="system"),{permissionLevel:n,RolePermissionId:d.RolePermissionId})},s=(s,i)=>{let o=[];for(let r of(o.push({columns:[{value:"Entity",isReadOnly:!0,style:{}},{value:"Create",isReadOnly:!0,style:{justifyContent:"center"}},{value:"Read",isReadOnly:!0,style:{justifyContent:"center"}},{value:"Update",isReadOnly:!0,style:{justifyContent:"center"}},{value:"Delete",isReadOnly:!0,style:{justifyContent:"center"}},{value:"Assign",isReadOnly:!0,style:{justifyContent:"center"}},{value:"Import",isReadOnly:!0,style:{justifyContent:"center"}},{value:"Export",isReadOnly:!0,style:{justifyContent:"center"}}]}),i)){let i=l(s,r.tableName,"CREATE"),n=l(s,r.tableName,"READ"),d=l(s,r.tableName,"UPDATE"),u=l(s,r.tableName,"DELETE"),c=l(s,r.tableName,"ASSIGN"),m=l(s,r.tableName,"IMPORT"),p=l(s,r.tableName,"EXPORT"),f=e.roleId!==ed,h={columns:[{value:r.tableName,isReadOnly:!0,style:{border:"none",userSelect:"none"}},{custom:(e,l)=>(0,a.jsx)(U,{icon:i.permissionLevel,onClick:()=>f&&t.toggleTablePermission("TABLE_".concat(r.tableName,"_CREATE_").concat(i.permissionLevel.toUpperCase()),l,i.RolePermissionId,r.tableName,"CREATE")}),isReadOnly:!0,style:{justifyContent:"center",border:"none",userSelect:"none"}},{custom:(e,l)=>(0,a.jsx)(U,{icon:n.permissionLevel,onClick:()=>f&&t.toggleTablePermission("TABLE_".concat(r.tableName,"_READ_").concat(n.permissionLevel.toUpperCase()),l,n.RolePermissionId,r.tableName,"READ")}),isReadOnly:!0,style:{justifyContent:"center",border:"none",userSelect:"none"}},{custom:(e,l)=>(0,a.jsx)(U,{icon:d.permissionLevel,onClick:()=>f&&t.toggleTablePermission("TABLE_".concat(r.tableName,"_UPDATE_").concat(d.permissionLevel.toUpperCase()),l,d.RolePermissionId,r.tableName,"UPDATE")}),isReadOnly:!0,style:{justifyContent:"center",border:"none",userSelect:"none"}},{custom:(e,l)=>(0,a.jsx)(U,{icon:u.permissionLevel,onClick:()=>f&&t.toggleTablePermission("TABLE_".concat(r.tableName,"_DELETE_").concat(u.permissionLevel.toUpperCase()),l,u.RolePermissionId,r.tableName,"DELETE")}),isReadOnly:!0,style:{justifyContent:"center",border:"none",userSelect:"none"}},{custom:(e,l)=>(0,a.jsx)(U,{icon:c.permissionLevel,onClick:()=>f&&t.toggleTablePermission("TABLE_".concat(r.tableName,"_ASSIGN_").concat(c.permissionLevel.toUpperCase()),l,c.RolePermissionId,r.tableName,"ASSIGN")}),isReadOnly:!0,style:{justifyContent:"center",border:"none",userSelect:"none"}},{custom:(e,l)=>(0,a.jsx)(U,{icon:m.permissionLevel,onClick:()=>{var e;return f&&t.toggleBinaryPermission(l,"TABLE_".concat(r.tableName,"_IMPORT"),null!==(e=m.RolePermissionId)&&void 0!==e?e:"","none"!==m.permissionLevel)}}),isReadOnly:!0,style:{justifyContent:"center",border:"none",userSelect:"none"}},{custom:(e,l)=>(0,a.jsx)(U,{icon:p.permissionLevel,onClick:()=>{var e;return f&&t.toggleBinaryPermission(l,"TABLE_".concat(r.tableName,"_EXPORT"),null!==(e=p.RolePermissionId)&&void 0!==e?e:"","none"!==p.permissionLevel)}}),isReadOnly:!0,style:{justifyContent:"center",border:"none",userSelect:"none"}}]};o.push(h)}t.setRows(o)};return(0,d.useEffect)(()=>{s(e.state.rolePermissions,e.state.tables)},[e.state.rolePermissions,e.state.tables]),(0,a.jsx)(el,{rows:t.rows,columnWidths:[300,100,100,100,100,100,100,100],snapRows:1,snapColumns:1,editable:!1,style:{borderBottomRightRadius:"0.2rem"},styletr:{borderTopRightRadius:"0.2rem"},styletl:{borderTopLeftRadius:"0.2rem"},stylebl:{borderBottomLeftRadius:"0.2rem"}})},ei=e=>{let t=ea(e),l=()=>{let l=[];l.push({columns:[{value:"Permission Name",isReadOnly:!0},{value:"Access",isReadOnly:!0,style:{justifyContent:"center"}}]});let s=e.roleId!==ed;for(let i of e.state.allPermissions){if("System"===i.Tag)continue;let o="",r=!1;for(let t of e.state.rolePermissions)if(t.PermissionId===i.PermissionId){o=t.RolePermissionId,r=!0;break}let n={columns:[{value:i.Name,isReadOnly:!0,style:{border:"none"}},{custom:(e,l)=>(0,a.jsx)(U,{icon:o?"system":"none",onClick:()=>s&&t.toggleBinaryPermission(l,i.Name,o,r)}),style:{justifyContent:"center",border:"none",userSelect:"none"}}]};l.push(n)}t.setRows(l)};return(0,d.useEffect)(()=>{l()},[]),(0,a.jsx)(el,{rows:t.rows,columnWidths:[300,150],snapColumns:1,snapRows:1,editable:!1,style:{borderBottomRightRadius:"0.2rem"},styletr:{borderTopRightRadius:"0.2rem"},styletl:{borderTopLeftRadius:"0.2rem"},stylebl:{borderBottomLeftRadius:"0.2rem"}})},eo=e=>{let t=ea(e),l=()=>{let l=[];l.push({columns:[{value:"Permission Name",isReadOnly:!0},{value:"Access",isReadOnly:!0,style:{justifyContent:"center"}}]});let s=e.roleId!==ed;for(let i of e.state.allPermissions){if("System"!==i.Tag||!i.Name.startsWith("JOB_"))continue;let o="",r=!1;for(let t of e.state.rolePermissions)if(t.PermissionId===i.PermissionId){o=t.RolePermissionId,r=!0;break}let n={columns:[{value:i.Name,isReadOnly:!0,style:{border:"none"}},{custom:(e,l)=>(0,a.jsx)(U,{icon:o?"system":"none",onClick:()=>s&&t.toggleBinaryPermission(l,i.Name,o,r)}),style:{justifyContent:"center",border:"none",userSelect:"none"}}]};l.push(n)}t.setRows(l)};return(0,d.useEffect)(()=>{l()},[]),(0,a.jsx)(el,{rows:t.rows,columnWidths:[300,150],snapColumns:1,snapRows:1,editable:!1,style:{borderBottomRightRadius:"0.2rem"},styletr:{borderTopRightRadius:"0.2rem"},styletl:{borderTopLeftRadius:"0.2rem"},stylebl:{borderBottomLeftRadius:"0.2rem"}})},er=e=>{let t=ea(e),l=()=>{let l=[];l.push({columns:[{value:"Permission Name",isReadOnly:!0},{value:"Access",isReadOnly:!0,style:{justifyContent:"center"}}]});let s=e.roleId!==ed;for(let i of e.state.allPermissions){if("System"!==i.Tag||i.Name.startsWith("TABLE_")||i.Name.startsWith("JOB_")||!(i.Name.startsWith("ACTION_ADMIN")||i.Name.startsWith("ACTION_TABLE")||i.Name.startsWith("ACCESS_ADMIN")))continue;let o="",r=!1;for(let t of e.state.rolePermissions)if(t.PermissionId===i.PermissionId){o=t.RolePermissionId,r=!0;break}let n={columns:[{value:i.Name,isReadOnly:!0,style:{border:"none"}},{custom:(e,l)=>(0,a.jsx)(U,{icon:o?"system":"none",onClick:()=>s&&t.toggleBinaryPermission(l,i.Name,o,r)}),style:{justifyContent:"center",border:"none",userSelect:"none"}}]};l.push(n)}t.setRows(l)};return(0,d.useEffect)(()=>{l()},[]),(0,a.jsx)(el,{rows:t.rows,columnWidths:[300,150],snapColumns:1,snapRows:1,editable:!1,style:{borderBottomRightRadius:"0.2rem"},styletr:{borderTopRightRadius:"0.2rem"},styletl:{borderTopLeftRadius:"0.2rem"},stylebl:{borderBottomLeftRadius:"0.2rem"}})},en=e=>{let t=ea(e),l=()=>{let l=[];l.push({columns:[{value:"Permission Name",isReadOnly:!0},{value:"Access",isReadOnly:!0,style:{justifyContent:"center"}}]});let s=e.roleId!==ed;for(let i of e.state.allPermissions){if("System"!==i.Tag||i.Name.startsWith("TABLE_")||i.Name.startsWith("JOB_")||i.Name.startsWith("ACTION_ADMIN")||i.Name.startsWith("ACTION_TABLE")||"ACCESS_ADMIN_DASHBOARD"==i.Name)continue;let o="",r=!1;for(let t of e.state.rolePermissions)if(t.PermissionId===i.PermissionId){o=t.RolePermissionId,r=!0;break}let n={columns:[{value:i.Name,isReadOnly:!0,style:{border:"none"}},{custom:(e,l)=>(0,a.jsx)(U,{icon:o?"system":"none",onClick:()=>s&&t.toggleBinaryPermission(l,i.Name,o,r)}),style:{justifyContent:"center",border:"none",userSelect:"none"}}]};l.push(n)}t.setRows(l)};return(0,d.useEffect)(()=>{l()},[]),(0,a.jsx)(el,{rows:t.rows,columnWidths:[300,150],snapColumns:1,snapRows:1,editable:!1,style:{borderBottomRightRadius:"0.2rem"},styletr:{borderTopRightRadius:"0.2rem"},styletl:{borderTopLeftRadius:"0.2rem"},stylebl:{borderBottomLeftRadius:"0.2rem"}})};let ed="64589861-0481-4dbb-a96f-9b8b6546c40d";var eu=e=>{let t=(0,s.Z)(),[l,o]=d.useState(!0),[r,n]=(0,d.useState)({tables:[],allPermissions:[],rolePermissions:[],createRolePermissions:[],updateRolePermissions:[],deleteRolePermissions:[],isLoaded:!1}),[u,c]=(0,d.useState)("entities"),m=async()=>{if(null==e.roleId){o(!1);return}let l=await t.tables();if(!l.succeeded)return;let a=new M.ZP(["*"]).top(999999).from("Permission").orderBy("Name","asc").distinct().toReadRequest(),s=await t.read(a),i=new M.ZP(["*"]).top(999999).from("RolePermission").where("RoleId","==",e.roleId).distinct().toReadRequest(),r=await t.read(i);r.succeeded&&(n(e=>({...e,tables:l.data,allPermissions:s.data.results,rolePermissions:r.data.results,isLoaded:!0})),o(!1))},p=(0,d.useCallback)(async()=>(o(!0),(await t.bulk({creates:r.createRolePermissions.map(e=>({tableName:"RolePermission",fields:{PermissionId:e.PermissionId,RoleId:e.RoleId}})),updates:r.updateRolePermissions.map(e=>({tableName:"RolePermission",fields:e})),deletes:r.deleteRolePermissions.map(e=>({tableName:"RolePermission",fields:e}))})).succeeded)?(o(!1),{continue:!0}):(o(!1),{continue:!1}),[r.deleteRolePermissions,r.createRolePermissions,r.updateRolePermissions]);return(0,d.useEffect)(()=>{m()},[]),(0,a.jsxs)("div",{className:"w-full flex flex-col gap-4",children:[(0,a.jsx)(Z.Z,{name:"Name"}),(0,a.jsxs)("div",{className:"w-full h-[500px] relative",children:[l&&(0,a.jsx)("div",{className:"w-full h-full absolute flex justify-center items-center",children:(0,a.jsx)(i.a,{})}),null==e.roleId&&(0,a.jsx)("div",{className:"w-full h-full flex justify-center items-center",children:"Save the role to set permissions"}),null!=e.roleId&&r.isLoaded&&(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)(W.m,{defaultValue:"entities",className:"h-full flex flex-col",onChange:c,children:[(0,a.jsxs)(W.m.List,{children:[(0,a.jsx)(W.m.Tab,{value:"entities",children:"Entities"}),(0,a.jsx)(W.m.Tab,{value:"actions",children:"Actions"}),(0,a.jsx)(W.m.Tab,{value:"jobs",children:"Jobs"}),(0,a.jsx)(W.m.Tab,{value:"system",children:"System"}),(0,a.jsx)(W.m.Tab,{value:"permissions",children:"Custom Permissions"})]}),(0,a.jsx)(W.m.Panel,{value:"entities",pt:"xs",className:"h-full",children:(0,a.jsx)("div",{className:"w-full h-full",children:(0,a.jsx)(es,{roleId:e.roleId,state:r,setState:n})})}),(0,a.jsx)(W.m.Panel,{value:"actions",pt:"xs",className:"h-full",children:(0,a.jsx)("div",{className:"w-full h-full",children:(0,a.jsx)(en,{roleId:e.roleId,state:r,setState:n})})}),(0,a.jsx)(W.m.Panel,{value:"permissions",pt:"xs",className:"h-full",children:(0,a.jsx)("div",{className:"w-full h-full",children:(0,a.jsx)(ei,{roleId:e.roleId,state:r,setState:n})})}),(0,a.jsx)(W.m.Panel,{value:"jobs",pt:"xs",className:"h-full",children:(0,a.jsx)("div",{className:"w-full h-full",children:(0,a.jsx)(eo,{roleId:e.roleId,state:r,setState:n})})}),(0,a.jsx)(W.m.Panel,{value:"system",pt:"xs",className:"h-full",children:(0,a.jsx)("div",{className:"w-full h-full",children:(0,a.jsx)(er,{roleId:e.roleId,state:r,setState:n})})})]})})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsxs)("div",{className:"flex gap-5 w-full",children:[null!=e.roleId&&null!=u&&"entities"===u&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("span",{className:"flex text-sm gap-1 items-center",children:[(0,a.jsx)(U,{icon:"none"}),"None"]}),(0,a.jsxs)("span",{className:"flex text-sm gap-1 items-center",children:[(0,a.jsx)(U,{icon:"user"}),"User"]}),(0,a.jsxs)("span",{className:"flex text-sm gap-1 items-center",children:[(0,a.jsx)(U,{icon:"team"}),"Team"]}),(0,a.jsxs)("span",{className:"flex text-sm gap-1 items-center",children:[(0,a.jsx)(U,{icon:"system"}),"System"]})]}),null!=e.roleId&&null!=u&&("permissions"===u||"system"===u)&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("span",{className:"flex text-sm gap-1 items-center whitespace-nowrap",children:[(0,a.jsx)(U,{icon:"none"}),"Doesn't have permission"]}),(0,a.jsxs)("span",{className:"flex text-sm gap-1 items-center whitespace-nowrap",children:[(0,a.jsx)(U,{icon:"system"}),"Has permission"]})]}),null!=e.roleId&&null!=u&&"actions"===u&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("span",{className:"flex text-sm gap-1 items-center whitespace-nowrap",children:[(0,a.jsx)(U,{icon:"none"}),"Can't execute action"]}),(0,a.jsxs)("span",{className:"flex text-sm gap-1 items-center whitespace-nowrap",children:[(0,a.jsx)(U,{icon:"system"}),"Can execute action"]})]}),null!=e.roleId&&null!=u&&"jobs"===u&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("span",{className:"flex text-sm gap-1 items-center whitespace-nowrap",children:[(0,a.jsx)(U,{icon:"none"}),"Can't start job"]}),(0,a.jsxs)("span",{className:"flex text-sm gap-1 items-center whitespace-nowrap",children:[(0,a.jsx)(U,{icon:"system"}),"Can start job"]})]}),"UPDATE"===e.formBuilder.operation&&(0,a.jsx)("div",{className:"w-full flex justify-start items-center pr-2",children:(0,a.jsx)(L,{value:e.formBuilder.data["".concat(e.formBuilder.tableName,"Id")]})})]}),(0,a.jsx)("div",{children:(0,a.jsx)(V.Z,{onPreSave:p})})]})]})},ec=()=>{var e,t,l,s,i;let o=eP();return(0,a.jsx)(a.Fragment,{children:o.tables.filter(e=>["User","Role","Team","Permission"].includes(e.tableName)).length>0&&!(null===(e=o.props.hiddenMenuItems)||void 0===e?void 0:e.includes("Security"))&&(0,a.jsxs)(C.O,{label:"Security",leftSection:(0,a.jsx)(O.Z,{size:16,strokeWidth:2,color:o.color}),children:[o.tables.find(e=>"User"===e.tableName)&&!(null===(t=o.props.hiddenMenuItems)||void 0===t?void 0:t.includes("Users"))&&(0,a.jsx)(C.O,{label:"Users",onClick:()=>o.setActiveComponent({component:(0,a.jsx)("div",{className:"w-full h-full flex flex-col",children:(0,a.jsx)("div",{className:"grow h-1",children:(0,a.jsx)(A,{tableName:"User",maxResults:100,formMaxWidth:72,formAppendButton:e=>(0,a.jsx)(a.Fragment,{children:"UPDATE"===e.operation&&(0,a.jsx)("div",{className:"w-full flex justify-start items-center gap-1",children:(0,a.jsx)(L,{value:e.data["".concat(e.tableName,"Id")]})})}),appendCustomForm:e=>void 0===e.snapshot?(0,a.jsx)(a.Fragment,{}):(0,a.jsxs)("div",{className:" h-96 mt-5 flex justify-stretch gap-4",children:[(0,a.jsx)(A,{title:"Roles",tableName:"UserRole",fields:["RoleId"],filters:[{field:"UserId",value:e.snapshot.UserId}],formZIndex:1e3,formFields:["RoleId"],formFieldDefaults:[{field:"UserId",value:e.snapshot.UserId}],formLookupQueries:[{field:"RoleId",except:[{fromField:"RoleId",query:{tableName:"UserRole",fields:["RoleId"],filters:[{field:"UserId",operator:"==",value:e.snapshot.UserId}]}}]}]}),(0,a.jsx)(A,{title:"Teams",tableName:"TeamUser",fields:["TeamId"],filters:[{field:"UserId",value:e.snapshot.UserId}],formZIndex:1e3,formFields:["TeamId"],formFieldDefaults:[{field:"UserId",value:e.snapshot.UserId}],formLookupQueries:[{field:"TeamId",except:[{fromField:"TeamId",query:{tableName:"TeamUser",fields:["TeamId"],filters:[{field:"UserId",operator:"==",value:e.snapshot.UserId}]}}]}]})]})})})})}),leftSection:(0,a.jsx)(P.Z,{size:16,strokeWidth:2,color:o.color})}),o.tables.find(e=>"Team"===e.tableName)&&!(null===(l=o.props.hiddenMenuItems)||void 0===l?void 0:l.includes("Teams"))&&(0,a.jsx)(C.O,{label:"Teams",onClick:()=>o.setActiveComponent({component:(0,a.jsx)("div",{className:"w-full h-full flex flex-col",children:(0,a.jsx)("div",{className:"grow h-1",children:(0,a.jsx)(A,{tableName:"Team",formCloseOnCreate:!1,maxResults:100,formMaxWidth:72,formAppendButton:e=>(0,a.jsx)(a.Fragment,{children:"UPDATE"===e.operation&&(0,a.jsx)("div",{className:"w-full flex justify-start items-center gap-1",children:(0,a.jsx)(L,{value:e.data["".concat(e.tableName,"Id")]})})}),appendCustomForm:e=>void 0===e.snapshot?(0,a.jsx)(a.Fragment,{}):(0,a.jsxs)("div",{className:" h-96 mt-5 flex justify-stretch gap-4",children:[(0,a.jsx)(A,{title:"Roles",tableName:"TeamRole",fields:["RoleId"],filters:[{field:"TeamId",value:e.snapshot.TeamId}],formZIndex:1e3,formFields:["RoleId"],formFieldDefaults:[{field:"TeamId",value:e.snapshot.TeamId}],formLookupQueries:[{field:"RoleId",except:[{fromField:"RoleId",query:{tableName:"TeamRole",fields:["RoleId"],filters:[{field:"TeamId",operator:"==",value:e.snapshot.TeamId}]}}]}]}),(0,a.jsx)(A,{title:"Users",tableName:"TeamUser",fields:["UserId"],filters:[{field:"TeamId",value:e.snapshot.TeamId}],formZIndex:1e3,formFields:["UserId"],formFieldDefaults:[{field:"TeamId",value:e.snapshot.TeamId}],formLookupQueries:[{field:"UserId",except:[{fromField:"UserId",query:{tableName:"TeamUser",fields:["UserId"],filters:[{field:"TeamId",operator:"==",value:e.snapshot.TeamId}]}}]}]})]})})})})}),leftSection:(0,a.jsx)(k.Z,{size:16,strokeWidth:2,color:o.color})}),o.tables.find(e=>"Role"===e.tableName)&&!(null===(s=o.props.hiddenMenuItems)||void 0===s?void 0:s.includes("Roles"))&&(0,a.jsx)(C.O,{label:"Roles",onClick:()=>{o.setActiveComponent({component:(0,a.jsx)(A,{tableName:"Role",formMaxWidth:72,maxResults:100,formCloseOnCreate:!1,customForm:e=>{var t,l;return(0,a.jsx)(eu,{roleId:null===(t=e.snapshot)||void 0===t?void 0:t.RoleId,formBuilder:e},null===(l=e.snapshot)||void 0===l?void 0:l.RoleId)}})})},leftSection:(0,a.jsx)(F.Z,{size:16,strokeWidth:2,color:o.color})}),o.tables.find(e=>"Permission"===e.tableName)&&!(null===(i=o.props.hiddenMenuItems)||void 0===i?void 0:i.includes("Permissions"))&&(0,a.jsx)(C.O,{label:"Permissions",onClick:()=>o.setActiveComponent({component:(0,a.jsx)("div",{className:"w-full h-full flex flex-col",children:(0,a.jsx)("div",{className:"grow h-1",children:(0,a.jsx)(A,{tableName:"Permission",fields:["Name"],filters:[{field:"Tag",operator:"!=",value:"System"}],formFields:["Name"],formCloseOnCreate:!0,formMaxWidth:36,maxResults:100,formAppendButton:e=>(0,a.jsx)(a.Fragment,{children:"UPDATE"===e.operation&&(0,a.jsx)("div",{className:"w-full flex justify-start items-center gap-1",children:(0,a.jsx)(L,{value:e.data["".concat(e.tableName,"Id")]})})})})})})}),leftSection:(0,a.jsx)(h.Z,{size:16,strokeWidth:2,color:o.color})})]})})},em=l(6283),ep=()=>{var e;let t=eP();return(0,a.jsx)(a.Fragment,{children:t.tables.filter(e=>"Option"===e.tableName).length>0&&!(null===(e=t.props.hiddenMenuItems)||void 0===e?void 0:e.includes("Options"))&&(0,a.jsx)(C.O,{label:"Options",leftSection:(0,a.jsx)(em.Z,{size:16,strokeWidth:2,color:t.color}),onClick:()=>t.setActiveComponent({component:(0,a.jsx)(A,{tableName:"Option",maxResults:100,formAppendButton:e=>(0,a.jsx)(a.Fragment,{children:"UPDATE"===e.operation&&(0,a.jsx)("div",{className:"w-full flex justify-start items-center gap-1",children:(0,a.jsx)(L,{value:e.data["".concat(e.tableName,"Id")]})})})})})})})},ef=l(5968),eh=l(9990),ev=e=>{var t,l,i,o;let r=(0,s.Z)();(0,d.useRef)(null);let[u,c]=(0,d.useState)(!1),[m,p]=(0,d.useState)(!1),f=async()=>{var t;c(!0),e.formBuilder.dispatch({type:"SET_FIELD_VALUE",payload:{field:"Status",value:"Running"}}),await r.action("ADMIN_TriggerJob",{jobName:null===(t=e.formBuilder.snapshot)||void 0===t?void 0:t.Name}),c(!1)};return null==e.formBuilder.snapshot||(null===(t=e.formBuilder.snapshot)||void 0===t?void 0:t.Name)==null||(null===(l=e.formBuilder.snapshot)||void 0===l?void 0:l.name)===""||(null===(i=e.formBuilder.snapshot)||void 0===i?void 0:i._ui_info_)==null?(0,a.jsx)(a.Fragment,{}):(null===(o=e.formBuilder.snapshot)||void 0===o?void 0:o._ui_info_.canTrigger)===!0?(0,a.jsx)(n.z,{variant:"outline",onClick:f,loading:u,children:"Run Job"}):(0,a.jsx)(a.Fragment,{})},ex=()=>{var e;let t=eP();return(0,a.jsx)(a.Fragment,{children:t.tables.filter(e=>"Job"===e.tableName).length>0&&!(null===(e=t.props.hiddenMenuItems)||void 0===e?void 0:e.includes("Jobs"))&&(0,a.jsx)(C.O,{label:"Jobs",leftSection:(0,a.jsx)(eh.Z,{size:16,strokeWidth:2,color:t.color}),onClick:()=>t.setActiveComponent({component:(0,a.jsx)(A,{tableName:"Job",orderBy:[{field:"Name",order:"asc"}],fields:["Name","Queue","IsActive","LastExecution"],filters:[{field:"Tag",operator:"!=",value:"System"}],canCreate:!1,canDelete:!1,formCloseOnEscape:!0,customForm:e=>(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(ef.r,{children:[(0,a.jsx)(ef.r.Col,{span:4,children:(0,a.jsx)(Z.Z,{name:"Name"})}),(0,a.jsx)(ef.r.Col,{span:4,children:(0,a.jsx)(Z.Z,{name:"Queue"})}),(0,a.jsx)(ef.r.Col,{span:4,children:(0,a.jsx)(Z.Z,{name:"LastExecution"})})]}),(0,a.jsxs)(ef.r,{children:[(0,a.jsx)(ef.r.Col,{span:4,children:(0,a.jsx)(Z.Z,{name:"IsActive"})}),(0,a.jsx)(ef.r.Col,{span:4}),(0,a.jsx)(ef.r.Col,{span:4})]})]}),appendCustomForm:e=>{var t;return"CREATE"===e.operation&&a.Fragment,(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"w-full h-96 mt-4",children:(0,a.jsx)(A,{title:"History",tableName:"JobHistory",fields:["ServerName","Status","Message","CreatedDate","CompletedDate"],filters:[{field:"JobId",value:null===(t=e.snapshot)||void 0===t?void 0:t.JobId}],orderBy:[{field:"CreatedDate",order:"desc"}],refreshInterval:1e3,maxResults:100,canUpdate:!1,canCreate:!1,customForm:e=>(0,a.jsxs)("div",{className:"w-full flex flex-col gap-2",children:[(0,a.jsxs)(ef.r,{children:[(0,a.jsx)(ef.r.Col,{span:4,children:(0,a.jsx)(Z.Z,{name:"Name"})}),(0,a.jsx)(ef.r.Col,{span:4,children:(0,a.jsx)(Z.Z,{name:"JobId"})}),(0,a.jsx)(ef.r.Col,{span:4,children:(0,a.jsx)(Z.Z,{name:"Status"})})]}),(0,a.jsxs)(ef.r,{children:[(0,a.jsx)(ef.r.Col,{span:4,children:(0,a.jsx)(Z.Z,{name:"CreatedDate"})}),(0,a.jsx)(ef.r.Col,{span:4,children:(0,a.jsx)(Z.Z,{name:"CompletedDate"})}),(0,a.jsx)(ef.r.Col,{span:4})]}),(0,a.jsx)("div",{className:"w-full h-48",children:(0,a.jsx)(Z.Z,{name:"Message",varient:"textarea"})})]})})}),(0,a.jsxs)("div",{className:"w-full flex justify-between mt-3",children:["UPDATE"===e.operation&&(0,a.jsx)("div",{className:"w-full flex justify-start items-center gap-1",children:(0,a.jsx)(L,{value:e.data["".concat(e.tableName,"Id")]})}),(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)("div",{className:"mr-2",children:(0,a.jsx)(ev,{formBuilder:e})}),(0,a.jsx)(V.Z,{})]})]})]})}})})})})},ey=l(6597),eg=()=>{var e;let t=eP();return(0,a.jsx)(a.Fragment,{children:t.tables.filter(e=>"Setting"===e.tableName).length>0&&!(null===(e=t.props.hiddenMenuItems)||void 0===e?void 0:e.includes("Settings"))&&(0,a.jsx)(C.O,{label:"Settings",leftSection:(0,a.jsx)(ey.Z,{size:16,strokeWidth:2,color:t.color}),onClick:()=>t.setActiveComponent({component:(0,a.jsx)(A,{tableName:"Setting",maxResults:100,formAppendButton:e=>(0,a.jsx)(a.Fragment,{children:"UPDATE"===e.operation&&(0,a.jsx)("div",{className:"w-full flex justify-start items-center gap-1",children:(0,a.jsx)(L,{value:e.data["".concat(e.tableName,"Id")]})})})})})})})},eb=l(1444),eN=l(365),ej=l(6955),eI=l(3766),ew=e=>{var t,l;let i=(0,s.Z)(),o=(0,d.useRef)(null),[r,n]=(0,d.useState)(!1),[u,c]=(0,d.useState)(!1),[m,p]=(0,d.useState)(!1),h=e=>{e.filter(e=>e.IsCreate).length===e.length?n(!0):n(!1),e.filter(e=>e.IsUpdate).length===e.length?c(!0):c(!1),e.filter(e=>e.IsDelete).length===e.length?p(!0):p(!1)},v=async e=>{var t;return!0===(await i.bulkUpdate(e.map(e=>({tableName:"AuditField",fields:{...e}})))).succeeded||(null===(t=o.current)||void 0===t||t.refresh(),!1)},x=async e=>{var t;return!0===(await i.update("AuditField",e)).succeeded||(null===(t=o.current)||void 0===t||t.refresh(),!1)};return(0,a.jsxs)("div",{className:"w-full flex flex-col gap-4",children:[(0,a.jsx)(eN.b,{icon:(0,a.jsx)(eI.Z,{size:"1rem"}),color:"yellow",children:"In a multi-server environment, Audit configuration changes may take up to 5 minutes to take effect."}),(null===(t=e.formBuilder.snapshot)||void 0===t?void 0:t.IsTable)&&(0,a.jsxs)(ef.r,{children:[(0,a.jsx)(ef.r.Col,{span:4,children:(0,a.jsx)(Z.Z,{name:"Name"})}),(0,a.jsx)(ef.r.Col,{span:2,children:(0,a.jsx)(Z.Z,{name:"IsCreate"})}),(0,a.jsx)(ef.r.Col,{span:2,children:(0,a.jsx)(Z.Z,{name:"IsRead"})}),(0,a.jsx)(ef.r.Col,{span:2,children:(0,a.jsx)(Z.Z,{name:"IsUpdate"})}),(0,a.jsx)(ef.r.Col,{span:2,children:(0,a.jsx)(Z.Z,{name:"IsDelete"})})]}),(0,a.jsx)("div",{className:"w-full h-[550px]",children:(0,a.jsx)(ej.default,{tableName:"AuditField",columnWidths:["100%","130px","130px","130px"],additionalFields:["IsCreate","IsUpdate","IsDelete"],canDelete:!1,fields:["Name",{header:e=>(0,a.jsx)("div",{children:(0,a.jsx)(f.X,{label:"Create",checked:r,onChange:t=>{n(t.target.checked),e.setRecords(e=>{let l=e.map(e=>({...e,IsCreate:t.target.checked}));return v(l),l})}})}),body:(e,t)=>(0,a.jsx)(f.X,{checked:e.IsCreate,onChange:l=>{t.setRecords(t=>{let a=t.map(t=>t.AuditFieldId===e.AuditFieldId?{...t,IsCreate:l.target.checked}:t);return a.filter(e=>e.IsCreate).length===t.length?n(!0):n(!1),x(a.find(t=>t.AuditFieldId===e.AuditFieldId)),a})}})},{header:e=>(0,a.jsx)("div",{children:(0,a.jsx)(f.X,{label:"Update",checked:u,onChange:t=>{c(t.target.checked),e.setRecords(e=>{let l=e.map(e=>({...e,IsUpdate:t.target.checked}));return v(l),l})}})}),body:(e,t)=>(0,a.jsx)(f.X,{checked:e.IsUpdate,onChange:l=>{t.setRecords(t=>{let a=t.map(t=>t.AuditFieldId===e.AuditFieldId?{...t,IsUpdate:l.target.checked}:t);return a.filter(e=>e.IsUpdate).length===t.length?c(!0):c(!1),x(a.find(t=>t.AuditFieldId===e.AuditFieldId)),a})}})},{header:e=>(0,a.jsx)("div",{children:(0,a.jsx)(f.X,{label:"Delete",checked:m,onChange:t=>{p(t.target.checked),e.setRecords(e=>{let l=e.map(e=>({...e,IsDelete:t.target.checked}));return v(l),l})}})}),body:(e,t)=>(0,a.jsx)(f.X,{checked:e.IsDelete,onChange:l=>{t.setRecords(t=>{let a=t.map(t=>t.AuditFieldId===e.AuditFieldId?{...t,IsDelete:l.target.checked}:t);return a.filter(e=>e.IsDelete).length===t.length?p(!0):p(!1),x(a.find(t=>t.AuditFieldId===e.AuditFieldId)),a})}})}],maxResults:99999,onRowClick:e=>!1,filters:[{field:"AuditId",operator:"==",value:null===(l=e.formBuilder.snapshot)||void 0===l?void 0:l.AuditId}],orderBy:[{field:"Name",order:"asc"}],onDataLoaded:e=>{h(e.results)}})}),(0,a.jsxs)("div",{className:"w-full flex justify-between",children:["UPDATE"===e.formBuilder.operation&&(0,a.jsx)("div",{className:"w-full flex justify-start items-center gap-1",children:(0,a.jsx)(L,{value:e.formBuilder.data["".concat(e.formBuilder.tableName,"Id")]})}),(0,a.jsx)(V.Z,{})]})]})},eE=l(2033),eC=e=>{var t,l,s,i,o,r,n;return(0,d.useEffect)(()=>{var t,l,a;if((null===(t=e.formBuilder.snapshot)||void 0===t?void 0:t.Operation)!=="Read")return;let s=JSON.stringify(JSON.parse(null===(l=e.formBuilder.snapshot)||void 0===l?void 0:l.Query),null,4),i=JSON.stringify(JSON.parse(null===(a=e.formBuilder.snapshot)||void 0===a?void 0:a.Results),null,4);e.formBuilder.setField("Query",s),e.formBuilder.setField("Results",i)},[null===(t=e.formBuilder.snapshot)||void 0===t?void 0:t.Query,null===(l=e.formBuilder.snapshot)||void 0===l?void 0:l.Results]),(0,a.jsxs)("div",{className:"w-full flex flex-col gap-4",children:[(0,a.jsxs)(ef.r,{children:[(0,a.jsx)(ef.r.Col,{span:4,children:(0,a.jsx)(Z.Z,{name:"TableName"})}),(0,a.jsx)(ef.r.Col,{span:4,children:(0,a.jsx)(Z.Z,{name:"Operation"})}),(0,a.jsx)(ef.r.Col,{span:4,children:(0,a.jsx)(Z.Z,{name:"CreatedDate"})})]}),(0,a.jsxs)(ef.r,{children:[(0,a.jsx)(ef.r.Col,{span:4,children:(0,a.jsx)(Z.Z,{name:"UserId"})}),(0,a.jsx)(ef.r.Col,{span:4,children:(0,a.jsx)(eE.o,{label:"UserId",value:null===(s=e.formBuilder.snapshot)||void 0===s?void 0:s.UserId,readOnly:!0})})]}),(0,a.jsx)(ef.r,{children:(null===(i=e.formBuilder.snapshot)||void 0===i?void 0:i.Operation)!=="Read"&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(ef.r.Col,{span:4,children:(0,a.jsx)(Z.Z,{name:"Name"})}),(0,a.jsx)(ef.r.Col,{span:4,children:(0,a.jsx)(Z.Z,{name:"EntityId"})})]})}),(null===(o=e.formBuilder.snapshot)||void 0===o?void 0:o.Operation)==="Read"&&(0,a.jsxs)(ef.r,{children:[(0,a.jsx)(ef.r.Col,{span:6,children:(0,a.jsx)("div",{className:"w-full h-[60vh]",children:(0,a.jsx)(Z.Z,{name:"Query",varient:"textarea"})})}),(0,a.jsx)(ef.r.Col,{span:6,children:(0,a.jsx)("div",{className:"w-full h-[60vh]",children:(0,a.jsx)(Z.Z,{name:"Results",varient:"textarea"})})})]}),(null===(r=e.formBuilder.snapshot)||void 0===r?void 0:r.Operation)!=="Read"&&(0,a.jsx)("div",{className:"w-full h-[500px] mt-2",children:(0,a.jsx)(ej.default,{tableName:"AuditHistoryDetail",disabledMessage:null==e.formBuilder.snapshot?"Loading...":void 0,fields:["Name","OldValue","NewValue","EntityName"],maxResults:100,orderBy:[{field:"Name",order:"ASC"}],filters:[{field:"AuditHistoryId",value:null===(n=e.formBuilder.snapshot)||void 0===n?void 0:n.AuditHistoryId}]})}),"UPDATE"===e.formBuilder.operation&&(0,a.jsx)("div",{className:"w-full flex justify-start items-center gap-1",children:(0,a.jsx)(L,{value:e.formBuilder.data["".concat(e.formBuilder.tableName,"Id")]})})]})},eT=()=>{var e;let t=eP();return(0,a.jsx)(a.Fragment,{children:t.tables.filter(e=>"Option"===e.tableName).length>0&&!(null===(e=t.props.hiddenMenuItems)||void 0===e?void 0:e.includes("Options"))&&(0,a.jsx)(C.O,{label:"Audit",leftSection:(0,a.jsx)(eb.Z,{size:16,strokeWidth:2,color:t.color}),onClick:()=>t.setActiveComponent({component:(0,a.jsxs)(W.m,{defaultValue:"history",styles:{root:{display:"flex",flexDirection:"column",height:"100%",flexGrow:1},panel:{display:"flex",flexDirection:"column",flexGrow:1,height:1}},children:[(0,a.jsxs)(W.m.List,{children:[(0,a.jsx)(W.m.Tab,{value:"history",children:"History"}),(0,a.jsx)(W.m.Tab,{value:"config",children:"Config"})]}),(0,a.jsx)(W.m.Panel,{value:"history",children:(0,a.jsx)("div",{className:"w-full h-full pt-4",children:(0,a.jsx)(A,{tableName:"AuditHistory",fields:["Operation","TableName","User","Name","CreatedDate"],columnWidths:["125px","100%","100%","100%","100%"],title:"History",maxResults:100,canCreate:!1,orderBy:[{field:"CreatedDate",order:"desc"}],customForm:e=>(0,a.jsx)(eC,{formBuilder:e})})})}),(0,a.jsx)(W.m.Panel,{value:"config",children:(0,a.jsx)("div",{className:"w-full h-full pt-4",children:(0,a.jsx)(A,{tableName:"Audit",title:"Audit",formTitle:"Audit",maxResults:100,orderBy:[{field:"Name",order:"asc"}],fields:["Name","IsCreate","IsRead","IsUpdate","IsDelete"],columnWidths:["350px","100%","100%","100%","100%"],canCreate:!1,canDelete:!1,formMaxWidth:55,formCloseOnEscape:!0,customForm:e=>(0,a.jsx)(ew,{formBuilder:e})})})})]})})})})},eR=l(2873),eA=()=>{var e;let t=eP();return(0,a.jsx)(a.Fragment,{children:t.tables.filter(e=>"Server"===e.tableName).length>0&&!(null===(e=t.props.hiddenMenuItems)||void 0===e?void 0:e.includes("Servers"))&&(0,a.jsx)(C.O,{label:"Servers",leftSection:(0,a.jsx)(eR.Z,{size:16,strokeWidth:2,color:t.color}),onClick:()=>t.setActiveComponent({component:(0,a.jsx)(A,{tableName:"Server",orderBy:[{field:"Name",order:"ASC"}],maxResults:100,canDelete:!1,canCreate:!1,canUpdate:!1,formAppendButton:e=>(0,a.jsx)(a.Fragment,{children:"UPDATE"===e.operation&&(0,a.jsx)("div",{className:"w-full flex justify-start items-center gap-1",children:(0,a.jsx)(L,{value:e.data["".concat(e.tableName,"Id")]})})})})})})})},eS=l(4147),eD=l(8113),e_=()=>{let e=(0,s.Z)(),[t,l]=(0,d.useState)(""),i=async()=>{let t=await e.action("ADMIN_GetTypes");t.succeeded&&l(t.data)};return(0,d.useEffect)(()=>{i()},[]),(0,a.jsx)(eD.g,{styles:{root:{width:"100%",height:"100%"},input:{width:"100%",height:"100%"},wrapper:{width:"100%",height:"100%"}},readOnly:!0,value:t})},eL=()=>{var e;let t=eP();return(0,a.jsx)(a.Fragment,{children:!(null===(e=t.props.hiddenMenuItems)||void 0===e?void 0:e.includes("Development"))&&(0,a.jsx)(C.O,{label:"Development",leftSection:(0,a.jsx)(eS.Z,{size:16,strokeWidth:2,color:t.color}),onClick:()=>t.setActiveComponent({component:(0,a.jsxs)(W.m,{defaultValue:"types",styles:{root:{display:"flex",flexDirection:"column",height:"100%",flexGrow:1},panel:{display:"flex",flexDirection:"column",flexGrow:1,height:1}},children:[(0,a.jsx)(W.m.List,{children:(0,a.jsx)(W.m.Tab,{value:"types",children:"Types"})}),(0,a.jsx)(W.m.Panel,{value:"types",children:(0,a.jsx)("div",{className:"w-full h-full pt-4",children:(0,a.jsx)(e_,{})})})]})})})})};let eB={tableName:"",appendCustomForm:void 0,formAppendButton:void 0,formMaxWidth:void 0,formCloseOnCreate:void 0,formTitle:void 0,fields:void 0,filters:void 0,formFields:void 0,formLookupQueries:void 0,orderBy:void 0,refreshInterval:void 0,canCreate:void 0,canDelete:void 0,maxResults:50},eO=d.createContext(null),eP=()=>{let e=d.useContext(eO);if(!e)throw Error("useAdminDashContext must be used within a AdminDashContextProvider");return e};var ek=e=>{var t;let l=(0,s.Z)(),[c,{toggle:m}]=(0,u.q)(),[p,f]=d.useState(void 0),[h,x]=d.useState(void 0),[g,b]=d.useState([]),[N,j]=(0,u.q)(!1),[I,C]=(0,u.q)(!1),[T,R]=d.useState({canImport:!1,canExport:!1}),A=(0,E.Z)().getIconColor(),S=async()=>{let e=await l.tables();!0===e.succeeded&&b(e.data)},D=async()=>{let e=l.hasAllPermissions(["ACCESS_ADMIN_DASHBOARD"]),t=l.hasAllPermissions(["ACCESS_ADMIN_DEVELOPMENT"]),[a,s]=await Promise.all([e,t]);if(!a){f({Dashboard:!1,Development:!1});return}f({Dashboard:a,Development:s});let i=!1,o=!1;await l.hasAllPermissions(["ACTION_ADMIN_ExportDependencies","ACTION_ADMIN_ExportData"])===!0&&(i=!0),await l.hasAllPermissions(["ACTION_ADMIN_ImportData"])&&(o=!0),R({canImport:o,canExport:i})};if((0,d.useEffect)(()=>{D(),S()},[]),(null==p?void 0:p.Dashboard)===void 0)return(0,a.jsx)("div",{className:"w-full h-full flex justify-center items-center",children:(0,a.jsx)(i.a,{})});if(!p.Dashboard)return(0,a.jsx)("div",{className:"w-full h-full flex justify-center items-center",children:"You don't have permission to view this page. Please contact your system administrator."});let _=[{order:100,navLink:(0,a.jsx)(B,{})},{order:200,navLink:(0,a.jsx)(ec,{})},{order:300,navLink:(0,a.jsx)(ep,{})},{order:400,navLink:(0,a.jsx)(eT,{})},{order:500,navLink:(0,a.jsx)(ex,{})},{order:600,navLink:(0,a.jsx)(eg,{})},{order:700,navLink:(0,a.jsx)(eA,{})},...!0===p.Development?[{order:800,navLink:(0,a.jsx)(eL,{})}]:[]];void 0!==e.addMenuItems&&(_=_.concat(e.addMenuItems));let L=_.sort((e,t)=>e.order-t.order);return(0,a.jsxs)(eO.Provider,{value:{props:e,tables:g,color:A,setActiveComponent:x,emptyTableInfo:eB},children:[(0,a.jsx)(v,{opened:N,close:j.close}),(0,a.jsx)(y,{opened:I,close:C.close}),(0,a.jsxs)(o.V,{padding:"md",header:{height:60},navbar:{width:300,breakpoint:"sm",collapsed:{mobile:!c}},styles:{navbar:{overflowY:"auto"}},children:[(0,a.jsx)(o.V.Header,{children:(0,a.jsxs)("div",{className:"w-full h-full flex items-center justify-between text-xl px-2",children:[(0,a.jsxs)("div",{className:"flex pl-2",children:[(0,a.jsx)(r.O,{opened:c,onClick:m,hiddenFrom:"sm",size:"sm"}),null!==(t=e.title)&&void 0!==t?t:"Admin Dashboard"]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[!e.forceHideToggleMode&&(0,a.jsx)(w,{}),!0===T.canImport&&!e.forceHideImportData&&(0,a.jsx)(n.z,{variant:"outline",onClick:C.open,children:"Import Data"}),!0===T.canExport&&!e.forceHideExportData&&(0,a.jsx)(n.z,{onClick:j.open,children:"Export Data"})]})]})}),(0,a.jsx)(o.V.Navbar,{className:" p-2",children:L.map((e,t)=>(0,a.jsx)("span",{children:e.navLink},t))}),(0,a.jsx)(o.V.Main,{styles:{main:{width:"100%",height:"100%",display:"flex",flexDirection:"column"}},children:(0,a.jsx)("div",{className:"w-full h-1 grow",children:null!=h&&h.component})})]})]})};function eF(){return(0,a.jsx)(ek,{})}},121:function(e,t,l){"use strict";l.d(t,{BR:function(){return i},F:function(){return u},QC:function(){return d},TO:function(){return s},Vx:function(){return o},bZ:function(){return c},k0:function(){return m},ku:function(){return r},mE:function(){return a},mH:function(){return p},sy:function(){return n}});let a="/xams/WhoAmI",s="/xams/Permissions",i="/xams/MetaData",o="/xams/Create",r="/xams/Read",n="/xams/Update",d="/xams/Delete",u="/xams/Upsert",c="/xams/Bulk",m="/xams/Action",p="/xams/File"},6955:function(e,t,l){"use strict";l.r(t),l.d(t,{DataTableContext:function(){return eu},default:function(){return ep},useDataTableContext:function(){return ec}});var a=l(4246),s=l(830),i=l(7378),o=l(8521),r=l(2238),n=l(1776),d=l(2428);let u={page:1,fields:null,orderBy:null,searchField:null,searchValue:null,setData:null,active:null};var c=l(4016),m=l(2033),p=l(6974);function f(e){return null!==e}var h=()=>{var e,t,l;let s=ec(),[o,r]=(0,i.useState)({searchField:null,searchValue:null}),[n]=(0,p.c)(o.searchValue,500),d=()=>s.getFields().filter(e=>"string"==typeof e.displayName&&null!=e.metadataField).map((e,t)=>{var l,a,s,i;let o=null!==(i=null===(l=e.metadataField)||void 0===l?void 0:l.lookupName)&&void 0!==i?i:null===(a=e.metadataField)||void 0===a?void 0:a.name;return{value:"".concat(e.alias).concat(""!==e.alias?".":"").concat(o),label:null===(s=e.metadataField)||void 0===s?void 0:s.displayName}}),f=async()=>{var e,t;let l=null===(t=s.state.metadata)||void 0===t?void 0:null===(e=t.fields.find(e=>e.name===o.searchField))||void 0===e?void 0:e.type,a="";if("DateTime"===l&&(null==n?void 0:n.trim())!==""){let e=-(new Date().getTimezoneOffset()/60);a="~".concat(e)}let i=n+a,r=await s.getData({...u,page:1,searchField:o.searchField,searchValue:i,active:"Active"===s.state.activeSwitch,orderBy:s.state.data.orderBy});s.dispatch({type:"SEARCH_VALUE_CHANGE",payload:{searchValue:i,searchField:o.searchField,data:r.data}})};return(0,i.useEffect)(()=>{null!=n&&f()},[n,o.searchField]),(0,i.useEffect)(()=>{if(null!=s.props.tableName&&""!==s.props.tableName){var e,t,l;r({searchField:null!==(l=null===(t=d())||void 0===t?void 0:null===(e=t[0])||void 0===e?void 0:e.value)&&void 0!==l?l:null,searchValue:null})}},[s.props.tableName]),(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)(c.P,{placeholder:"Search",style:{width:"auto"},data:null!==(e=d())&&void 0!==e?e:[],value:null!==(t=o.searchField)&&void 0!==t?t:"",onChange:e=>{r({...o,searchField:e})}}),(0,a.jsx)(m.o,{placeholder:"Search...",style:{width:"auto"},value:null!==(l=o.searchValue)&&void 0!==l?l:"",onChange:e=>{r({...o,searchValue:e.currentTarget.value})}})]})},v=l(6426),x=l(2043),y=l(7040),g=l(4827),b=e=>{let t=(0,y.rZ)(),l=ec(),{colorScheme:s,toggleColorScheme:i}=(0,g.X)(),o="dark"===s?t.colors.gray[4]:t.colors.dark[7],n="",d="";return null!=l.state.data.orderBy&&l.state.data.orderBy.length>0&&(n=l.state.data.orderBy[0].field,d=l.state.data.orderBy[0].order),(0,a.jsx)(a.Fragment,{children:l.getFields().map((e,t)=>{if(null==e.metadataField)return(0,a.jsx)(r.i.Th,{style:{width:e.width},className:"".concat(e.width.endsWith("px")?"flex-none":""," truncate"),children:(0,a.jsx)("div",{className:"flex items-center",children:"string"==typeof e.displayName?e.displayName:e.displayName(l.refHandle)})},t);let s=e.metadataField,i=(null==s?void 0:s.lookupName)!=null?s.lookupName:s.name,u="".concat(e.alias).concat(""!==e.alias?".":"").concat(i);if(null!=s)return(0,a.jsx)(r.i.Th,{style:{width:e.width},className:"".concat(e.width.endsWith("px")?"flex-none":""," truncate"),children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("span",{className:"cursor-pointer",onClick:()=>{l.sort(u)},children:s.displayName}),n===u&&"desc"===d&&(0,a.jsx)(v.Z,{size:16,strokeWidth:2,color:o,className:" ml-2"}),n===u&&"asc"===d&&(0,a.jsx)(x.Z,{size:16,strokeWidth:2,color:o,className:"ml-2"})]})},u)})})},N=l(1835),j=e=>{let t=ec();return void 0!==e.disabledMessage?(0,a.jsx)("div",{className:"w-full h-full flex flex-col justify-center items-center",children:e.disabledMessage}):e.isLoadingData?(0,a.jsx)("div",{className:"w-full h-full flex justify-center items-center",children:(0,a.jsx)(N.a,{})}):"MISSING_READ_PERMISSIONS"===t.state.type?(0,a.jsx)("div",{className:"w-full h-full flex flex-col justify-center items-center",children:(0,a.jsxs)("div",{children:["Missing read permission for ",e.tableName,"."]})}):void 0},I=l(2045),w=l(7201),E=l(1358),C=l(3897),T=l(1816),R=l(5924),A=l(2485),S=l(121),D=l(6805);let _={getHighestPermissionLevel:e=>void 0!==e.find(e=>e.endsWith("_SYSTEM"))?"SYSTEM":void 0!==e.find(e=>e.endsWith("_TEAM"))?"TEAM":void 0!==e.find(e=>e.endsWith("_USER"))?"USER":"NONE"};var L=l(5387);let B=(0,D.Ue)()((e,t)=>({tablePermissions:[],teams:[],getTablePermissions:async(e,l)=>{let a=t().tablePermissions.find(e=>e.tableName===l);if(void 0!==a)return a.permissions;let s="".concat("TABLE_{tableName}_READ_SYSTEM, TABLE_{tableName}_READ_TEAM, TABLE_{tableName}_READ_USER".replaceAll("{tableName}",l),", ").concat("TABLE_{tableName}_CREATE_SYSTEM, TABLE_{tableName}_CREATE_TEAM, TABLE_{tableName}_CREATE_USER".replaceAll("{tableName}",l),", ").concat("TABLE_{tableName}_DELETE_SYSTEM, TABLE_{tableName}_DELETE_TEAM, TABLE_{tableName}_DELETE_USER".replaceAll("{tableName}",l),", ").concat("TABLE_{tableName}_UPDATE_SYSTEM, TABLE_{tableName}_UPDATE_TEAM, TABLE_{tableName}_UPDATE_USER".replaceAll("{tableName}",l)),i=await e.execute({url:S.TO,method:"POST",body:{method:"has_permissions",parameters:{permissionNames:s.split(",").map(e=>e.trim())}}});if((null==i?void 0:i.succeeded)===!0){let e=i.data;if(e.length>0){let t=e.filter(e=>e.startsWith("TABLE_".concat(l,"_READ"))),a=e.filter(e=>e.startsWith("TABLE_".concat(l,"_CREATE"))),s=e.filter(e=>e.startsWith("TABLE_".concat(l,"_DELETE"))),i=e.filter(e=>e.startsWith("TABLE_".concat(l,"_UPDATE")));return{read:_.getHighestPermissionLevel(t),create:_.getHighestPermissionLevel(a),delete:_.getHighestPermissionLevel(s),update:_.getHighestPermissionLevel(i)}}}return{read:"NONE",create:"NONE",delete:"NONE",update:"NONE"}},getPermissions:async(e,l)=>{let a=t().tablePermissions,s=l.filter(e=>null!=a.find(t=>t.tableName===e));if(s.length===l.length)return s;let i=await e.execute({url:S.TO,method:"POST",body:{method:"has_permissions",parameters:{permissionNames:l}}});return(null==i?void 0:i.succeeded)===!0?i.data:[]},getTeams:async l=>{var a,s;if(t().teams.length>0)return t().teams;let i=new L.ZP(["Name"]).top(99999).from("Team").join("Team.TeamId","TeamUser.TeamId","tu").join("tu.UserId","User.UserId","u").distinct().toReadRequest(),o=await l.read(i);return o.succeeded?(e({teams:null!==(a=o.data.results.map(e=>e.Name))&&void 0!==a?a:[]}),null!==(s=o.data.results.map(e=>e.Name))&&void 0!==s?s:[]):[]}}));var O=l(6127),P=l(4310),k=e=>{let t=(0,s.Z)(),l=ec(),[o,r]=i.useState(null),[n,d]=i.useState(!1),[u,m]=i.useState("create,update"),[p,f]=i.useState([]),h=async()=>{if(null===o)return;d(!0);let a=new FormData;a.append("file",o),a.append("name","TABLE_ImportData"),a.append("parameters",JSON.stringify({tableName:l.props.tableName,operation:u}));let s=await t.execute({url:S.mH,method:"POST",body:a,hideFailureMessage:!0});if((null==s?void 0:s.succeeded)===!1){let e=s.data;if(null!=e&&null!=e.errors&&e.errors.length>0)f(e.errors);else{var i;f([null!==(i=s.friendlyMessage)&&void 0!==i?i:"Unknown error"])}}else(null==s?void 0:s.succeeded)===!0&&(l.refresh(),e.close());d(!1)};return(0,i.useEffect)(()=>{!0===e.opened&&(d(!1),r(null),f([]))},[e.opened]),(0,a.jsx)(O.u,{opened:e.opened,onClose:e.close,title:"Import Data",size:"lg",closeOnEscape:!n,closeOnClickOutside:!n,withCloseButton:!n,centered:!0,styles:{overlay:{zIndex:4e3},inner:{zIndex:4001}},children:p.length>0?(0,a.jsx)("div",{className:"w-full flex flex-col gap-4 h-96",children:(0,a.jsx)("div",{className:"w-full h-full flex flex-col gap-2 overflow-y-auto",children:p.map((e,t)=>(0,a.jsx)("div",{className:"w-full bg-red-100 py-2 rounded-md",children:e},t))})}):(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)("div",{className:"w-full relative",children:[!0===n&&(0,a.jsx)("div",{className:"absolute w-full h-full flex justify-center items-center",children:(0,a.jsx)(N.a,{})}),(0,a.jsxs)("div",{className:"w-full flex flex-col gap-4 ".concat(n?"invisible":""),children:[(0,a.jsx)(c.P,{label:"Operation",placeholder:"Select Operation",data:[{value:"create,update",label:"Create and Update"},{value:"create",label:"Create Only"},{value:"update",label:"Update Only"}],value:u,onChange:e=>{m(e)}}),(0,a.jsx)(P.S,{placeholder:"Click to choose import file",label:"File Upload",required:!0,value:o,onChange:e=>{r(e)}}),(0,a.jsx)("div",{className:"w-full flex justify-end",children:(0,a.jsx)(w.z,{onClick:h,disabled:null===o,children:"Upload"})})]})]})})})},F=l(7075),U=()=>{let[e,t]=(0,i.useState)(!1),[l,o]=(0,i.useState)(void 0),r=(0,A.Z)().getIconColor(),n=(0,s.Z)(),d=ec(),u=B(),[c,m]=(0,F.q)(!1),p=async()=>{let e=await u.getPermissions(n,["TABLE_".concat(d.props.tableName,"_IMPORT"),"TABLE_".concat(d.props.tableName,"_EXPORT"),"ACTION_TABLE_ImportData","ACTION_TABLE_ExportData"]),l=await u.getTablePermissions(n,d.props.tableName),a=!1,s=!1;e.find(e=>e==="TABLE_".concat(d.props.tableName,"_IMPORT"))&&e.find(e=>"ACTION_TABLE_ImportData"===e)&&"NONE"!==l.create&&"NONE"!==l.update&&(null==d.props.canImport||d.props.canImport)&&(a=!0),e.find(e=>e==="TABLE_".concat(d.props.tableName,"_EXPORT"))&&e.find(e=>"ACTION_TABLE_ExportData"===e)&&"NONE"!==l.read&&(null==d.props.canExport||d.props.canExport)&&(s=!0),o({Import:a,Export:s}),null==d.props.disabledMessage&&(a||s)&&t(!0)},f=async()=>{await n.action("TABLE_ImportTemplate",{tableName:d.props.tableName},"ImportTemplate_".concat(d.props.tableName,".xlsx"))},h=async()=>{await n.action("TABLE_ExportData",{query:{tableName:d.props.tableName,fields:["*"],orderBy:d.props.orderBy,filters:d.props.filters,joins:d.props.joins,except:d.props.except,maxResults:999999}},"ExportData_".concat(d.props.tableName,".xlsx"))};return((0,i.useEffect)(()=>{l||p()},[l,d.state.isLoadingData]),(0,i.useEffect)(()=>{null==d.props.disabledMessage&&((null==l?void 0:l.Import)||(null==l?void 0:l.Export))&&t(!0)},[d.props.disabledMessage]),e&&null!=d.state.metadata)?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(k,{opened:c,close:m.close}),(0,a.jsxs)(I.v,{shadow:"md",width:200,children:[(0,a.jsx)(I.v.Target,{children:(0,a.jsx)(w.z,{radius:"xl",variant:"subtle",styles:{root:{padding:6}},children:(0,a.jsx)(E.Z,{size:24,strokeWidth:2,color:r})})}),(0,a.jsxs)(I.v.Dropdown,{children:[((null==l?void 0:l.Import)||(null==l?void 0:l.Export))&&(0,a.jsx)(I.v.Label,{children:"Data"}),(null==l?void 0:l.Import)&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(I.v.Item,{leftSection:(0,a.jsx)(C.Z,{size:14}),onClick:f,children:"Import Template"}),(0,a.jsx)(I.v.Item,{leftSection:(0,a.jsx)(T.Z,{size:14}),onClick:m.open,children:"Import Data"})]}),(null==l?void 0:l.Export)&&(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(I.v.Item,{leftSection:(0,a.jsx)(R.Z,{size:14}),onClick:h,children:"Export Data"})})]})]})]}):(0,a.jsx)(a.Fragment,{})},M=e=>{var t,l,s,i,c,m,p,f,v;let x=ec(),y=(0,A.Z)(),g=void 0!==x.state.metadata,N=!0===x.props.scrollable||void 0===x.props.scrollable,I=(void 0===x.props.canCreate||!0===x.props.canCreate)&&"NONE"!==x.state.permissions.create&&void 0===x.props.disabledMessage,w=null==x.props.disabledMessage&&"NONE"!==x.state.permissions.read,E=null!=x.props.customCreateButton?null===(t=(l=x.props).customCreateButton)||void 0===t?void 0:t.call(l,()=>x.openForm(void 0)):void 0,C="NONE"!==x.state.permissions.read&&void 0===x.props.disabledMessage&&(null==x.props.searchable||!0===x.props.searchable),T=!0===x.props.showActiveSwitch&&"NONE"!==x.state.permissions.read&&void 0===x.props.disabledMessage,R=!0===x.props.showOptions||null==x.props.showOptions,S=void 0!==x.props.disabledMessage||"NONE"===x.state.permissions.read||!0===x.state.isLoadingData?(0,a.jsx)(j,{tableName:x.props.tableName,permissions:x.state.permissions,isLoadingData:x.state.isLoadingData,disabledMessage:x.props.disabledMessage}):void 0,D=void 0===x.props.title||""!==x.props.title||R||T||C||I||null!=E,_=async e=>{await x.getData({...u,page:e,orderBy:x.state.data.orderBy,setData:!0}),void 0!==x.props.onPageChange&&x.props.onPageChange(e)},L=async e=>{let t=await x.getData({...u,page:1,active:"Active"===e,setData:!0,searchField:x.state.searchField,searchValue:x.state.searchValue,orderBy:x.state.data.orderBy});x.dispatch({type:"ACTIVE_SWITCH_CHANGE",payload:{activeSwitch:e,data:t.data}})};return(0,a.jsxs)("div",{className:"relative flex flex-col h-full w-full rtable",children:[void 0!==S&&(0,a.jsx)("div",{className:" absolute w-full h-full pt-11",children:(0,a.jsx)("div",{className:"w-full h-full",children:S})}),(0,a.jsxs)("div",{className:"text-lg flex justify-between items-center",children:[(0,a.jsx)("div",{className:"flex items-center",children:g?void 0!==x.props.title?x.props.title:"Manage ".concat(void 0===x.state.metadata?x.props.tableName:null===(s=x.state.metadata)||void 0===s?void 0:s.displayName,"s"):""}),(0,a.jsxs)("div",{className:"".concat(D?"flex":"hidden"," items-center gap-2"),children:[R&&(0,a.jsx)(U,{}),T&&(0,a.jsx)("div",{className:" m-2",children:(0,a.jsx)(o.s,{data:["Active","Inactive"],size:"sm",styles:{label:{paddingLeft:"0.5125rem",paddingRight:"0.5125rem",paddingTop:0,paddingBottom:0}},onChange:e=>{L(e)}})}),!0===C?(0,a.jsx)(h,{}):(0,a.jsx)("div",{className:" w-1 h-9"}),I&&null==E&&(0,a.jsx)("div",{onClick:()=>{x.openForm(void 0),null!=x.props.formOnOpen&&x.props.formOnOpen("CREATE",void 0)},className:"p-1 rounded-full w-8 h-8 flex justify-center items-center cursor-pointer",style:{backgroundColor:y.getPrimaryColor()},children:(0,a.jsx)(d.Z,{size:22,strokeWidth:2,color:"white"})}),I&&null!=E&&(0,a.jsx)("div",{children:E})]})]}),(0,a.jsxs)(r.i,{"aria-label":x.props.title,highlightOnHover:null===(p=null===(i=x.props.tableStyle)||void 0===i?void 0:i.highlighOnHover)||void 0===p||p,striped:null!==(f=null===(c=x.props.tableStyle)||void 0===c?void 0:c.striped)&&void 0!==f&&f,withColumnBorders:null!==(v=null===(m=x.props.tableStyle)||void 0===m?void 0:m.withColumnBorders)&&void 0!==v&&v,className:"".concat(N?"  overflow-x-hidden":""," flex flex-col grow"),children:[(0,a.jsx)(r.i.Thead,{className:"".concat(N?"px-2":""),children:!x.state.isLoadingData&&(0,a.jsx)(r.i.Tr,{className:"flex",children:(0,a.jsx)(b,{})})}),(0,a.jsx)(r.i.Tbody,{className:"relative overflow-x-hidden ".concat(N?"grow overflow-y-scroll pl-2 pr-0.5":""," "),children:e.children})]}),!0===w&&(0,a.jsxs)("div",{className:"w-full flex justify-between items-center mt-4 px-2",children:[(0,a.jsx)("div",{className:" text-sm",children:void 0!==x.state.data.totalResults&&x.state.data.maxResults&&x.state.data.currentPage&&(0,a.jsxs)(a.Fragment,{children:[0===x.state.data.results.length?0:x.state.data.currentPage*x.state.data.maxResults-(x.state.data.maxResults-1)," - ",x.state.data.currentPage*x.state.data.maxResults>x.state.data.totalResults?x.state.data.totalResults:x.state.data.currentPage*x.state.data.maxResults," of ",x.state.data.totalResults]})}),(null==x.props.pagination||!0===x.props.pagination)&&(0,a.jsx)(n.t,{value:x.state.data.currentPage,total:x.state.data.pages<1?1:x.state.data.pages,onChange:e=>{_(e)},size:"sm",withEdges:!0})]})]})},W=l(5968),Z=l(2237),V=l(2509);let z=()=>({type:"INSTANTIATED",tableName:void 0,data:void 0,snapshot:void 0,dirtyFields:[],validationMessages:[],metadata:void 0,canUpdate:!0,canCreate:!0,canRead:{canRead:!0,message:""},isLoading:!0,forceIsLoading:!1,isSubmitted:!1,eventListeners:[]}),H=(e,t)=>{var l,a,s;switch(console.log("FormBuilder: "+t.type),t.type){case"START_INITIAL_LOAD":return{...z(),data:t.payload.data,snapshot:void 0,metadata:e.metadata,isLoading:!0,forceIsLoading:null!==(l=t.payload.forceIsLoading)&&void 0!==l&&l,type:"START_INITIAL_LOAD"};case"INITIAL_LOAD_COMPLETE":return{...e,...t.payload,isLoading:!1,dirtyFields:[],type:"INITIAL_LOAD_COMPLETE"};case"SET_FIELD_VALUE":let i=t.payload.field;return{...e,...e.dirtyFields.includes(i)?{dirtyFields:[...e.dirtyFields]}:{dirtyFields:[...e.dirtyFields,i]},data:{...e.data,[i]:t.payload.value},type:"SET_FIELD_VALUE"};case"SET_IS_LOADING":return{...e,isLoading:!0,type:"SET_IS_LOADING"};case"SUBMIT_COMPLETE":return{...e,isLoading:!1,isSubmitted:!0,validationMessages:[],dirtyFields:[],type:"SUBMIT_COMPLETE"};case"SUBMIT_CANCELLED":return{...e,isLoading:!1,type:"SUBMIT_CANCELLED"};case"SET_VALIDATION_MESSAGES":return{...e,validationMessages:t.payload,type:"SET_VALIDATION_MESSAGES"};case"SET_VALIDATION_MESSAGE":let o=t.payload;return{...e,validationMessages:[...e.validationMessages.filter(e=>e.field!==o.field),o],type:"SET_VALIDATION_MESSAGE"};case"SET_DATA_TO_EDIT":let r=t.payload;return{...e,validationMessages:[],snapshot:t.payload.snapshot,data:t.payload.data,canUpdate:null!=t.payload.data&&(null==r.canUpdate||!1!=r.canUpdate)&&null!==(a=null==r?void 0:r.data._ui_info_.canUpdate)&&void 0!==a&&a,forceIsLoading:null!==(s=r.forceIsLoading)&&void 0!==s&&s,type:"SET_DATA_TO_EDIT"};case"CLEAR_EDIT_DATA":return{...e,type:"CLEAR_EDIT_DATA",data:e.snapshot};case"CLEAR":return{...e,type:"CLEAR",data:void 0,snapshot:void 0};case"SET_SHOW_FORCE_LOADING":return{...e,forceIsLoading:t.payload.forceIsLoading,type:"SET_SHOW_FORCE_LOADING"}}return{...e}};var G=l(8788),q=l(6052),J=()=>({get:()=>(0,G.Z)(),validate:e=>(0,q.Z)(e)}),X=e=>{var t,l;let a=(0,s.Z)(),o=B(),r=J(),n=(0,V.Z)(),d=(0,i.useRef)(null),[u,c]=(0,i.useReducer)(H,z()),[m,p]=(0,i.useState)([]),f=[],h=[],v=[],x=async t=>{if(null==e.tableName||""===e.tableName)return;if(!t.refresh){var l,s;c({type:"START_INITIAL_LOAD",payload:{tableName:e.tableName,data:null!=u.metadata?await y(u.metadata,void 0):void 0,forceIsLoading:null!==(s=null!==(l=t.forceShowLoading)&&void 0!==l?l:e.forceShowLoading)&&void 0!==s&&s}})}let i=e.metadata;null==i&&(i=await a.metadata(e.tableName));let r=e.snapshot,n=!1,d=!1,f=!1;if(null==e.snapshot&&null!=t.id||t.refresh){await a.metadata(e.tableName);let l=await a.read({tableName:e.tableName,fields:["*"],maxResults:1,page:1,id:t.refresh&&u.metadata?u.snapshot[u.metadata.primaryKey]:t.id});if(null==l||!l.succeeded)return;null==l.data.results||0===l.data.results.length?n=!0:d=(r=l.data.results[0])._ui_info_.canUpdate}null!=e.snapshot&&(d=e.snapshot._ui_info_.canUpdate);let h=await y(i,r);"NONE"!==(await o.getTablePermissions(a,e.tableName)).create&&(f=!0),null!=e.canUpdate&&!1===e.canUpdate&&(d=!1),null!=e.canCreate&&!1===e.canCreate&&(f=!1),t.refreshDatatables&&await N(),c({type:"INITIAL_LOAD_COMPLETE",payload:{metadata:i,snapshot:r,data:h,canUpdate:d,canCreate:f,canRead:{canRead:!n,message:n?"This record doesn't exist or you are missing the required permissions to access ".concat(e.tableName):""}}}),m.length>0&&(b(m.pop()),p([]))},y=async(t,l)=>{if(void 0!==t){if(void 0===l){var a;return{...await g(t),...null===(a=e.defaults)||void 0===a?void 0:a.reduce((e,t)=>({...e,[t.field]:t.value}),{})}}if(null!=l){let e=Object.keys(l).reduce((e,a)=>(null!==l[a]&&(void 0!==t.fields.find(e=>e.name===a)||["_ui_info_"].includes(a)||a===t.primaryKey)&&(e[a]=l[a]),e),{});return{...await g(t),...e}}}},g=async t=>{var l,s;let i=t.fields.filter(e=>["Single","Int32","Int64","Double","Decimal","Byte","SByte","UInt32","UInt64","Int16","UInt16"].includes(e.type)).map(e=>({field:e.name,value:e.isNullable?"":0})),o=null==t?void 0:t.fields.filter(e=>["String","Guid","Char"].includes(e.type)).map(e=>({field:e.name,value:"Char"!==e.type||e.isNullable?"":"A"})),r=null==t?void 0:t.fields.filter(e=>"Boolean"===e.type).map(e=>({field:e.name,value:!1})),d=new Date;d.setUTCHours(0,0,0,0);let u=null==t?void 0:t.fields.filter(e=>"DateTime"===e.type).map(e=>({field:e.name,value:e.isNullable?null:d.toISOString()})),c=null==t?void 0:t.fields.filter(e=>"Lookup"===e.type).map(t=>{var l,a,s;return{field:t.name,value:null!==(s=null===(a=e.defaults)||void 0===a?void 0:null===(l=a.find(e=>e.field===t.name))||void 0===l?void 0:l.value)&&void 0!==s?s:null}});for(let i of null!==(l=t.fields)&&void 0!==l?l:[])if("Lookup"===i.type&&void 0!==e.defaults)for(let t of null!==(s=e.defaults)&&void 0!==s?s:[])t.field===i.name&&await n.getLookupLabel(a,i.name,i.lookupTable,i.lookupTableNameField,t.value);return{...null==i?void 0:i.reduce((e,t)=>({...e,[t.field]:t.value}),{}),...null==o?void 0:o.reduce((e,t)=>({...e,[t.field]:t.value}),{}),...null==r?void 0:r.reduce((e,t)=>({...e,[t.field]:t.value}),{}),...null==u?void 0:u.reduce((e,t)=>({...e,[t.field]:t.value}),{}),...null==c?void 0:c.reduce((e,t)=>({...e,[t.field]:t.value}),{}),_ui_info_:{canUpdate:!0,canDelete:!0}}},b=async(t,l)=>{void 0!==u.metadata?c({type:"SET_DATA_TO_EDIT",payload:{data:await y(u.metadata,t),snapshot:t,...null!=e.canUpdate?{canUpdate:e.canUpdate}:{},forceIsLoading:null!=l&&l}}):p(e=>[...e,t])},N=()=>{for(let e of f)e.refresh()},j=async(t,l,s)=>{var i;let o={...u.data},r={};if(null!=t){let e=await t(o);if(!e.continue)return;r={...r,...e.parameters}}if(!w())return;if(c({type:"SET_IS_LOADING"}),null!=e.onPreSave){let t=await e.onPreSave(o);if(!1===t.continue){c({type:"SUBMIT_CANCELLED"});return}r={...r,...t.parameters}}for(let e of h)if("PRE_SAVE"===e.eventName&&!1===await e.callback(o,r)){c({type:"SUBMIT_CANCELLED"});return}if(null!=l){let e=await l(o);if(!1===e.continue){c({type:"SUBMIT_CANCELLED"});return}r={...r,...e.parameters}}let n=await a.execute({url:void 0===u.snapshot?S.Vx:S.sy,method:void 0===u.snapshot?"POST":"PATCH",body:{tableName:null===(i=u.metadata)||void 0===i?void 0:i.tableName,fields:o,parameters:r}});if((null==n?void 0:n.succeeded)===!0){for(let t of(void 0!==e.onPostSave&&await e.onPostSave(void 0===u.snapshot?"CREATE":"UPDATE",u.metadata?n.data[u.metadata.primaryKey]:"",n.data),h))"POST_SAVE"===t.eventName&&t.callback(void 0===u.snapshot?"CREATE":"UPDATE",u.metadata?n.data[u.metadata.primaryKey]:"",n.data);null!=s&&s(void 0===u.snapshot?"CREATE":"UPDATE",u.metadata?n.data[u.metadata.primaryKey]:"",n.data)}else{for(let t of(void 0!==e.onPostSave&&await e.onPostSave("FAILED","",{}),h))"POST_SAVE"===t.eventName&&t.callback("FAILED","",{});null!=s&&s("FAILED","",{})}c({type:"SUBMIT_COMPLETE"}),N()},I=async e=>{var t;return(await a.execute({url:void 0===u.snapshot?S.Vx:S.sy,method:void 0===u.snapshot?"POST":"PATCH",body:{tableName:null===(t=u.metadata)||void 0===t?void 0:t.tableName,fields:u.data,parameters:e}})).data},w=()=>{var e,t;let l=[];for(let a of null!==(t=null===(e=u.metadata)||void 0===e?void 0:e.fields)&&void 0!==t?t:[]){let e=u.data[a.name];if(!["CreatedById","UpdatedById"].includes(a.name)){if(["Single","Int32","Int64","Double","Decimal"].includes(a.type)&&("-"===e||"."===e)){let t='"'.concat(e,'" is not a valid number');l.push({field:a.name,message:t})}if(("Lookup"===a.type||"DateTime"===a.type)&&(!1===a.isNullable||a.isRequired||v.includes(a.name))&&null==e){let e="".concat(a.displayName," is required");l.push({field:a.name,message:e}),console.warn(e)}if((!0===a.isRequired||v.includes(a.name))&&(null==e||""===e)){let e="".concat(a.displayName," is required");l.push({field:a.name,message:e}),console.warn(e)}if("Guid"===a.type&&""!==e&&!r.validate(e)){let e="".concat(a.displayName," is not a valid Id");l.push({field:a.name,message:e}),console.warn(e)}}}return!(l.length>0)||(c({type:"SET_VALIDATION_MESSAGES",payload:l}),!1)},E=async(e,t)=>{await x({id:e,refresh:!1,refreshDatatables:!0,forceShowLoading:t})};return(0,i.useEffect)(()=>{null!=e.tableName&&""!==e.tableName&&x({id:e.id,refresh:!1,refreshDatatables:!1})},[e.tableName,e.id]),(0,i.useEffect)(()=>{u.snapshot!=e.snapshot&&b(e.snapshot)},[e.snapshot]),(0,i.useEffect)(()=>{m.length>0&&"INITIAL_LOAD_COMPLETE"===u.type&&(b(m.pop()),p([]))},[u.type,m]),{metadata:u.metadata,dispatch:c,data:u.data,snapshot:u.snapshot,setSnapshot:b,firstInputRef:d,lookupExclusions:null!==(t=e.lookupExclusions)&&void 0!==t?t:[],lookupQueries:null!==(l=e.lookupQueries)&&void 0!==l?l:[],canUpdate:u.canUpdate,canCreate:u.canCreate,canRead:u.canRead,defaults:e.defaults,validationMessages:u.validationMessages,isLoading:u.isLoading||u.forceIsLoading,isSubmitted:u.isSubmitted,operation:null!=e.snapshot||null!=u.snapshot?"UPDATE":"CREATE",stateType:u.type,tableName:e.tableName,reload:async function(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];u.metadata&&u.snapshot&&await x({id:u.snapshot[u.metadata.primaryKey],refresh:!0,refreshDatatables:e})},setField:(e,t)=>{var l;let a=null===(l=u.metadata)||void 0===l?void 0:l.fields.find(t=>t.name===e);if(null==a)throw Error("Field ".concat(e," doesn't exist on ").concat(u.tableName));if(!a.isNullable&&null===t)throw Error("Field ".concat(e," cannot be null"));c({type:"SET_FIELD_VALUE",payload:{field:e,value:t}})},setFieldError:(e,t)=>{c({type:"SET_VALIDATION_MESSAGE",payload:{field:e,message:t}})},isDirty:e=>null==e?u.dirtyFields.length>0:u.dirtyFields.includes(e),addDataTable:e=>{null!=f.find(t=>t.dataTableId===e.dataTableId)&&(f=f.filter(t=>t.dataTableId!==e.dataTableId)),f.push(e)},addRequiredField:e=>{v.includes(e)||v.push(e)},removeRequiredField:e=>{v=v.filter(t=>t!==e)},reloadDataTables:N,save:j,saveSilent:I,load:E,on:(e,t)=>{h.push({eventName:e,callback:t})},clearEdits:()=>{c({type:"CLEAR_EDIT_DATA"})},clear:()=>{c({type:"CLEAR"})},validate:w,setShowForceLoading:e=>{c({type:"SET_FORCE_LOADING",payload:{forceIsLoading:e}})}}},Y=l(8993),K=l(7108),Q=e=>{let t=(()=>{if(!0===e.formBuilder.isLoading)return!0;if(void 0!==e.formBuilder&&void 0!==e.formBuilder.metadata&&void 0!==e.formBuilder.data){for(let t of e.formBuilder.metadata.fields)if(void 0===e.formBuilder.data[t.name])return console.warn("No data for field: "+t.name+". Ensure lookup fields are spelled correctly."),!0}return!1})()||!0===e.showLoading;return(0,a.jsx)(K.ZP,{formBuilder:e.formBuilder,children:(0,a.jsxs)("div",{className:"".concat(!t&&!0!==e.showLoading&&e.formBuilder.canRead.canRead&&e.formBuilder.canCreate?"":"relative overflow-hidden"," ").concat(e.className),children:[t&&(0,a.jsx)("div",{className:"absolute w-full h-full flex justify-center items-center",style:{zIndex:4e3},children:(0,a.jsx)(N.a,{})}),!t&&!1===e.formBuilder.canRead.canRead&&(0,a.jsx)("div",{className:"absolute w-full h-full flex justify-center items-center text-center",style:{zIndex:10},children:e.formBuilder.canRead.message}),!t&&"CREATE"===e.formBuilder.operation&&!1===e.formBuilder.canCreate&&(0,a.jsx)("div",{className:"absolute w-full h-full flex justify-center items-center text-center",style:{zIndex:10},children:"This record doesn't exist or you are missing the required permissions to create ".concat(e.formBuilder.tableName)}),(0,a.jsx)("div",{className:"".concat(t||!1===e.formBuilder.canRead.canRead||"CREATE"===e.formBuilder.operation&&!1===e.formBuilder.canCreate?"invisible":""," ").concat(e.className),children:e.children})]})})};let $=(0,i.forwardRef)((e,t)=>{var l,s,o;let r=ec(),n=X({tableName:null!==(s=null===(l=r.state.metadata)||void 0===l?void 0:l.tableName)&&void 0!==s?s:"",id:r.state.editRecordId,metadata:r.state.metadata,defaults:r.props.formFieldDefaults,lookupExclusions:r.props.formLookupExclusions,lookupQueries:r.props.formLookupQueries,canCreate:"NONE"!==r.state.permissions.create,canUpdate:r.props.canUpdate,onPreSave:async e=>(!0===r.props.formCloseOnCreate||r.props.formCloseOnCreate,null!=r.props.formOnPreSave&&r.props.formOnPreSave(e),{continue:!0}),onPostSave:async(e,t,l)=>{if("FAILED"===e);else if("CREATE"===e&&!1===r.props.formCloseOnCreate&&n.setSnapshot(l),"UPDATE"===e&&!1===r.props.formCloseOnUpdate&&n.setSnapshot(l),null!=r.props.formOnPostSave&&r.props.formOnPostSave(e,n.data),"CREATE"===e&&(!0===r.props.formCloseOnCreate||void 0===r.props.formCloseOnCreate)||"UPDATE"===e&&(!0===r.props.formCloseOnUpdate||void 0===r.props.formCloseOnUpdate)){var a,s;r.closeForm(),r.getData({...u,page:null===(a=r.state.data)||void 0===a?void 0:a.currentPage,orderBy:null===(s=r.state.data)||void 0===s?void 0:s.orderBy,setData:!0})}}}),d=()=>{if(void 0!==r.state.metadata){let e=r.state.metadata.fields.filter(e=>void 0===r.props.formFields||r.props.formFields.includes(e.name));if(e.length<=3)return 12/e.length}return 4};(0,i.useImperativeHandle)(t,()=>({formBuilder:n}));let c=!0!==r.props.formHideSaveButton&&(void 0!==n.snapshot&&!0===n.canUpdate||void 0===n.snapshot&&!0===n.canCreate);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(O.u,{opened:"START_INITIAL_LOAD"===n.stateType,onClose:()=>{},withCloseButton:!1,size:"auto",closeOnClickOutside:!1,closeOnEscape:!1,overlayProps:{blur:3},styles:{content:{display:"none"}},centered:!0}),(0,a.jsx)(O.u,{title:(()=>{var e;if(null!=r.props.formTitle)return r.props.formTitle;let t="";"UPDATE"===n.operation&&null!=n.data&&!0===n.data._ui_info_.canUpdate&&(t="Edit"),"CREATE"===n.operation&&"NONE"!==r.state.permissions.create&&(t="Create");let l=void 0===r.state.metadata?r.props.tableName:null===(e=r.state.metadata)||void 0===e?void 0:e.displayName;return""!==t?"".concat(t," ").concat(l):l})(),opened:r.formDisclosure.opened&&null!=n.metadata&&"START_INITIAL_LOAD"!==n.stateType,onClose:()=>{if(null!=r.props.formOnClose&&r.props.formOnClose(),n.isSubmitted){var e,t;r.closeForm(),r.getData({...u,page:null===(e=r.state.data)||void 0===e?void 0:e.currentPage,orderBy:null===(t=r.state.data)||void 0===t?void 0:t.orderBy,setData:!0})}else r.formDisclosure.close()},transitionProps:{transition:"fade",duration:100},closeOnClickOutside:!1,closeOnEscape:null===(o=r.props.formCloseOnEscape)||void 0===o||o,size:(()=>{if(null!=r.props.formMaxWidth)return"".concat(r.props.formMaxWidth,"rem");if(void 0!==r.state.metadata){let e=r.state.metadata.fields.filter(e=>void 0===r.props.formFields||r.props.formFields.includes(e.name));if(e.length<=3){let t=e.length/3*72;return void 0!==r.props.formMaxWidth&&t<r.props.formMaxWidth?"".concat(r.props.formMaxWidth,"rem"):"".concat(t,"rem")}}return void 0!==r.props.formMaxWidth&&r.props.formMaxWidth>72?"".concat(r.props.formMaxWidth,"rem"):"72rem"})(),overlayProps:{blur:3},styles:{root:{overflow:"visible"},body:{...!0===n.isLoading&&{position:"relative",overflow:"hidden",paddingLeft:0,paddingRight:0}}},centered:!0,children:(0,a.jsxs)(Q,{formBuilder:n,children:[void 0!==r.props.customForm?r.props.customForm(n,r.formDisclosure):void 0!==r.state.metadata&&(void 0!==r.props.formFields?r.props.formFields:r.state.metadata.fields).map((e,t)=>{if(t%3==0){var l,s;return(0,a.jsx)(W.r,{children:void 0!==r.state.metadata&&(null===(l=void 0!==r.props.formFields?r.props.formFields:null===(s=r.state.metadata)||void 0===s?void 0:s.fields.map(e=>e.name))||void 0===l?void 0:l.slice(t,t+3).map((e,l)=>{var s;let i=null===(s=r.state.metadata)||void 0===s?void 0:s.fields.find(t=>t.name===e);return void 0===i?("function"!=typeof e&&"object"!=typeof e&&console.warn("Couldn't find field named ".concat(e,".")),(0,a.jsx)("div",{className:"hidden"},"".concat(t).concat(l))):("function"==typeof e&&"".concat(t).concat(l),(0,a.jsx)(W.r.Col,{span:d(),children:(0,a.jsx)(Z.Z,{focus:0===t&&0===l,name:i.name})},"".concat(i.name).concat(t).concat(l,"}")))}))},t)}return(0,a.jsx)("div",{className:"hidden"},t)}),void 0!==r.props.appendCustomForm?(0,a.jsx)("div",{className:"mt-2",children:r.props.appendCustomForm(n)}):(0,a.jsx)(a.Fragment,{}),null==r.props.customForm&&(0,a.jsxs)("div",{className:"w-full flex justify-end ".concat(null!=r.props.formAppendButton||c?"mt-3":""),children:[null!=r.props.formAppendButton?(0,a.jsx)(a.Fragment,{children:r.props.formAppendButton(n)}):(0,a.jsx)(a.Fragment,{}),!0!==r.props.formHideSaveButton&&(void 0!==n.snapshot&&!0===n.canUpdate||void 0===n.snapshot&&!0===n.canCreate)?(0,a.jsx)("div",{children:(0,a.jsx)(Y.Z,{})}):(0,a.jsx)(a.Fragment,{})]})]})})]})});$.displayName="DataForm";let ee={type:"START_INITIAL_LOAD",id:"",isLoadingData:!0,permissions:{read:"NONE",create:"NONE",delete:"NONE",update:"NONE"},isTableNotFound:!1,isFormOpen:!1,metadata:void 0,joinMetadata:[],data:{pages:0,currentPage:1,totalResults:0,orderBy:[],tableName:"",maxResults:10,results:[]},searchField:"",searchValue:"",activeSwitch:null,editRecordId:null},et=(e,t)=>{switch(console.log("DataTable: "+t.type),t.type){case"START_INITIAL_LOAD":return{...ee,isLoadingData:!0,type:"START_INITIAL_LOAD"};case"MISSING_READ_PERMISSIONS":return{...ee,isLoadingData:!1,permissions:{...e.permissions,read:"NONE"},type:"MISSING_READ_PERMISSIONS"};case"TABLE_NOT_FOUND":return{...ee,isLoadingData:!1,isTableNotFound:!0,type:"TABLE_NOT_FOUND"};case"INITIAL_LOAD_COMPLETE":return{...ee,...t.payload,editRecordId:e.editRecordId,type:e.editRecordId?"OPEN_FORM":"INITIAL_LOAD_COMPLETE"};case"SET_IS_LOADING":return{...e,isLoadingData:!0,type:"SET_IS_LOADING"};case"SET_DONE_LOADING":return{...e,isLoadingData:!1,data:t.payload,type:"SET_DONE_LOADING"};case"SEARCH_VALUE_CHANGE":return{...e,searchValue:t.payload.searchValue,searchField:t.payload.searchField,data:t.payload.data,type:"SEARCH_VALUE_CHANGE"};case"ACTIVE_SWITCH_CHANGE":return{...e,activeSwitch:t.payload.activeSwitch,type:"ACTIVE_SWITCH_CHANGE"};case"SET_METADATA":return{...e,metadata:t.payload.metadata,joinMetadata:t.payload.joinMetadata,type:"SET_METADATA"};case"SET_DATA":return{...e,data:{...e.data,results:t.payload.setDataFunction(e.data.results)},type:"SET_DATA"};case"OPEN_FORM":var l;return{...e,isFormOpen:!0,editRecordId:t.payload.editRecordId,formTableName:null===(l=e.metadata)||void 0===l?void 0:l.tableName,type:"OPEN_FORM"};case"CLOSE_FORM":return{...e,isFormOpen:!1,editRecordId:void 0,formTableName:void 0,type:"CLOSE_FORM"}}return{...e,...t.payload}};var el=l(1869),ea=l(5188),es=l(7303),ei=l(7290),eo=l(7693),er=l.n(eo),en=e=>{var t,l,o,n;let d;let u=(0,s.Z)(),c=(0,i.useContext)(el.Il),m=ec(),p=(0,y.rZ)(),{colorScheme:f,toggleColorScheme:h}=(0,g.X)(),v=null!=e.record.IsActive&&!0===e.record.IsActive,x="dark"===f?p.colors[p.primaryColor][p.primaryShade-3]:p.colors[p.primaryColor][p.primaryShade],b=async e=>{var t,l,a,s;let i=e[null!==(l=null===(t=m.state.metadata)||void 0===t?void 0:t.primaryKey)&&void 0!==l?l:""];if("Delete"===m.props.deleteBehavior||null==m.props.deleteBehavior){if(void 0===m.props.confirmDelete||!0===m.props.confirmDelete){let t="Confirm",l="Are you sure you want to delete this record?",o=!0;if(null!=m.props.deleteConfirmation){let i=await m.props.deleteConfirmation(e);t=null!==(a=i.title)&&void 0!==a?a:t,l=null!==(s=i.message)&&void 0!==s?s:l,o=void 0===i.showPrompt||i.showPrompt}o?null==c||c.showConfirm(l,async()=>{await j(e,m.props.tableName,i)},()=>{},t):await j(e,m.props.tableName,i)}else await j(e,m.props.tableName,i)}"Deactivate"===m.props.deleteBehavior&&N(m.props.tableName,i,!v)},N=async(e,t,l)=>{m.dispatch({type:"SET_IS_LOADING"}),await u.update(e,{["".concat(m.props.tableName,"Id")]:t,IsActive:l}),await m.refresh()},j=async(e,t,l)=>{m.dispatch({type:"SET_IS_LOADING"}),await u.delete(t,l),null!=m.props.onPostDelete&&m.props.onPostDelete(e),await m.refresh()},I="";if(null!=e.fieldInfo.metadataField){let t="".concat(e.fieldInfo.alias).concat(""!==e.fieldInfo.alias?".":"").concat(e.fieldInfo.metadataField.name);void 0!==e.record[e.fieldInfo.metadataField.lookupName]?I=e.record[e.fieldInfo.metadataField.lookupName]:void 0!==e.record[t]&&(I=((t,l)=>{if("Boolean"===t)return l?"Yes":"No";if("DateTime"===t){var a;if(null==l||"0001-01-01T00:00:00"===l)return"";if((null===(a=e.fieldInfo.metadataField)||void 0===a?void 0:a.dateFormat)!=null)return er()(Date.parse(l)).format(e.fieldInfo.metadataField.dateFormat);let t=new Date(l.replace("Z","")),s=String(t.getMonth()+1).padStart(2,"0"),i=String(t.getDate()).padStart(2,"0"),o=t.getFullYear();return"".concat(s,"/").concat(i,"/").concat(o)}return l})(e.fieldInfo.metadataField.type,e.record[t]))}return(0,a.jsxs)(r.i.Td,{className:"".concat((null===(t=m.props.tableStyle)||void 0===t?void 0:t.truncate)===!0||(null===(l=m.props.tableStyle)||void 0===l?void 0:l.truncate)==null?"truncate":""," cursor-pointer relative ").concat(e.fieldInfo.width.endsWith("px")?"flex-none":""),style:{width:e.fieldInfo.width,height:(null===(o=m.props.tableStyle)||void 0===o?void 0:o.truncate)===!0||(null===(n=m.props.tableStyle)||void 0===n?void 0:n.truncate)==null?"36.7px":""},children:[null!=e.fieldInfo.body?e.fieldInfo.body(e.record,m.refHandle):I,!0===e.record._ui_info_.canDelete&&(void 0===m.props.canDelete||!0===m.props.canDelete)&&(d=e.record,(0,a.jsx)("div",{onClick:e=>{e.stopPropagation(),b(d)},className:"absolute right-0 top-0 bottom-0 flex items-center cursor-pointer xams_delete",children:(0,a.jsx)("div",{className:"flex items-center p-0.5 rounded",style:{backgroundColor:"dark"===f?p.colors.gray[p.primaryShade+2]:p.colors.gray[p.primaryShade-5]},children:null==m.props.deleteBehavior||"Delete"===m.props.deleteBehavior?(0,a.jsx)(ea.Z,{size:26,strokeWidth:2,color:x}):v?(0,a.jsx)(es.Z,{size:26,strokeWidth:2,color:x}):(0,a.jsx)(ei.Z,{size:26,strokeWidth:2,color:x})})}))]})},ed=()=>{var e;let t=ec();return(0,a.jsx)(a.Fragment,{children:!1===t.state.isLoadingData&&(null===(e=t.state.data)||void 0===e?void 0:e.results)!=null&&t.state.data.results.filter(e=>{var l;return t.props.tableName===(null===(l=t.state.metadata)||void 0===l?void 0:l.tableName)}).map((e,l)=>void 0!==t.props.customRow?(0,a.jsx)(r.i.Tr,{className:"w-full",children:t.props.customRow(e)},t.state.metadata?e[t.state.metadata.primaryKey]:l):(0,a.jsx)(r.i.Tr,{className:"flex relative items-start",onClick:()=>{t.openForm(e),null!=t.props.formOnOpen&&t.props.formOnOpen("UPDATE",e)},children:t.getFields().map((s,i)=>{let o="".concat(t.state.metadata?e[t.state.metadata.primaryKey]:l,"-").concat(i);return(0,a.jsx)(en,{record:e,fieldInfo:s},o)})},t.state.metadata?e[t.state.metadata.primaryKey]:l))})};let eu=i.createContext(null),ec=()=>{let e=i.useContext(eu);if(null==e)throw Error("useDataTableContext must be used within a DataTableContextProvider");return e},em=(0,i.forwardRef)((e,t)=>{let l=(0,s.Z)(),o=(0,i.useContext)(K.q3),r=B(),n=J(),d=(0,i.useRef)(null),[c,m]=(0,i.useState)(n.get()),[p,h]=(0,i.useReducer)(et,{...ee,id:c}),v=(0,i.useRef)(!1),x=(0,i.useRef)(p);if(null!=e.fields&&null!=e.columnWidths&&e.fields.length!==e.columnWidths.length)throw Error("Fields and columnWidths must be the same length in DataTable");let y=async()=>{var t;h({type:"START_INITIAL_LOAD"});let a=null!=p.metadata&&p.metadata.tableName===e.tableName?p.metadata:await l.metadata(e.tableName),s=[];if(null!=e.joins)for(let t of e.joins){let e=await l.metadata(t.toTable);null!=e&&s.push(e)}if(null==a){h({type:"TABLE_NOT_FOUND"});return}if(e.disabledMessage){h({type:"SET_METADATA",payload:{metadata:a,joinMetadata:s}});return}let i=await r.getTablePermissions(l,e.tableName);if("NONE"===i.read){h({type:"MISSING_READ_PERMISSIONS"});return}let o=null!==(t=e.fields)&&void 0!==t?t:a.fields.map(e=>e.name).slice(0,7),n=await b({...u,metadata:a,joinMetadata:s,fields:o,page:1,active:!0===e.showActiveSwitch||null,orderBy:e.orderBy,searchField:"",searchValue:""});(null==n?void 0:n.succeeded)&&(g(a),null!=e.onInitialLoad&&e.onInitialLoad(n.data.results),h({type:"INITIAL_LOAD_COMPLETE",payload:{permissions:i,metadata:a,joinMetadata:s,data:n.data,isLoadingData:!1,activeSwitch:!0===e.showActiveSwitch?"Active":null}}))},g=t=>{void 0!==e.fields&&e.fields.forEach(l=>{"function"!=typeof l&&(void 0!==t.fields.find(e=>e.name===l)||l===e.tableName+"Id"||"object"==typeof l||l.includes(".")||console.warn("Field ".concat(l," not found in metadata for table ").concat(e.tableName)))})},b=async t=>{var a,s,i,o,r,n,d,u,c,m,f,v,x,y;(null==t?void 0:t.setData)!=null&&!0===t.setData&&!1===p.isLoadingData&&(null==t.showLoading||!0===t.showLoading)&&h({type:"SET_IS_LOADING"});let g=null!==(r=null!==(o=null==t?void 0:t.metadata)&&void 0!==o?o:p.metadata)&&void 0!==r?r:await l.metadata(e.tableName),b=null!==(d=null!==(n=null===(a=e.fields)||void 0===a?void 0:a.filter(e=>"string"==typeof e&&!e.includes(".")))&&void 0!==n?n:null==t?void 0:null===(s=t.fields)||void 0===s?void 0:s.filter(e=>"string"==typeof e&&!e.includes(".")))&&void 0!==d?d:null==g?void 0:g.fields.map(e=>e.name).slice(0,7),N=[];if(null==b||b.forEach(e=>{if(e.endsWith("Id")){let t=null==g?void 0:g.fields.find(t=>t.name===e);(null==t?void 0:t.type)==="Lookup"&&void 0===b.find(e=>e===t.lookupName)&&N.push(t.lookupName)}}),null==b||b.push(...N),null!=e.additionalFields)for(let t of e.additionalFields)void 0===b.find(e=>e===t)&&b.push(t);g&&(null==b?void 0:b.find(e=>e===g.primaryKey))===void 0&&(null==b||b.push(g.primaryKey)),"Deactivate"===e.deleteBehavior&&void 0===b.find(e=>"IsActive"===e)&&b.push("IsActive");let j=await l.read({tableName:e.tableName,page:null==t?1:t.page,fields:b,maxResults:null!==(u=e.maxResults)&&void 0!==u?u:10,except:e.except,orderBy:null!==(m=null!==(c=null==t?void 0:t.orderBy)&&void 0!==c?c:null===(i=p.data)||void 0===i?void 0:i.orderBy)&&void 0!==m?m:[],filters:[{field:null==t?"":null!==(v=null!==(f=t.searchField)&&void 0!==f?f:p.searchField)&&void 0!==v?v:"",value:null==t?"":null!==(y=null!==(x=t.searchValue)&&void 0!==x?x:p.searchValue)&&void 0!==y?y:""},...!0===e.showActiveSwitch?[{field:"IsActive",operator:"==",value:(null==t?void 0:t.active)!=null?null==t?void 0:t.active.toString():"true"}]:[],...void 0!==e.filters?e.filters.map(e=>({field:e.field,operator:e.operator,value:e.value})):[]],joins:void 0!==e.joins?e.joins:[]});return(null==t?void 0:t.setData)!=null&&!0===t.setData&&h({type:"SET_DONE_LOADING",payload:j.data}),null!=e.onDataLoaded&&e.onDataLoaded(j.data),j},N=async t=>{if(null==e.disabledMessage){var l,a;let s=null===(l=p.data)||void 0===l?void 0:l.orderBy;(null==s||0===s.length)&&(s=null!==(a=e.orderBy)&&void 0!==a?a:[]),await b({...u,page:x.current.data.currentPage,showLoading:t,searchField:x.current.searchField,searchValue:x.current.searchValue,orderBy:s,active:"Active"===x.current.activeSwitch,setData:!0})}},j=t=>null!=e.columnWidths&&e.columnWidths.length>=t?e.columnWidths[t]:"100%",I=function(t){let l=!(arguments.length>1)||void 0===arguments[1]||arguments[1];(void 0===e.onRowClick||!0!==l||!1!==e.onRowClick(t))&&h({type:"OPEN_FORM",payload:{editRecordId:null!=t&&p.metadata?t[p.metadata.primaryKey]:null}})},w=()=>{h({type:"CLOSE_FORM"})},E=async e=>{null!=p.data.orderBy&&p.data.orderBy.length>0&&p.data.orderBy[0].field===e&&"asc"===p.data.orderBy[0].order?b({...u,page:p.data.currentPage,orderBy:[{field:e,order:"desc"}],setData:!0}):b({...u,page:p.data.currentPage,orderBy:[{field:e,order:"asc"}],setData:!0})};(0,i.useEffect)(()=>{x.current=p},[p.data]),(0,i.useEffect)(()=>{void 0!==e.tableName&&y()},[e.tableName,e.disabledMessage]),(0,i.useEffect)(()=>{if(null!=e.refreshInterval){let t=setInterval(async()=>{!1===v.current&&(v.current=!0,await N(!1),v.current=!1)},e.refreshInterval);return()=>{v.current=!1,clearInterval(t)}}},[e.refreshInterval]);let C={refresh:N,openForm:e=>I(e,!1),dataTableId:c,getRecords:()=>{var e;return null===(e=p.data)||void 0===e?void 0:e.results},setRecords:e=>{h({type:"SET_DATA",payload:{setDataFunction:e}})},showLoading:()=>{h({type:"SET_IS_LOADING"})},sort:E};return(null!=o&&o.formBuilder.addDataTable(C),(0,i.useImperativeHandle)(t,()=>C),!0===p.isTableNotFound)?(0,a.jsx)("div",{className:"w-full h-full flex justify-center items-center",children:"Table not found."}):(0,a.jsxs)(eu.Provider,{value:{props:e,state:p,refHandle:C,dispatch:h,openForm:I,closeForm:w,refresh:N,formDisclosure:{opened:p.isFormOpen,close:w},getData:b,getFields:()=>{if(null!=e.fields&&null!=p.metadata)return e.fields.map((t,l)=>{if("string"==typeof t){let s=t,i=p.metadata,o="";if(t.includes(".")){var a;let l=t.split(".");o=l[0],s=l[1];let r=null===(a=e.joins)||void 0===a?void 0:a.find(e=>e.alias===o);null!=r&&(i=p.joinMetadata.find(e=>e.tableName===r.toTable))}let r=null==i?void 0:i.fields.find(e=>e.name===s);return null==r?null:{displayName:s,metadataField:r,body:null,width:j(l),alias:o}}return"object"==typeof t?{displayName:t.header,body:t.body,width:j(l),alias:""}:null}).filter(f);if(null==e.fields&&null!=p.metadata){var t;return null===(t=p.metadata)||void 0===t?void 0:t.fields.map((e,t)=>t<=6?{displayName:e.name,metadataField:e,body:null,width:j(t),alias:""}:null).filter(f)}return[]},sort:E},children:[p.isFormOpen&&(0,a.jsx)($,{ref:d}),p.data&&(0,a.jsx)(M,{children:(0,a.jsx)(ed,{})})]})});em.displayName="DataTable";var ep=em},2237:function(e,t,l){"use strict";l.d(t,{Z:function(){return S}});var a=l(4246),s=l(7378),i=l(5208),o=l(8113),r=l(2033),n=l(4188),d=l(2325),u=l(2509),c=l(7108),m=l(830),p=l(1487),f=l(149),h=l(4016),v=l(6974);let x=e=>{let{option:t,checked:l}=e;return(0,a.jsx)(p.Z,{flex:"1",gap:"xs",children:(0,a.jsxs)("div",{children:[(0,a.jsx)(f.x,{size:"sm",children:t.label}),(0,a.jsx)(f.x,{size:"xs",opacity:.65,children:t.description})]})})},y=(0,s.forwardRef)((e,t)=>{let l=(0,s.useRef)(null),i=(0,m.Z)(),[o,r]=(0,s.useState)(void 0!==e.defaultLabelValue?e.defaultLabelValue:null),[n,d]=(0,s.useState)(void 0!==e.defaultLabelValue?[e.defaultLabelValue]:[]),[u,c]=s.useState(null),[p]=(0,v.c)(u,300,{leading:!0});(0,s.useImperativeHandle)(t,()=>l.current);let f=async()=>{var t,l,a,s,r,n,u;let c=[e.metaDataField.lookupPrimaryKeyField];null!=e.metaDataField.lookupTableNameField&&c.push(e.metaDataField.lookupTableNameField),null!=e.metaDataField.lookupTableDescriptionField&&c.push(e.metaDataField.lookupTableDescriptionField),""!==e.metaDataField.option&&c.push("Value");let m=await i.read({tableName:e.metaDataField.lookupTable,maxResults:20,page:1,fields:c,orderBy:[...""!==e.metaDataField.option?[{field:"Order",order:"asc"}]:[],{field:null!==(r=e.metaDataField.lookupTableNameField)&&void 0!==r?r:e.metaDataField.lookupPrimaryKeyField,order:null===(t=e.query)||void 0===t?void 0:t.order}],filters:[{field:null!==(n=e.metaDataField.lookupTableNameField)&&void 0!==n?n:e.metaDataField.lookupPrimaryKeyField,operator:"contains",value:null!=o&&o.label===p?"":p},...null!==(u=null===(l=e.query)||void 0===l?void 0:l.filters)&&void 0!==u?u:[],...""!==e.metaDataField.option?[{field:"Name",value:e.metaDataField.option}]:[]],joins:null===(a=e.query)||void 0===a?void 0:a.joins,except:null===(s=e.query)||void 0===s?void 0:s.except,..."OwningUserId"===e.metaDataField.name||"OwningTeamId"===e.metaDataField.name?{parameters:{isOwnerField:!0,tableName:e.owningTableName}}:{}});if(!m||!m.succeeded)return;let f=m.data.results.map(t=>{var l;return{value:"".concat(t[e.metaDataField.lookupPrimaryKeyField]),label:t[null!==(l=e.metaDataField.lookupTableNameField)&&void 0!==l?l:e.metaDataField.lookupPrimaryKeyField].toString(),...null!=e.metaDataField.lookupTableDescriptionField?{description:"".concat(t[e.metaDataField.lookupTableDescriptionField])}:{},...""!==e.metaDataField.option?{data:t.Value}:{}}});void 0!==e.excludeValues&&(f=f.filter(t=>{var l;return(null===(l=e.excludeValues)||void 0===l?void 0:l.find(e=>e===t.value))===void 0})),null!=o&&void 0===f.find(e=>e.value===(null==o?void 0:o.value))&&f.push(o),d(f=f.map(e=>(void 0===e.label&&(e.label=e.value),e)))};for(let t of((0,s.useEffect)(()=>{null===p||["CreatedById","UpdatedById"].includes(e.metaDataField.name)||f()},[p]),(0,s.useEffect)(()=>{void 0===e.defaultLabelValue||void 0!==n.find(t=>{var l;return t.value===(null===(l=e.defaultLabelValue)||void 0===l?void 0:l.value)})||n.find(t=>{var l,a,s;return t.value===("number"==typeof(null===(l=e.defaultLabelValue)||void 0===l?void 0:l.value)?"".concat(null===(a=e.defaultLabelValue)||void 0===a?void 0:a.value):null===(s=e.defaultLabelValue)||void 0===s?void 0:s.value)})||d([...n,e.defaultLabelValue])},[e.defaultLabelValue]),n))null==t.label&&(t.label=t.value),"number"==typeof t.value&&(t.value="".concat(t.value));return(0,a.jsx)(h.P,{label:e.label,data:n,className:e.className,renderOption:null!=e.metaDataField.lookupTableDescriptionField?x:void 0,defaultValue:void 0!==e.defaultLabelValue?e.defaultLabelValue.value:void 0,value:"number"==typeof e.value?"".concat(e.value):e.value,onSearchChange:c,onChange:t=>{var l,a,s,i,o;void 0!==e.onChange&&e.onChange({id:t,value:null!==(s=null===(l=n.find(e=>e.value===t))||void 0===l?void 0:l.data)&&void 0!==s?s:null,label:null!==(i=null===(a=n.find(e=>e.value===t))||void 0===a?void 0:a.label)&&void 0!==i?i:null}),r(null!==(o=n.find(e=>e.value===t))&&void 0!==o?o:null)},onBlur:e.onBlur,searchable:!0,clearable:e.metaDataField.isNullable,ref:l,readOnly:e.readOnly,withAsterisk:e.required,error:e.error,disabled:e.disabled})});y.displayName="XLookup";var g=l(9190),b=l(7939),N=l(9392),j=l(1506),I=l(9294),w=l(2791),E=l(6985),C=l(6437),T=l(4088),R=e=>{let t=(0,g.jE)({extensions:[I.Z,w.Z,b.r,C.Z,T.Z,j.ZP,E.Z.configure({types:["heading","paragraph"]})]});return(0,s.useEffect)(()=>(null==t||t.on("update",()=>{if(null!=e.onChange){var l;e.onChange(null!==(l=null==t?void 0:t.getHTML())&&void 0!==l?l:"")}}),()=>{null==t||t.off("update")}),[t]),(0,s.useEffect)(()=>{var l;null==t||t.commands.setContent(null!==(l=e.value)&&void 0!==l?l:"")},[t]),(0,a.jsxs)(N.L,{editor:t,styles:{root:{height:"100%",display:"flex",flexDirection:"column"},toolbar:{position:"static"},typographyStylesProvider:{display:"flex",flexDirection:"column",flexGrow:1},content:{flexGrow:1,display:"flex",flexDirection:"column",overflow:"auto"}},onChange:e=>{console.log(e)},children:[(0,a.jsxs)(N.L.Toolbar,{sticky:!0,stickyOffset:60,children:[(0,a.jsxs)(N.L.ControlsGroup,{children:[(0,a.jsx)(N.L.Bold,{}),(0,a.jsx)(N.L.Italic,{}),(0,a.jsx)(N.L.Underline,{}),(0,a.jsx)(N.L.Strikethrough,{}),(0,a.jsx)(N.L.ClearFormatting,{}),(0,a.jsx)(N.L.Highlight,{}),(0,a.jsx)(N.L.Code,{})]}),(0,a.jsxs)(N.L.ControlsGroup,{children:[(0,a.jsx)(N.L.H1,{}),(0,a.jsx)(N.L.H2,{}),(0,a.jsx)(N.L.H3,{}),(0,a.jsx)(N.L.H4,{})]}),(0,a.jsxs)(N.L.ControlsGroup,{children:[(0,a.jsx)(N.L.Blockquote,{}),(0,a.jsx)(N.L.Hr,{}),(0,a.jsx)(N.L.BulletList,{}),(0,a.jsx)(N.L.OrderedList,{}),(0,a.jsx)(N.L.Subscript,{}),(0,a.jsx)(N.L.Superscript,{})]}),(0,a.jsxs)(N.L.ControlsGroup,{children:[(0,a.jsx)(N.L.Link,{}),(0,a.jsx)(N.L.Unlink,{})]}),(0,a.jsxs)(N.L.ControlsGroup,{children:[(0,a.jsx)(N.L.AlignLeft,{}),(0,a.jsx)(N.L.AlignCenter,{}),(0,a.jsx)(N.L.AlignJustify,{}),(0,a.jsx)(N.L.AlignRight,{})]})]}),(0,a.jsx)(N.L.Content,{onChange:e=>{console.log(e)}})]})};function A(e,t){if(!e||!/^[-+]?[0-9]*\.?[0-9]*([eE][-+]?[0-9]+)?$/.test(e))return"NaN";let l={Single:{min:-34e37,max:34e37,precision:7},Double:{min:-17e307,max:17e307,precision:15},Decimal:{min:Number("-7.9e28"),max:Number("7.9e28"),precision:28},Byte:{min:0,max:255},SByte:{min:-128,max:127},Int16:{min:-32768,max:32767},UInt16:{min:0,max:65535},Int32:{min:-2147483648,max:2147483647},UInt32:{min:0,max:4294967295},Int64:{min:Number.MIN_SAFE_INTEGER,max:Number.MAX_SAFE_INTEGER},UInt64:{min:0,max:Number.MAX_SAFE_INTEGER}},a=parseFloat(e);if(isNaN(a)||!isFinite(a))throw Error("Invalid numeric value for ".concat(t,": ").concat(e));if("Int64"===t||"UInt64"===t||"Decimal"===t){if(e.includes(".")||e.includes("e")||e.includes("E")){if("Decimal"===t){if(Math.abs(a)>79e27)throw Error("Value out of range for Decimal: ".concat(e));if(e.replace(/^[-+]/,"").replace(/^0+/,"").replace(/\./,"").replace(/[eE][-+]?[0-9]+$/,"").replace(/0+$/,"").length>29)throw Error("Precision exceeds Decimal's 28-29 significant digits: ".concat(e))}}else try{let l=BigInt(e);if("Int64"===t&&(l<BigInt("-9223372036854775808")||l>BigInt("9223372036854775807")))throw Error("Value out of range for Int64: ".concat(e));if("UInt64"===t&&(l<BigInt(0)||l>BigInt("18446744073709551615")))throw Error("Value out of range for UInt64: ".concat(e));if("Decimal"===t&&(l<BigInt("-79228162514264337593543950335")||l>BigInt("79228162514264337593543950335")))throw Error("Value out of range for Decimal: ".concat(e))}catch(e){if(String(e).includes("out of range"))throw e}}else{let s=l[t];if(a<s.min||a>s.max)throw Error("Value out of range for ".concat(t,": ").concat(e));if(["Byte","SByte","Int16","UInt16","Int32","UInt32"].includes(t)&&!Number.isInteger(a))throw Error("Value must be an integer for ".concat(t,": ").concat(e))}let s=e,i=e.endsWith("."),o=e.startsWith("-"),r=o?e.substring(1):e;return/^0[0-9]/.test(r)&&(r.includes(".")?r.startsWith("0.")||(r=r.replace(/^0+(?=\d)/,"")).startsWith(".")&&(r="0"+r):""===(r=r.replace(/^0+/,""))&&(r="0"),s=o?"-"+r:r),i&&!s.endsWith(".")&&(s+="."),s}var S=e=>{var t,l,s,m,p,f,h,v,x,g,b,N;let j=(0,c.Gc)(),I=null===(t=j.formBuilder.metadata)||void 0===t?void 0:t.fields.find(t=>t.name===e.name),w=(0,u.Z)();if(null==j.formBuilder.metadata)return(0,a.jsx)(a.Fragment,{});if(null==I)throw Error("Field ".concat(e.name," not found on ").concat(j.formBuilder.metadata.tableName," metadata."));e.required?j.formBuilder.addRequiredField(I.name):j.formBuilder.removeRequiredField(I.name);let E=I.isReadOnly||e.readOnly,C=(t,l)=>{let a=!1,s=t.name,i=t.type,o=t.isNullable,r=j.formBuilder.data[s],n=["Single","Double","Decimal","Byte","SByte","Int16","UInt16","Int32","UInt32","Int64","UInt64"];if(n.includes(i)&&""===l&&(l="0"),n.includes(i)&&"-"===l&&r.length>1&&(l="0"),n.includes(i)&&l.includes("-")&&(l="-"+l.replace("-","")),n.includes(i)&&(!1===e.allowNegative&&l.startsWith("-")&&""===(l=l.replace("-",""))&&(l="0"),null!=t.numberRange)){let e=t.numberRange.split("-"),a=parseFloat(A(e[0],i)),s=parseFloat(A(e[1],i));try{let e=parseFloat(A(l,i));e<=a&&(l=a.toString()),e>s&&(l=s.toString())}catch(e){console.log(e)}}if("Char"==i&&(l=l.replace(r,""),o||""!==l||(l="A"),a=!0),("String"===i||"Guid"===i)&&(t.characterLimit&&(l.length<=t.characterLimit||(l=l.substring(0,t.characterLimit))),a=!0),["Single","Double","Decimal"].includes(i))try{let e=A(l,i);Number.isNaN(e)||"NaN"===e||(l=e.toString(),a=!0)}catch(e){}if(["Byte","SByte","Int16","UInt16","Int32","UInt32","Int64","UInt64"].includes(i))try{let e=function(e,t){let l,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;if(!e||!/^[-+]?[0-9a-fA-F]+$/.test(e))return NaN;let s={Byte:{min:0,max:255},SByte:{min:-128,max:127},Int16:{min:-32768,max:32767},UInt16:{min:0,max:65535},Int32:{min:-2147483648,max:2147483647},UInt32:{min:0,max:4294967295},Int64:{min:BigInt("-9223372036854775808"),max:BigInt("9223372036854775807")},UInt64:{min:BigInt(0),max:BigInt("18446744073709551615")},Single:{min:-34e37,max:34e37},Double:{min:-17e307,max:17e307},Decimal:{min:BigInt("-79228162514264337593543950335"),max:BigInt("79228162514264337593543950335")}};if("Int64"===t||"UInt64"===t||"Decimal"===t){try{l=BigInt(e)}catch(e){return NaN}let a=s[t];if(l<a.min||l>a.max)throw Error("Value out of range for ".concat(t,": ").concat(e))}else if(l=parseInt(e,a),["Byte","SByte","Int16","UInt16","Int32","UInt32"].includes(t)){let a=s[t];if(l<a.min||l>a.max)throw Error("Value out of range for ".concat(t,": ").concat(e))}return l}(l,i);Number.isNaN(e)||(l=e.toString(),a=!0)}catch(e){}a&&T(s,l)},T=function(t,l){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;j.formBuilder.dispatch({type:"SET_FIELD_VALUE",payload:{field:t,value:l}}),null!=e.onChange&&((null==I?void 0:I.type)==="Lookup"?e.onChange(l,a):e.onChange(l))},S=e=>null==e||!["h","m","s","A","a","H","k","K","m","s","S","Z","X","LT","LTS","LLL","LLLL","lll","llll"].some(t=>e.includes(t));if(null==I||void 0===j.formBuilder.data||void 0===j.formBuilder.data[I.name])return(0,a.jsx)(a.Fragment,{});let D=t=>{let{field:l}=t;return(0,a.jsxs)(a.Fragment,{children:[null!=e.label?e.label:l.displayName," ",!0===l.isRecommended?(0,a.jsx)(i.u,{label:"Recommended",withArrow:!0,children:(0,a.jsx)("span",{className:" text-blue-600",children:"+"})}):(0,a.jsx)(a.Fragment,{})]})};return(0,a.jsxs)(a.Fragment,{children:["Lookup"===I.type&&(0,a.jsx)(y,{label:(0,a.jsx)(D,{field:I}),className:!1===j.formBuilder.canRead.canRead?"invisible":"",metaDataField:I,owningTableName:null===(l=j.formBuilder.metadata)||void 0===l?void 0:l.tableName,ref:!0===e.focus?j.formBuilder.firstInputRef:void 0,onChange:t=>{T(I.name,null==t?void 0:t.id,null==t?void 0:t.value),null!=e.onChange&&e.onChange(null==t?void 0:t.id,null==t?void 0:t.label)},onBlur:e.onBlur,defaultLabelValue:void 0!==j.formBuilder.snapshot?(b=j.formBuilder.snapshot[I.lookupName],N=j.formBuilder.snapshot[I.name],null==b&&null!=N?{label:N,value:N}:null!=b&&null!=N?{label:b,value:N}:void 0):((e,t)=>{var l;if(void 0!==(null===(l=j.formBuilder.defaults)||void 0===l?void 0:l.find(t=>t.field===e)))return w.lookups.find(l=>l.fieldName===e&&l.lookupTable===t)})(I.name,I.lookupTable),value:j.formBuilder.data[I.name],excludeValues:null===(m=j.formBuilder.lookupExclusions)||void 0===m?void 0:null===(s=m.find(e=>e.fieldName===I.name))||void 0===s?void 0:s.values,query:null===(p=j.formBuilder.lookupQueries)||void 0===p?void 0:p.find(e=>e.field===I.name),readOnly:["CreatedById","UpdatedById"].includes(I.name)||!1===j.formBuilder.canUpdate&&void 0!==j.formBuilder.snapshot||["OwningUserId","OwningTeamId"].includes(I.name)&&void 0!==j.formBuilder.snapshot&&!1===j.formBuilder.snapshot._ui_info_.canAssign||E,required:!1===I.isNullable&&!["CreatedById","UpdatedById"].includes(I.name)||!0===I.isRequired||!0===e.required,error:null===(f=j.formBuilder.validationMessages.find(e=>e.field===I.name))||void 0===f?void 0:f.message,disabled:e.disabled}),"String"===I.type&&"rich"===e.varient&&(0,a.jsx)(R,{value:j.formBuilder.data[I.name],onChange:e=>{C(I,e)}}),"String"===I.type&&"textarea"===e.varient&&(0,a.jsx)(o.g,{styles:{root:{height:"100%",display:"flex",flexDirection:"column"},wrapper:{flexGrow:1},input:{height:"100%"}},label:(0,a.jsx)(D,{field:I}),placeholder:e.placeholder,value:j.formBuilder.data[I.name],required:!0===I.isRequired||!0===e.required||!I.isNullable,onChange:e=>{C(I,e.currentTarget.value)},onBlur:e.onBlur,readOnly:!1===j.formBuilder.canUpdate&&void 0!==j.formBuilder.snapshot||E,error:null===(h=j.formBuilder.validationMessages.find(e=>e.field===I.name))||void 0===h?void 0:h.message,disabled:e.disabled}),["String","Guid","Int32","Single","Int64","Double","Decimal","Byte","SByte","UInt32","UInt64","Int16","UInt16","Char"].includes(I.type)&&null==e.varient&&null!=j.formBuilder.data[I.name]&&(0,a.jsx)(r.o,{label:(0,a.jsx)(D,{field:I}),ref:!0===e.focus?j.formBuilder.firstInputRef:void 0,value:j.formBuilder.data[I.name],onChange:e=>{C(I,e.currentTarget.value)},onBlur:e.onBlur,readOnly:!1===j.formBuilder.canUpdate&&void 0!==j.formBuilder.snapshot||E,error:null===(v=j.formBuilder.validationMessages.find(e=>e.field===I.name))||void 0===v?void 0:v.message,required:!0===I.isRequired||!0===e.required||!I.isNullable,placeholder:e.placeholder,disabled:e.disabled}),"DateTime"===I.type&&(0,a.jsx)(d.W,{ref:!0===e.focus?j.formBuilder.firstInputRef:void 0,label:(0,a.jsx)(D,{field:I}),...null!=I.dateFormat&&""!==I.dateFormat?{valueFormat:I.dateFormat}:{},value:void 0!==j.formBuilder.data&&void 0!==j.formBuilder.data[I.name]&&null!==j.formBuilder.data[I.name]&&"0001-01-01T00:00:00"!==j.formBuilder.data[I.name]?new Date(S(I.dateFormat)?j.formBuilder.data[I.name].replace("Z",""):j.formBuilder.data[I.name]):null,onChange:e=>{T(I.name,null==e?null:S(I.dateFormat)?(null==e||e.setUTCHours(0,0,0,0),null==e?void 0:e.toISOString().replace("Z","")):null==e?void 0:e.toISOString())},onBlur:e.onBlur,clearable:I.isNullable,readOnly:["CreatedDate","UpdatedDate"].includes(I.name)||void 0!==j.formBuilder.snapshot&&!1===j.formBuilder.canUpdate||E,required:!0===I.isRequired||e.required||!I.isNullable,error:null===(x=j.formBuilder.validationMessages.find(e=>e.field===I.name))||void 0===x?void 0:x.message,...e.dateInput,disabled:e.disabled}),"Boolean"===I.type&&(0,a.jsx)("div",{className:"w-full h-full flex items-end",children:(0,a.jsx)("div",{className:"w-full h-9 flex items-center",children:(0,a.jsx)(n.X,{ref:!0===e.focus?j.formBuilder.firstInputRef:void 0,label:(0,a.jsx)(D,{field:I}),checked:void 0!==j.formBuilder.data&&void 0!==j.formBuilder.data[I.name]&&null!==j.formBuilder.data[I.name]?j.formBuilder.data[I.name]:void 0,onChange:t=>{void 0!==j.formBuilder.snapshot&&!1===j.formBuilder.canUpdate||E||T(I.name,t.currentTarget.checked),null!=e.onChange&&e.onChange(t.currentTarget.checked)},onBlur:e.onBlur,readOnly:void 0!==j.formBuilder.snapshot&&!1===j.formBuilder.canUpdate||E,error:null===(g=j.formBuilder.validationMessages.find(e=>e.field===I.name))||void 0===g?void 0:g.message,required:!0===I.isRequired||e.required,disabled:e.disabled})})})]})}},8993:function(e,t,l){"use strict";var a=l(4246),s=l(7201);l(7378);var i=l(7108);t.Z=e=>{let t=(0,i.Gc)().formBuilder;return void 0!==t.snapshot&&!1===t.canUpdate||void 0===t.snapshot&&!1===t.canCreate?(0,a.jsx)(a.Fragment,{}):(0,a.jsxs)(s.z,{className:e.className,onClick:()=>t.save(e.onPreValidate,e.onPreSave,e.onPostSave),variant:e.varient,children:[void 0!==e.label?e.label:"",void 0===e.label&&(void 0!==t.snapshot?"Update":"Create")]})}},7108:function(e,t,l){"use strict";l.d(t,{Gc:function(){return o},q3:function(){return i}});var a=l(4246),s=l(7378);let i=s.createContext(null),o=()=>{let e=s.useContext(i);if(!e)throw Error("useFormContext must be used within a FormContextProvider");return e};t.ZP=e=>(0,a.jsx)(i.Provider,{value:{formBuilder:e.formBuilder},children:e.children})},830:function(e,t,l){"use strict";var a=l(7378),s=l(1869),i=l(121),o=l(9105),r=l(2008);t.Z=e=>{let t=(0,a.useContext)(s.Il),l=(0,a.useContext)(r.Vo),n=(0,o.t)(),d=(e,t)=>{let l=document.createElement("a");l.href=URL.createObjectURL(e),l.download=t,document.body.appendChild(l),l.click(),setTimeout(()=>{document.body.removeChild(l),URL.revokeObjectURL(l.href)},0)},u=async e=>{try{var a,s,i;let o=(null!==(a=null==l?void 0:l.apiUrl)&&void 0!==a?a:"")+e.url;void 0!==e.searchParams&&(o+="?".concat(e.searchParams.toString()));let r=n.accessToken,u=await fetch(o,{method:e.method,headers:{Authorization:"Bearer ".concat(r),UserId:null!==(s=n.userId)&&void 0!==s?s:"",...void 0!==e.body&&!(e.body instanceof FormData)&&{"Content-Type":"application/json"},...e.headers,...(null==l?void 0:l.headers)!==void 0&&(null==l?void 0:l.headers)},...void 0!==e.body&&!(e.body instanceof FormData)&&{body:JSON.stringify(e.body)},...void 0!==e.body&&e.body instanceof FormData&&{body:e.body}});if(401===u.status)return(null==l?void 0:l.onUnauthorized)!==void 0&&l.onUnauthorized(),{succeeded:!1,data:void 0,friendlyMessage:"",logMessage:"",response:u};if(400===u.status&&!e.hideFailureMessage){if(void 0!==e.failureMessage)null==t||t.showError(e.failureMessage);else{let e=await u.json();return null==t||t.showError(e.friendlyMessage),console.error(e.logMessage),e}}if(!1===u.ok){let e=await u.text();return{succeeded:!1,data:void 0,friendlyMessage:e,logMessage:e,response:u}}let c=u.headers.get("content-type");if(c&&-1!==c.indexOf("application/octet-stream")&&d(await u.blob(),null!==(i=e.fileName)&&void 0!==i?i:"file"),!c||-1===c.indexOf("application/json"))return{succeeded:!0,data:u.body,friendlyMessage:"",logMessage:"",response:u};{let l=await u.json();return!1===l.succeeded&&((void 0===e.hideFailureMessage||!1===e.hideFailureMessage)&&(null==t||t.showError(l.friendlyMessage)),console.error(l.logMessage)),l}}catch(l){return console.error(l),(void 0===e.hideFailureMessage||!1===e.hideFailureMessage)&&void 0!==e.failureMessage&&(null==t||t.showError(JSON.stringify(l))),{succeeded:!1,data:void 0,friendlyMessage:"",logMessage:"",response:void 0}}},c=async()=>{let e=await u({url:i.mE,method:"GET"});return!0===e.succeeded?e.data:null},m=async e=>{let t=await u({url:i.TO,method:"POST",body:{method:"has_permissions",parameters:{permissionNames:e}}});return!0===t.succeeded&&t.data.length===e.length},p=async e=>{let t=await u({url:i.TO,method:"POST",body:{method:"has_permissions",parameters:{permissionNames:e}}});return!0===t.succeeded&&t.data.length>0},f=async e=>{let t=await u({url:i.BR,method:"POST",body:{method:"table_metadata",parameters:{tableName:e}}});return null==t?void 0:t.data},h=async e=>await u({url:i.BR,method:"POST",body:{method:"table_list",parameters:{tag:e}}}),v=async function(e,t){let l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return await u({method:"POST",url:i.Vx,body:{tableName:e,fields:t,parameters:l}})},x=async(e,t,l)=>await u({method:"PATCH",url:i.sy,body:{tableName:e,fields:t,parameters:l}}),y=async(e,t,l)=>await u({method:"DELETE",url:i.QC,body:{tableName:e,id:t,fields:{},parameters:l}}),g=async(e,t,l)=>await u({method:"POST",url:i.F,body:{tableName:e,fields:t,parameters:l}}),b=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return await u({method:"POST",url:i.Vx,body:{entities:e,parameters:t}})},N=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return await u({method:"PATCH",url:i.sy,body:{entities:e,parameters:t}})},j=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return await u({method:"DELETE",url:i.QC,body:{entities:e,parameters:t}})},I=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return await u({method:"POST",url:i.F,body:{entities:e,parameters:t}})},w=async function(e){return arguments.length>1&&void 0!==arguments[1]&&arguments[1],await u({url:i.bZ,method:"POST",body:e})},E=async e=>await u({method:"POST",url:i.ku,body:e}),C=async(e,t,l)=>await u({method:"POST",url:i.k0,body:{name:e,parameters:t},fileName:l}),T=async e=>await u({method:"POST",url:i.mH,body:e});return(0,a.useMemo)(()=>({execute:u,whoAmI:c,hasAllPermissions:m,hasAnyPermissions:p,tables:h,metadata:f,create:v,read:E,update:x,delete:y,upsert:g,bulkCreate:b,bulkUpdate:N,bulkDelete:j,bulkUpsert:I,bulk:w,action:C,file:T}),[null==l?void 0:l.apiUrl,null==l?void 0:l.headers,null==l?void 0:l.onUnauthorized,n.accessToken,n.userId])}},2485:function(e,t,l){"use strict";var a=l(7040),s=l(4827);l(7378),t.Z=()=>{let e=(0,a.rZ)(),{colorScheme:t,toggleColorScheme:l}=(0,s.X)(),i="dark"===t,o=i?e.colors.gray[4]:e.colors.dark[7];return{getIconColor:()=>o,getPrimaryColor:()=>e.colors[e.primaryColor][i?8:6],colorScheme:t}}},2509:function(e,t,l){"use strict";var a=l(121);let s=(0,l(6805).Ue)()((e,t)=>({lookups:[],getLookupLabel:async(l,s,i,o,r)=>{let n=t().lookups.find(e=>e.fieldName===s&&e.lookupTable===i&&e.lookupTableNameField==o&&e.value===r);if(void 0!==n)return n;let d=await l.execute({url:a.ku,method:"POST",body:{fields:["*"],tableName:i,maxResults:1,page:1,id:r}});if(((null==d?void 0:d.succeeded)!==!0||null!==d.data)&&(null==d?void 0:d.succeeded)===!0&&void 0!==d.data.results&&d.data.results.length>0){let l=d.data.results[0][o],a={fieldName:s,lookupTable:i,lookupTableNameField:o,value:r,label:l};return e({lookups:[...t().lookups,a]}),a}},getAnyLookup:async(l,s,i,o)=>{let r=t().lookups.find(e=>e.fieldName===s&&e.lookupTable===i&&e.lookupTableNameField==o);if(void 0!==r)return r;let n=await l.execute({url:a.ku,method:"POST",body:{fields:["*"],tableName:i,maxResults:1,page:1}});if(((null==n?void 0:n.succeeded)!==!0||null!==n.data)&&(null==n?void 0:n.succeeded)===!0&&void 0!==n.data.results&&n.data.results.length>0){let l={fieldName:s,lookupTable:i,lookupTableNameField:o,value:n.data.results[0]["".concat(i,"Id")],label:n.data.results[0][o]};return e({lookups:[...t().lookups,l]}),l}}}));t.Z=s},5387:function(e,t,l){"use strict";class a{top(e){return this._maxResults=e,this}page(e){return this._page=e,this}from(e){return this._tableName=e,this}where(e,t,l){return e instanceof i?this._filters.push(e):this._filters.push(o(e,t,l)),this}and(e,t,l){return e instanceof i?this._filters[this._filters.length-1].and(e):this._filters[this._filters.length-1].and(e,t,l),this}or(e,t,l){return e instanceof i?this._filters[this._filters.length-1].or(e):this._filters[this._filters.length-1].or(e,t,l),this}join(e,t,l){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return this._joins.push(new s(e,t,l,a,"inner")),this}leftJoin(e,t,l){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return this._joins.push(new s(e,t,l,a,"left")),this}except(e){return this._except.push(e),this}orderBy(e,t){return this._orderBy||(this._orderBy=[]),this._orderBy.push({field:e,order:t}),this}distinct(){return this._distinct=!0,this}denormalize(){return this._denoramlize=!0,this}toReadRequest(){var e,t,l;return{tableName:this._tableName,fields:this._fields,page:null!==(e=this._page)&&void 0!==e?e:1,maxResults:null!==(t=this._maxResults)&&void 0!==t?t:null,orderBy:null!==(l=this._orderBy)&&void 0!==l?l:[],filters:this._filters.length>0?[this._filters[0].getJson()]:[],joins:this._joins,distinct:this._distinct,denormalize:this._denoramlize,except:this._except}}constructor(e){return this._page=1,this._tableName="",this._filters=[],this._joins=[],this._distinct=!1,this._denoramlize=!1,this._except=[],this._fields=e,this}}class s{constructor(e,t,l=null,a=null,s){this.alias=null;let i=e.split("."),o=t.split(".");if(i.length<2||o.length<2)throw Error("Join must include a table and field part ie: tableName.fieldName");this.fromTable=i[0],this.fromField=i[1],this.toTable=o[0],this.toField=o[1],this.alias=l,this.fields=null!=a?a:[],this.type=s}}class i{and(e,t,l){if(e instanceof i)this.filters.push(e);else{if("OR"==this.logicalOperator){let a;let s=this.conditions[this.conditions.length-1];return this.lastCondition==s?(a=new i,this.conditions.pop(),a.conditions.push(s)):a=this.filters[this.filters.length-1],this.lastCondition={field:e,operator:t,value:l},a.conditions.push(this.lastCondition),this.filters.push(a),this}this.lastCondition={field:e,operator:t,value:l},this.conditions.push(this.lastCondition)}return this}or(e,t,l){if(e instanceof i)this.filters.push(e);else{if("AND"===this.logicalOperator){this.logicalOperator="OR";let e=new i;e.conditions=this.conditions,this.filters.push(e),this.conditions=[]}this.lastCondition={field:e,operator:t,value:l},this.conditions.push(this.lastCondition)}return this}getJson(){return{logicalOperator:this.logicalOperator,filters:[...this.conditions,...this.filters.map(e=>e.getJson())]}}getStr(){let e=[];for(let t of this.conditions)e.push("".concat(t.field," ").concat(t.operator," ").concat(t.value));for(let t of this.filters)e.push("(".concat(t.getStr(),")"));return e.join(" ".concat(this.logicalOperator," "))}print(){return console.log(this.getStr()),this}constructor(){this.logicalOperator="AND",this.filters=[],this.conditions=[]}}let o=(e,t,l)=>{let a=new i;return a.logicalOperator="AND",a.conditions=[],a.conditions.push({field:e,operator:t,value:l}),a};t.ZP=a}},function(e){e.O(0,[345,101,488,32,888,774,179],function(){return e(e.s=9536)}),_N_E=e.O()}]);