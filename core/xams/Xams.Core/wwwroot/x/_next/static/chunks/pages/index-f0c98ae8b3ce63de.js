(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[332],{91:(e,t,l)=>{"use strict";l.d(t,{A:()=>i});var a=l(6443),s=l(7188);l(5834);let i=()=>{let e=(0,a.xd)(),{colorScheme:t,toggleColorScheme:l}=(0,s.C)(),i="dark"===t,r=i?e.colors.gray[4]:e.colors.dark[7];return{getIconColor:()=>r,getPrimaryColor:()=>e.colors[e.primaryColor][i?8:6],colorScheme:t}}},722:(e,t,l)=>{"use strict";l.d(t,{OJ:()=>r,cy:()=>i});var a=l(6514),s=l(5834);let i=(0,s.createContext)(void 0),r=e=>{let{authConfig:t,children:l}=e,[r,n]=(0,s.useState)(void 0),[o,d]=(0,s.useState)(!1),[u,c]=(0,s.useState)(!1),[m,f]=(0,s.useState)([]),[p,h]=(0,s.useState)(!1),[x,v]=(0,s.useState)(!1),[,y]=(0,s.useState)(null),g=(0,s.useRef)(y),b=(0,s.useRef)(()=>{}),j=(0,s.useRef)(e=>{}),N=async()=>{if(t.handleRedirectResult){let l=await t.handleRedirectResult();if(!l.success){var e;g.current(null!=(e=l.error)?e:"Unknown error")}}},w=async e=>{b.current();let l=await t.mfaRequired(),a=[];if(l&&f(a=await t.mfaFactors()),e){let s=await t.isEmailVerified(),i=await t.mfaTotpEnrolled(),r=await t.mfaSmsEnrolled();d(s),n(e),h(i),v(r),c(l),j.current({isLoggedIn:e,isEmailVerified:s,mfaTotpEnrolled:i,mfaSmsEnrolled:r,isMfaRequired:l,mfaFactors:a})}else n(e),d(!1),h(!1),v(!1),c(l),f(a),j.current({isLoggedIn:e,isEmailVerified:!1,mfaTotpEnrolled:!1,mfaSmsEnrolled:!1,isMfaRequired:l,mfaFactors:a})};return(0,s.useEffect)(()=>{N();let e=t.onAuthStateChanged(e=>{w(e)});return()=>{e()}},[t,n]),(0,a.jsx)(i.Provider,{value:{authConfig:t,setErrorRef:g,clearRef:b,onAuthStateChangedRef:j,isReady:void 0!==r,isLoggedIn:!0===r,isMfaRequired:u,mfaFactors:m,isEmailVerified:o,mfaTotpEnrolled:p,mfaSmsEnrolled:x,setMfaTotpEnrolled:h,setMfaSmsEnrolled:v,setIsMfaRequired:c},children:l})}},2822:(e,t,l)=>{"use strict";l.d(t,{A:()=>r});var a=l(6514),s=l(9967);l(5834);var i=l(9692);let r=e=>{let t=(0,i.xW)().formBuilder;return void 0!==t.snapshot&&!1===t.canUpdate||void 0===t.snapshot&&!1===t.canCreate?(0,a.jsx)(a.Fragment,{}):(0,a.jsxs)(s.$,{type:"submit",className:e.className,size:e.size,variant:e.varient,children:[void 0!==e.label?e.label:"",void 0===e.label&&(void 0!==t.snapshot?"Update":"Create")]})}},2894:(e,t,l)=>{"use strict";l.d(t,{Ay:()=>n});class a{top(e){return this._maxResults=e,this}page(e){return this._page=e,this}from(e){return this._tableName=e,this}where(e,t,l){return e instanceof i?this._filters.push(e):this._filters.push(r(e,t,l)),this}and(e,t,l){return e instanceof i?this._filters[this._filters.length-1].and(e):this._filters[this._filters.length-1].and(e,t,l),this}or(e,t,l){return e instanceof i?this._filters[this._filters.length-1].or(e):this._filters[this._filters.length-1].or(e,t,l),this}join(e,t,l){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return this._joins.push(new s(e,t,l,a,"inner")),this}leftJoin(e,t,l){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return this._joins.push(new s(e,t,l,a,"left")),this}except(e){return this._except.push(e),this}orderBy(e,t){return this._orderBy||(this._orderBy=[]),this._orderBy.push({field:e,order:t}),this}distinct(){return this._distinct=!0,this}denormalize(){return this._denoramlize=!0,this}toReadRequest(){var e,t,l;return{tableName:this._tableName,fields:this._fields,page:null!=(e=this._page)?e:1,maxResults:null!=(t=this._maxResults)?t:null,orderBy:null!=(l=this._orderBy)?l:[],filters:this._filters.length>0?[this._filters[0].getJson()]:[],joins:this._joins,distinct:this._distinct,denormalize:this._denoramlize,except:this._except}}constructor(e){return this._page=1,this._tableName="",this._filters=[],this._joins=[],this._distinct=!1,this._denoramlize=!1,this._except=[],this._fields=e,this}}class s{constructor(e,t,l=null,a=null,s){this.alias=null;let i=e.split("."),r=t.split(".");if(i.length<2||r.length<2)throw Error("Join must include a table and field part ie: tableName.fieldName");this.fromTable=i[0],this.fromField=i[1],this.toTable=r[0],this.toField=r[1],this.alias=l,this.fields=null!=a?a:[],this.type=s}}class i{and(e,t,l){if(e instanceof i)this.filters.push(e);else{if("OR"==this.logicalOperator){let a,s=this.conditions[this.conditions.length-1];return this.lastCondition==s?(a=new i,this.conditions.pop(),a.conditions.push(s)):a=this.filters[this.filters.length-1],this.lastCondition={field:e,operator:t,value:l},a.conditions.push(this.lastCondition),this.filters.push(a),this}this.lastCondition={field:e,operator:t,value:l},this.conditions.push(this.lastCondition)}return this}or(e,t,l){if(e instanceof i)this.filters.push(e);else{if("AND"===this.logicalOperator){this.logicalOperator="OR";let e=new i;e.conditions=this.conditions,this.filters.push(e),this.conditions=[]}this.lastCondition={field:e,operator:t,value:l},this.conditions.push(this.lastCondition)}return this}getJson(){return{logicalOperator:this.logicalOperator,filters:[...this.conditions,...this.filters.map(e=>e.getJson())]}}getStr(){let e=[];for(let t of this.conditions)e.push("".concat(t.field," ").concat(t.operator," ").concat(t.value));for(let t of this.filters)e.push("(".concat(t.getStr(),")"));return e.join(" ".concat(this.logicalOperator," "))}print(){return console.log(this.getStr()),this}constructor(){this.logicalOperator="AND",this.filters=[],this.conditions=[]}}let r=(e,t,l)=>{let a=new i;return a.logicalOperator="AND",a.conditions=[],a.conditions.push({field:e,operator:t,value:l}),a},n=a},3142:(e,t,l)=>{"use strict";l.d(t,{A:()=>i});var a=l(5834),s=l(722);let i=e=>{var t;let l=(0,a.useContext)(s.cy),[i,r]=(0,a.useState)(null!=(t=null==e?void 0:e.defaultView)?t:"login"),[n,o]=(0,a.useState)(null),[d,u]=(0,a.useState)(!1),[c,m]=(0,a.useState)(""),[f,p]=(0,a.useState)(""),[h,x]=(0,a.useState)(!0),[v,y]=(0,a.useState)(void 0),[g,b]=(0,a.useState)(""),[j,N]=(0,a.useState)(""),[w,I]=(0,a.useState)(!1),[C,E]=(0,a.useState)(""),[A,T]=(0,a.useState)(""),[S,R]=(0,a.useState)(""),[D,k]=(0,a.useState)(""),[_,F]=(0,a.useState)(""),[L,B]=(0,a.useState)(""),[P,O]=(0,a.useState)("");if(void 0===l)throw Error("useAuth must be used within a AuthProvider");let M=()=>{o(null),m(""),p(""),x(!0),I(!1),y(void 0),b(""),N(""),E(""),T(""),R(""),k(""),F(""),B(""),O("")};l.setErrorRef.current=o,l.clearRef.current=M,(null==e?void 0:e.onAuthStateChanged)!=null&&(l.onAuthStateChangedRef.current=e.onAuthStateChanged);let U=async e=>{try{u(!0);let l=await e();if(l.success)o(null);else{var t;o(null!=(t=l.error)?t:"Unknown error")}return l.success}catch(e){return console.error("Error processing request: ",e),!1}finally{u(!1)}},W=async()=>await U(async()=>{let e=await l.authConfig.signIn(c,f,h);return e.success&&I(!1),e}),V=async()=>await U(async()=>await l.authConfig.signUp(c,f,h)),z=async()=>await U(async()=>{let e=await l.authConfig.mfaTotpEnroll(g);return e.success&&(y(void 0),await l.authConfig.mfaTotpEnrolled()&&l.setMfaTotpEnrolled(!0)),e}),H=async()=>await U(async()=>await l.authConfig.mfaTotpVerify(g)),G=async()=>await U(async()=>{let e=await l.authConfig.mfaSmsCreate(j);return e.success||"re-login"!==e.data||(I(!0),r("login")),e}),q=async()=>await U(async()=>{let e=await l.authConfig.mfaSmsEnroll(g);return e.success&&l.setMfaSmsEnrolled(!0),e}),J=async()=>await U(async()=>await l.authConfig.mfaSmsVerify(g)),K=async(e,t)=>await U(async()=>{let a=await l.authConfig.changePassword(e||C,t||A);return a.success&&(E(""),T("")),a}),X=async()=>await U(async()=>await l.authConfig.sendPasswordResetEmail(S)),Y=async e=>await U(async()=>{let t=await l.authConfig.verifyPasswordResetCode(e||D);return t.success&&t.data&&O(t.data),t}),$=async(e,t)=>await U(async()=>{let a=await l.authConfig.confirmPasswordReset(e||D,t||_);return a.success&&(k(""),F(""),B(""),O("")),a});return{view:i,setView:e=>{r(e),M()},isProcessing:d,emailAddress:c,setEmailAddress:m,password:f,setPassword:p,remember:h,setRemember:x,mfaTotpQrCode:v,isReLoginRequired:w,mfaCode:g,setMfaCode:b,phoneNumber:j,setPhoneNumber:N,signIn:W,signInProvider:async e=>await U(async()=>{let t=await l.authConfig.signInProvider(e);return t.success&&I(!1),t}),signUp:V,signOut:async t=>await U(async()=>{let a=await l.authConfig.signOut();if(l.setIsMfaRequired(!1),t)r(t);else{var s;r(null!=(s=null==e?void 0:e.defaultView)?s:"login")}return a}),error:n,setError:o,mfaTotpCreate:async()=>await U(async()=>{var t,a;let s=await l.authConfig.mfaTotpCreate();return s.success||"re-login"!==s.data||(I(!0),r(null!=(t=null==e?void 0:e.defaultView)?t:"login")),s.success&&y(null!=(a=s.data)?a:""),s}),mfaTotpEnroll:z,mfaTotpUnenroll:async()=>await U(async()=>{let e=await l.authConfig.mfaTotpUnenroll();return e.success||"re-login"!==e.data||(I(!0),r("login")),e.success&&l.setMfaTotpEnrolled(!1),e}),mfaTotpVerify:H,mfaSmsCreate:G,mfaSmsEnroll:q,mfaSmsUnenroll:async()=>await U(async()=>{let e=await l.authConfig.mfaSmsUnenroll();return e.success||"re-login"!==e.data||(I(!0),r("login")),e.success&&l.setMfaSmsEnrolled(!1),e}),mfaSmsSend:async()=>await U(async()=>await l.authConfig.mfaSmsSend()),mfaSmsVerify:J,currentPassword:C,setCurrentPassword:E,newPassword:A,setNewPassword:T,changePassword:K,sendEmailVerification:async e=>await U(async()=>await l.authConfig.sendEmailVerification(e)),resetEmail:S,setResetEmail:R,sendPasswordResetEmail:X,resetOobCode:D,setResetOobCode:k,resetNewPassword:_,setResetNewPassword:F,resetConfirmPassword:L,setResetConfirmPassword:B,resetEmailFromCode:P,setResetEmailFromCode:O,verifyPasswordResetCode:Y,confirmPasswordReset:$,...l}}},5216:(e,t,l)=>{"use strict";l.r(t),l.d(t,{default:()=>te});var a=l(6514),s=l(6444),i=l(9076),r=l(5261),n=l(5050),o=l(5627),d=l(9967),u=l(5834),c=l(4918),m=l(2651),f=l(2903),p=l(4180),h=l(8979);let x=e=>{let t=(0,i.A)(),[l,n]=u.useState([]),[o,c]=u.useState(!0),x=async()=>{c(!0),await t.execute({url:s.nm,method:"POST",body:{name:"ADMIN_ExportData",parameters:{tables:l.filter(e=>!0===e.checked).map(e=>({name:e.Name,dependencies:e.Dependencies.filter(e=>!0===e.checked).map(e=>({name:e.Name}))}))}},fileName:"export_".concat(new Date().toLocaleString().replaceAll(" ",""),".json")}),e.close()},v=async()=>{c(!0);let e=await t.execute({url:s.nm,method:"POST",body:{name:"ADMIN_ExportDependencies"}});if((null==e?void 0:e.succeeded)===!0){let t=e.data;for(let e of t)for(let t of(e.checked=!1,e.Dependencies))t.checked=!1,t.disabled=!1;n(t)}c(!1)},y=(e,t)=>{let l=!1;for(let a of e)if(a.Name===t){l=!a.checked;break}let a=e.map(e=>e);g(t,a,[],l),n(a)},g=(e,t,l,a)=>{if(!l.includes(e))for(let s of(l.push(e),t))if(s.Name===e)for(let e of(s.checked=a,s.disabled=!1,s.Dependencies))!1===e.Optional&&(e.checked=a,e.disabled=a,g(e.Name,t,l,a));else for(let t of s.Dependencies)t.Name===e&&(t.checked=a,t.disabled=a)};return(0,u.useEffect)(()=>{!0===e.opened&&(c(!1),n([]),v())},[e.opened]),(0,a.jsxs)(m.a,{opened:e.opened,onClose:e.close,title:"Export Data",styles:{body:{overflow:"hidden",position:"relative",padding:"0px"}},centered:!0,children:[!0===o&&(0,a.jsx)("div",{className:"absolute w-full h-full flex justify-center items-center overflow-hidden z-30",children:(0,a.jsx)(r.a,{})}),(0,a.jsxs)("div",{className:"p-4 ".concat(o?"invisible":""),children:[(0,a.jsx)(f.F,{h:650,children:(0,a.jsx)("div",{className:" pl-2 flex flex-col gap-2",children:l.map(e=>(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{children:(0,a.jsx)(p.S,{styles:{input:{cursor:"pointer"},label:{cursor:"pointer"}},checked:e.checked,disabled:e.disabled,onChange:()=>{},onClick:()=>{y(l,e.Name)},label:e.Name})}),(0,a.jsx)("div",{className:"flex flex-col gap-1",children:e.Dependencies.map(e=>(0,a.jsx)("div",{className:"ml-8",children:(0,a.jsx)(p.S,{styles:{input:{cursor:"pointer"},label:{cursor:"pointer"}},label:e.Name,checked:e.checked,onChange:()=>{},disabled:e.disabled,onClick:()=>y(l,e.Name)})},"".concat(h.A.name,"-").concat(e.Name)))})]},e.Name))})}),(0,a.jsx)("div",{className:"w-full flex justify-end mt-4",children:(0,a.jsx)(d.$,{onClick:x,children:"Export"})})]})]})};var v=l(9590);let y=e=>{let t=(0,i.A)(),[l,n]=u.useState(null),[o,c]=u.useState(!1),f=(0,u.useRef)(null),p=(0,u.useRef)(!1),h=(0,u.useRef)(null),x=async()=>{if(!p.current){p.current=!0;try{let l=await t.action("ADMIN_ImportData",{jobHistoryId:f.current});if(!l.succeeded){p.current=!1;return}let a=l.data.jobStatus;"Running"!==a&&"Not Started"!==a&&(clearInterval(h.current),h.current=null,c(!1),"Failed"===a?console.error("Job failed",l.data.jobMessage):"Completed"===a&&(console.log("Job completed successfully"),e.close())),console.log(a)}catch(e){p.current=!1;return}p.current=!1}},y=async()=>{if(null===l)return;c(!0);let e=new FormData;e.append("file",l),e.append("name","ADMIN_ImportData");let a=await t.execute({url:s.N$,method:"POST",body:e});a.succeeded&&(f.current=a.data.jobHistoryId,h.current=setInterval(x,2e3))};return(0,u.useEffect)(()=>{!0===e.opened&&(c(!1),n(null),f.current=null,null!=h.current&&clearInterval(h.current))},[e.opened]),(0,a.jsxs)(m.a,{opened:e.opened,onClose:e.close,size:"md",title:"Import Data",closeOnEscape:!o,closeOnClickOutside:!o,withCloseButton:!o,styles:{body:{overflow:"hidden",position:"relative",padding:"0px"}},centered:!0,children:[!0===o&&(0,a.jsx)("div",{className:"absolute w-full h-full  flex justify-center items-center overflow-hidden z-30",children:(0,a.jsx)(r.a,{})}),(0,a.jsxs)("div",{className:"p-4 ".concat(o?"invisible":""),children:[(0,a.jsx)(v.z,{label:"File Upload",placeholder:"Click to choose data file",required:!0,value:l,onChange:e=>{n(e)}}),(0,a.jsx)("div",{className:"w-full flex justify-end mt-4",children:(0,a.jsx)(d.$,{onClick:y,disabled:null===l,children:"Upload"})})]})]})};var g=l(7188),b=l(6508),j=l(6300),N=l(3108);let w=e=>{let{colorScheme:t,toggleColorScheme:l}=(0,g.C)(),[s,i]=u.useState(!1);if((0,u.useEffect)(()=>{i(!0)},[]),"dark"===t?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark"),!s)return null;let r="dark"===t,n="yellow";return r&&e.darkColor&&(n=e.darkColor),!r&&e.lightColor&&(n=e.lightColor),(0,a.jsx)(b.M,{variant:"outline",color:n,onClick:()=>l(),title:"Toggle color scheme",children:r?(0,a.jsx)(j.A,{size:"1.1rem"}):(0,a.jsx)(N.A,{size:"1.1rem"})})};var I=l(91),C=l(8588),E=l(8309);let A=u.lazy(()=>Promise.resolve().then(l.bind(l,9181))),T=(0,u.forwardRef)((e,t)=>{let[l,s]=(0,u.useState)(!1),i=u.useRef(null);if((0,u.useImperativeHandle)(t,()=>i.current),(0,u.useEffect)(()=>{s(!0)},[]),!l)return(0,a.jsx)("div",{className:"w-full h-full flex justify-center items-center",children:(0,a.jsx)(r.a,{})});let n=e.tableName+JSON.stringify(e.filters)+JSON.stringify(e.joins)+JSON.stringify(e.orderBy)+JSON.stringify(e.except)+JSON.stringify(e.additionalFields)+JSON.stringify(e.fields)+JSON.stringify(e.maxResults);return(0,a.jsx)(A,{ref:i,...e},n)});var S=l(7828),R=l(2702),D=l(1916);let k=e=>(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("span",{children:["Id: ",e.value]}),(0,a.jsx)(S.i,{value:e.value,children:e=>{let{copied:t,copy:l}=e;return(0,a.jsxs)(d.$,{variant:"subtle",styles:{root:{paddingRight:4,paddingLeft:4}},onClick:l,children:[t?(0,a.jsx)(R.A,{size:16}):(0,a.jsx)(D.A,{className:"mr-1",size:16}),t?"Copied":"Copy"]})}})]}),_=()=>{var e;let t=eX();return(0,a.jsx)(a.Fragment,{children:t.tables.length>0&&!(null==(e=t.props.hiddenMenuItems)?void 0:e.includes("Entities"))&&(0,a.jsx)(C.k,{label:"Entities",leftSection:(0,a.jsx)(E.A,{size:16,strokeWidth:2,color:t.color}),children:t.tables.filter(e=>{var l,a;return"System"!==e.tag&&(null==(l=t.props.hiddenEntities)?void 0:l.includes(e.tableName))!==!0&&(void 0===t.props.visibleEntities||(null==(a=t.props.visibleEntities)?void 0:a.includes(e.tableName)))}).sort((e,l)=>t.props.showEntityDisplayNames?e.displayName.localeCompare(l.displayName):e.tableName.localeCompare(l.tableName)).map(e=>(0,a.jsx)(C.k,{label:t.props.showEntityDisplayNames?e.displayName:e.tableName,leftSection:(0,a.jsx)(E.A,{size:16,strokeWidth:2,color:t.color}),onClick:()=>t.setActiveComponent(t=>({component:(0,a.jsx)(T,{tableName:e.tableName,maxResults:100,showActiveSwitch:!0,canDeactivate:!0,formMinWidth:36,formAppendButton:e=>(0,a.jsx)(a.Fragment,{children:"UPDATE"===e.operation&&(0,a.jsx)("div",{className:"w-full flex justify-start items-center gap-1",children:(0,a.jsx)(k,{value:e.data["".concat(e.tableName,"Id")]})})})})}))},e.tableName))})})};var F=l(4821),L=l(2037),B=l(330),P=l(781);let O=e=>(0,a.jsxs)("div",{className:"flex justify-center items-center w-full h-full",children:["none"===e.icon&&(0,a.jsx)("svg",{width:"20",height:"20",viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"cursor-pointer",onClick:e.onClick,children:(0,a.jsx)("rect",{x:"2.00024",y:"2",width:"28",height:"28",rx:"6",stroke:"#4B4B4B",strokeWidth:"4"})}),"user"===e.icon&&(0,a.jsxs)("svg",{width:"20",height:"20",viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"cursor-pointer",onClick:e.onClick,children:[(0,a.jsx)("rect",{x:"2.00024",y:"2",width:"28",height:"28",rx:"6",stroke:"#4B4B4B",strokeWidth:"4"}),(0,a.jsx)("mask",{id:"mask0_712_5305",maskUnits:"userSpaceOnUse",x:"4",y:"16",width:"12",height:"12",children:(0,a.jsx)("path",{d:"M4 16V28H16L4 16Z",fill:"#D9D9D9"})}),(0,a.jsx)("g",{mask:"url(#mask0_712_5305)",children:(0,a.jsx)("rect",{x:"4.00024",y:"4",width:"24",height:"24",rx:"4",fill:"#991B1B"})})]}),"team"===e.icon&&(0,a.jsxs)("svg",{width:"20",height:"20",viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"cursor-pointer",onClick:e.onClick,children:[(0,a.jsx)("rect",{x:"2",y:"2",width:"28",height:"28",rx:"6",stroke:"#4B4B4B",strokeWidth:"4"}),(0,a.jsx)("mask",{id:"mask0_712_5300",maskUnits:"userSpaceOnUse",x:"4",y:"4",width:"24",height:"24",children:(0,a.jsx)("path",{d:"M4 28H28L4 4V28Z",fill:"#D9D9D9"})}),(0,a.jsx)("g",{mask:"url(#mask0_712_5300)",children:(0,a.jsx)("rect",{x:"4",y:"4",width:"24",height:"24",rx:"4",fill:"#F59E0B"})})]}),"system"===e.icon&&(0,a.jsxs)("svg",{width:"20",height:"20",viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"cursor-pointer",onClick:e.onClick,children:[(0,a.jsx)("rect",{x:"2",y:"2",width:"28",height:"28",rx:"6",stroke:"#4B4B4B",strokeWidth:"4"}),(0,a.jsx)("rect",{x:"4",y:"4",width:"24",height:"24",rx:"4",fill:"#84CC16"})]})]});var M=l(2894),U=l(4296),W=l(6915),V=l(2822),z=l(9089),H=l(2009);let G=u.createContext(null),q=()=>{let e=u.useContext(G);if(!e)throw Error("useDataGridContext must be used within a DataGridContextProvider");return e},J=u.createContext(null),K=e=>{let t=q();return(0,a.jsx)("div",{className:"w-full",children:(0,a.jsx)("input",{type:"text",style:{zIndex:null!=t.props.zIndex?t.props.zIndex+1:2,textAlign:e.rightAlign?"right":"left"},className:"w-full h-full border-none outline-none",value:t.editValue,onChange:e=>{let l=e.target.value;if(t.activeCell&&t.activeCell.onEditing&&t.activeCellLocation){var a;l=t.activeCell.onEditing(l,t.activeCellLocation,null==(a=t.activeCell)?void 0:a.data)}t.setEditValue(l)},autoFocus:!0})})};var X=l(336);let Y=e=>e.isEditing||null==e.errorMessage||""===e.errorMessage?(0,a.jsx)(a.Fragment,{}):(0,a.jsx)(X.m,{label:e.errorMessage,color:"#dc2626",withArrow:!0,children:(0,a.jsx)("div",{className:"absolute w-full h-full flex justify-start items-center",children:(0,a.jsx)("div",{className:"w-4 h-4 text-xs text-white rounded-full bg-red-600 flex justify-center items-center font-bold ml-1",children:"!"})})}),$=e=>{var t,l,s,i,r;let n=q(),o=(()=>{let e=u.useContext(J);if(!e)throw Error("useSubGrid must be used within a SubGridContextProvider");return e})(),d=(0,u.useRef)(null),c=(0,I.A)();if(null==n.props.rows[e.rowIndex+o.skipRows])return;let m=n.props.rows[e.rowIndex+o.skipRows].columns[e.columnIndex+o.skipColumns],f={row:e.rowIndex+o.skipRows,col:e.columnIndex+o.skipColumns},p=null!=(s=m.value)?s:"",h=null==p?"":p.toString(),x="light"===c.colorScheme?"bg-gray-200":"bg-neutral-800",v=n.props.rightAlignNumbers&&(e=>"string"==typeof e&&!isNaN(e)&&!isNaN(parseFloat(e)))(h),y=n.props.rows[e.rowIndex+o.skipRows].columns[e.columnIndex+o.skipColumns].style,g=(null==(t=n.activeCellLocation)?void 0:t.row)===e.rowIndex+o.skipRows&&(null==(l=n.activeCellLocation)?void 0:l.col)===e.columnIndex+o.skipColumns;return(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)("div",{ref:d,style:{...e.style,borderRight:"1px solid gray",borderBottom:"1px solid gray",...null!=y?y:{}},className:"h-full ".concat(null==m.custom?"py-0.5":""," relative whitespace-nowrap text-ellipsis text-sm flex items-center ").concat(m.isDisabled?x:""," ").concat(v?"justify-end":""," ").concat(!1===n.props.editable?"":"cursor-pointer"),onClick:()=>((e,t)=>{let l=n.props.rows[e+o.skipRows].columns[t+o.skipColumns].onClick;if(null!=l){let a=n.props.rows[e+o.skipRows].columns[t+o.skipColumns].data;l(p,{row:e+o.skipRows,col:t+o.skipColumns},a)}!1!==n.props.editable&&(n.setActiveCellLocation({row:e+o.skipRows,col:t+o.skipColumns}),n.isEditing&&n.onEndEdit())})(e.rowIndex,e.columnIndex),onDoubleClick:()=>n.onKeyDown(window,void 0,h),children:[!g&&null!=m.errorMessage&&(0,a.jsx)(Y,{isEditing:g&&n.isEditing,errorMessage:m.errorMessage}),(0,a.jsx)("div",{onMouseDown:t=>{n.gridResize.setIsResizing(!0),n.gridResize.setResizingStartClientX(t.clientX),n.gridResize.setResizingColNumber(e.columnIndex+o.skipColumns)},style:{zIndex:(null!=(i=n.props.zIndex)?i:0)+2},className:"absolute -right-1 top-0 w-1.5 h-full cursor-ew-resize"}),g?(0,a.jsxs)("div",{style:{pointerEvents:"none",boxSizing:n.isEditing?"content-box":"border-box",zIndex:null!=(r=n.props.zIndex)?r:1},className:"absolute ".concat(n.isEditing?"-top-0.5 -left-0.5 border-blue-400 border-2":"top-0 left-0 border-blue-600 border-1","  w-full h-full border-solid"),children:[null!=m.errorMessage&&(0,a.jsx)("div",{className:"w-full h-full absolute",children:(0,a.jsx)(Y,{isEditing:g&&n.isEditing,errorMessage:m.errorMessage})}),(0,a.jsx)("div",{className:"w-full h-full ".concat(n.isEditing?"border-2 border-solid border-blue-600 flex items-center":""," "),children:n.isEditing&&(0,a.jsx)(K,{rightAlign:null!=v&&v})})]}):"",null!=m.custom?m.custom(p,f,m.data):"",null==m.custom&&(0,a.jsx)("span",{className:" overflow-hidden px-1",children:""===h.replaceAll(" ","")?"\xa0":h})]},e.columnIndex)})},Q=(0,u.forwardRef)((e,t)=>{var l;let[s,i]=(0,u.useState)(void 0),[r,n]=(0,u.useState)(!1),[o,d]=(0,u.useState)(""),c=(0,u.useRef)(!1),m=(0,u.useRef)(!1),f=(0,u.useRef)(null),p=(0,u.useRef)(null),h=(0,u.useRef)(null),x=(0,u.useRef)(null),v=(0,u.useRef)(null);(e=>{if(e.rows.length>0){if(void 0===e.rows[0].columns||0===e.rows[0].columns.length)throw Error("DataGrid: rows must contain columns");let t=e.rows[0].columns.length;for(let l of e.rows){if(null==l.columns)throw Error("DataGrid: rows must contain columns");if(l.columns.length!==t)throw Error("DataGrid: rows must contain the same number of columns")}if("number"!=typeof e.columnWidths&&e.columnWidths.length!==t)throw Error("DataGrid: columnWidths ".concat(e.columnWidths," must be the same length as the number of columns ").concat(t))}})(e);let y=(0,u.useCallback)(e=>{let{scrollLeft:t,scrollTop:l,scrollUpdateWasRequested:a}=e;if(!a){var s,i;null==(s=h.current)||s.scrollTo({scrollLeft:0,scrollTop:l}),null==(i=x.current)||i.scrollTo({scrollLeft:t,scrollTop:0})}},[]),g=(e=>{let[t,l]=(0,u.useState)(!1),[a,s]=(0,u.useState)(void 0),[i,r]=(0,u.useState)(void 0),[n,o]=(0,u.useState)(e.columnWidths),[d,c]=(0,u.useState)(e.columnWidths),[m,f]=(0,u.useState)({startX:0,startY:0,endY:0,clientX:0,clientY:0}),p=()=>{if(t){if(l(!1),null==i)return;let e=m.clientX-a,t=[...d],s=t[i]+e;s<32&&(s=32),t[i]=s,c(t)}};return(0,u.useEffect)(()=>(window.addEventListener("mouseup",p),()=>{window.removeEventListener("mouseup",p)})),(0,u.useEffect)(()=>{if(e.columnWidths.length!==n.length)o(e.columnWidths),c(e.columnWidths);else for(let t=0;t<e.columnWidths.length;t++)if(e.columnWidths[t]!==n[t]){o(e.columnWidths),c(e.columnWidths);break}},[e.columnWidths]),{isResizing:t,setIsResizing:l,resizingStartClientX:a,setResizingStartClientX:s,resizingColNumber:i,setResizingColNumber:r,columnWidths:d,setColWidths:c,onMouseMove:l=>{if(t&&l.preventDefault(),!e.divRef.current)return;let a=e.divRef.current.getBoundingClientRect();f({startX:l.clientX-a.left,startY:0,endY:a.height,clientX:l.clientX,clientY:l.clientY})},mousePosition:m}})({rows:e.rows,divRef:f,columnWidths:"number"==typeof e.columnWidths&&e.rows.length>0?Array(e.rows[0].columns.length).fill(e.columnWidths):"object"==typeof e.columnWidths?e.columnWidths:[]}),b=e.rows.length>0&&e.rows[0].columns.length>0?e.rows[0].columns.length:0,j=g.columnWidths.slice(0,null!=(l=e.snapColumns)?l:0).reduce((e,t)=>e+t,0),N=!1,w=(t,l,a)=>{if(!1!==e.editable&&((null==l?void 0:l.key)==="Shift"&&(c.current=!0),(null==l?void 0:l.key)==="Control"&&(m.current=!0),!N)){if(void 0===l)return void I(l,a);if(s){let t=e.rows[s.row].columns[s.col];if("Delete"===l.key&&(null!=e.onDelete&&e.onDelete(o,s,t.data),null!=t.onDelete&&t.onDelete(o,s,t.data)),"Backspace"===l.key&&(null!=e.onBackspace&&e.onBackspace(o,s,t.data),null!=t.onBackspace&&t.onBackspace(o,s,t.data)),("ArrowDown"===l.key||"ArrowUp"===l.key||"ArrowLeft"===l.key||"ArrowRight"===l.key||"Enter"===l.key||"Escape"===l.key||"Tab"===l.key)&&l.preventDefault(),"ArrowDown"===l.key){if(s.row===e.rows.length-1)return;C(),i({row:s.row+1,col:s.col}),N=!0}else if("ArrowUp"===l.key){if(0===s.row)return;C(),i({row:s.row-1,col:s.col}),N=!0}else if("ArrowLeft"===l.key){if(0===s.col)return;C(),i({row:s.row,col:s.col-1}),N=!0}else if("ArrowRight"===l.key){if(s.col===e.rows[0].columns.length-1)return;C(),i({row:s.row,col:s.col+1}),N=!0}else if("Enter"===l.key){if(C(),s.row===e.rows.length-1)return;i({row:s.row+1,col:s.col})}else if("Escape"===l.key)E();else if("Tab"===l.key){if(C(),c.current){if(0===s.col)return;i({row:s.row,col:s.col-1})}else{if(s.col===e.rows[0].columns.length-1)return;i({row:s.row,col:s.col+1})}l.stopPropagation()}else m.current||I(l)}}},I=(t,l)=>{if(!r&&s){let a=e.rows[s.row].columns[s.col].isReadOnly,i=e.rows[s.row].columns[s.col].isDisabled;if(a||i)return;null==t&&(d(null!=l?l:""),n(!0)),null!=t&&1===t.key.length&&(d(""),n(!0))}N=!1},C=()=>{if(s&&r){let t=e.rows[s.row].columns[s.col];null!=e.onEndEdit&&e.onEndEdit(o,s,t.data),null!=t.onEndEdit&&t.onEndEdit(o,s,t.data),d(""),n(!1)}},E=()=>{d(""),n(!1)};(0,u.useEffect)(()=>{let e=e=>{w(window,e)},t=e=>{"Shift"===e.key&&(c.current=!1),"Control"===e.key&&(m.current=!1)};return window.addEventListener("keydown",e),window.addEventListener("keyup",t),()=>{window.removeEventListener("keydown",e),window.removeEventListener("keyup",t)}},[s,r,o]);let A=e=>{f.current&&!f.current.contains(e.target)&&i(void 0)},T=()=>{var e,t,l,a;null==p||null==(e=p.current)||e.resetAfterColumnIndex(0),null==(t=h.current)||t.resetAfterColumnIndex(0),null==(l=x.current)||l.resetAfterColumnIndex(0),null==(a=v.current)||a.resetAfterColumnIndex(0)};(0,u.useImperativeHandle)(t,()=>({reset:()=>{T()},activeCell:s,setActiveCell:e=>{i(e)},isEditing:r,editValue:o,setEditValue:e=>{d(e)}})),(0,u.useEffect)(()=>{T()},[g.columnWidths]),(0,u.useEffect)(()=>(document.addEventListener("click",A,!0),()=>{document.removeEventListener("click",A,!0)}),[]);let S="";if(null!=e.columnWidths&&"object"==typeof e.columnWidths)for(let e=0;e<g.columnWidths.length;e++)S+=g.columnWidths[e];else S=e.columnWidths.toString();return(0,a.jsxs)("div",{ref:f,className:"w-full h-full relative",onMouseMove:e=>g.onMouseMove(e),children:[g.isResizing&&(0,a.jsx)("div",{style:{top:g.mousePosition.startY,left:g.mousePosition.startX,border:"1px solid black",width:1,height:g.mousePosition.endY,zIndex:null==e.zIndex?2:e.zIndex+2},className:"absolute"}),(0,a.jsx)(z.Ay,{children:t=>{var l,u,c,m,f,N,I,E,A;let{height:T,width:S}=t;return(0,a.jsx)(G.Provider,{value:{props:e,activeCell:null!=s&&null!=e.rows[s.row]&&null!=e.rows[s.row].columns[s.col]?e.rows[s.row].columns[s.col]:void 0,editValue:o,setEditValue:d,activeCellLocation:s,setActiveCellLocation:i,isEditing:r,setIsEditing:n,onKeyDown:w,onEndEdit:C,gridResize:g},children:(0,a.jsxs)("div",{style:{display:"flex",flexDirection:"row",width:S,height:T},children:[null!=e.snapColumns&&e.snapColumns>0&&(0,a.jsxs)("div",{style:{width:j,height:"100%"},children:[null!=e.snapRows&&e.snapRows>0&&(0,a.jsx)(J.Provider,{value:{skipColumns:0,skipRows:0},children:(0,a.jsx)(H.cB,{ref:p,columnCount:e.snapColumns,rowCount:e.snapRows,columnWidth:e=>g.columnWidths[e],rowHeight:e=>30,height:30*e.snapRows,width:j,style:{overflow:"hidden",...e.styletl},className:" border border-solid border-gray-500",children:$})}),(0,a.jsx)(J.Provider,{value:{skipColumns:0,skipRows:null!=(l=e.snapRows)?l:0},children:(0,a.jsx)(H.cB,{ref:h,columnCount:e.snapColumns,rowCount:e.rows.length-(null!=(u=e.snapRows)?u:0),columnWidth:e=>g.columnWidths[e],rowHeight:e=>30,height:T-(null!=(c=e.snapRows)?c:0)*30,width:j,style:{overflow:"hidden",...e.stylebl},className:" border border-solid border-gray-500",children:$})})]}),(0,a.jsxs)("div",{className:"w-full h-full flex flex-col",children:[null!=e.snapRows&&e.snapRows>0&&(0,a.jsx)(J.Provider,{value:{skipColumns:null!=(m=e.snapColumns)?m:0,skipRows:0},children:(0,a.jsx)(H.cB,{ref:x,columnCount:b-(null!=(f=e.snapColumns)?f:0),rowCount:e.snapRows,columnWidth:t=>{var l;return g.columnWidths[t+(null!=(l=e.snapColumns)?l:0)]},rowHeight:e=>30,height:30*e.snapRows,width:null!=e.snapColumns&&e.snapColumns>0?S-j:S,style:{overflow:"hidden",...e.styletr},className:" border border-solid border-gray-500",children:$})}),(0,a.jsx)(J.Provider,{value:{skipColumns:null!=(N=e.snapColumns)?N:0,skipRows:null!=(I=e.snapRows)?I:0},children:(0,a.jsx)(H.cB,{ref:v,onScroll:y,columnCount:b-(null!=(E=e.snapColumns)?E:0),rowCount:e.rows.length-(null!=(A=e.snapRows)?A:0),columnWidth:t=>{var l;return console.log(e.snapColumns),g.columnWidths[t+(null!=(l=e.snapColumns)?l:0)]},rowHeight:e=>30,height:null!=e.snapRows&&e.snapRows>0?T-30*e.snapRows:T,width:null!=e.snapColumns&&e.snapColumns>0?S-j:S,style:{...e.style},className:"thin-scrollbar-x border border-solid border-gray-500",children:$})})]})]})})}})]},"".concat(e.snapColumns,"-").concat(e.snapRows,"-").concat(S))});Q.displayName="DataGrid";let Z=e=>{let[t,l]=(0,u.useState)([]),s=(t,i,r,n)=>{let o=!n;if(""===r&&o){var d;let t={RoleId:e.roleId,PermissionId:null==(d=e.state.allPermissions.find(e=>e.Name===i))?void 0:d.PermissionId,Permission:"permission.".concat(i)};e.setState(e=>({...e,createRolePermissions:[...e.createRolePermissions,t],deleteRolePermissions:e.deleteRolePermissions.filter(e=>e.Permission!=="permission.".concat(i))}))}else""!==r||o?""===r||o?""!==r&&o&&e.setState(e=>({...e,createRolePermissions:e.createRolePermissions.filter(e=>e.PermissionId!==r||e.Permission!=="permission.".concat(i)),deleteRolePermissions:e.deleteRolePermissions.filter(e=>e.RolePermissionId!==r)})):e.setState(e=>({...e,createRolePermissions:e.createRolePermissions.filter(e=>e.PermissionId!==r||e.Permission!=="permission.".concat(i)),deleteRolePermissions:[...e.deleteRolePermissions,{RolePermissionId:r}]})):e.setState(e=>({...e,createRolePermissions:e.createRolePermissions.filter(e=>e.Permission!=="permission.".concat(i))}));l(e=>{let l=[...e],n=l[t.row],d={...n.columns[t.col]};return d.custom=(e,t)=>(0,a.jsx)(O,{icon:o?"system":"none",onClick:()=>s(t,i,r,o)}),n.columns[t.col]=d,l})},i=(t,s,r,n,o)=>{let d="none",u=t;t.endsWith("NONE")?(u=u.substring(0,t.length-4).concat("USER"),d="user"):t.endsWith("USER")?(u=u.substring(0,t.length-4).concat("TEAM"),d="team"):t.endsWith("TEAM")?(u=u.substring(0,t.length-4).concat("SYSTEM"),d="system"):t.endsWith("SYSTEM")&&(u=u.substring(0,t.length-6).concat("NONE"),d="none"),"none"===d&&null!=r&&e.setState(e=>({...e,deleteRolePermissions:[...e.deleteRolePermissions,{RolePermissionId:r}],updateRolePermissions:e.updateRolePermissions.filter(e=>e.RolePermissionId!==r),createRolePermissions:e.createRolePermissions.filter(e=>e.PermissionId!==r)})),"none"!==d&&null==r&&e.setState(t=>{var l;return{...t,createRolePermissions:[...t.createRolePermissions.filter(e=>e.Permission!=="".concat(n,".").concat(o)),{RolePermissionId:"",RoleId:e.roleId,PermissionId:null==(l=e.state.allPermissions.find(e=>e.Name===u))?void 0:l.PermissionId,Permission:"".concat(n,".").concat(o)}]}}),"none"!==d&&null!=r&&e.setState(t=>{var l;return{...t,updateRolePermissions:[...t.updateRolePermissions.filter(e=>e.RolePermissionId!==r),{RolePermissionId:r,PermissionId:null==(l=e.state.allPermissions.find(e=>e.Name===u))?void 0:l.PermissionId}],deleteRolePermissions:t.deleteRolePermissions.filter(e=>e.RolePermissionId!==r)}}),l(e=>e.map((e,t)=>({columns:e.columns.map((e,l)=>t===s.row&&l===s.col?{...e,custom:(e,t)=>(0,a.jsx)(O,{icon:d,onClick:()=>i(u,t,r,n,o)})}:e)})))};return{toggleBinaryPermission:s,toggleTablePermission:i,rows:t,setRows:l}},ee=e=>{let t=Z(e),l=(e,t,l)=>{var a,s,i,r,n;let o="none",d=e.find(e=>{var a;return null==(a=e.Permission)?void 0:a.startsWith("TABLE_".concat(t,"_").concat(l))});return null==d?{permissionLevel:"none",RolePermissionId:null}:(((null==(a=d.Permission)?void 0:a.endsWith("IMPORT"))||(null==(s=d.Permission)?void 0:s.endsWith("EXPORT")))&&(o="system"),(null==(i=d.Permission)?void 0:i.endsWith("USER"))&&(o="user"),(null==(r=d.Permission)?void 0:r.endsWith("TEAM"))&&(o="team"),(null==(n=d.Permission)?void 0:n.endsWith("SYSTEM"))&&(o="system"),{permissionLevel:o,RolePermissionId:d.RolePermissionId})};return(0,u.useEffect)(()=>{((s,i)=>{let r=[];for(let n of(r.push({columns:[{value:"Entity",isReadOnly:!0,style:{}},{value:"Create",isReadOnly:!0,style:{justifyContent:"center"}},{value:"Read",isReadOnly:!0,style:{justifyContent:"center"}},{value:"Update",isReadOnly:!0,style:{justifyContent:"center"}},{value:"Delete",isReadOnly:!0,style:{justifyContent:"center"}},{value:"Assign",isReadOnly:!0,style:{justifyContent:"center"}},{value:"Import",isReadOnly:!0,style:{justifyContent:"center"}},{value:"Export",isReadOnly:!0,style:{justifyContent:"center"}}]}),i)){let i=l(s,n.tableName,"CREATE"),o=l(s,n.tableName,"READ"),d=l(s,n.tableName,"UPDATE"),u=l(s,n.tableName,"DELETE"),c=l(s,n.tableName,"ASSIGN"),m=l(s,n.tableName,"IMPORT"),f=l(s,n.tableName,"EXPORT"),p=e.roleId!==er,h={columns:[{value:n.tableName,isReadOnly:!0,style:{border:"none",userSelect:"none"}},{custom:(e,l)=>(0,a.jsx)(O,{icon:i.permissionLevel,onClick:()=>p&&t.toggleTablePermission("TABLE_".concat(n.tableName,"_CREATE_").concat(i.permissionLevel.toUpperCase()),l,i.RolePermissionId,n.tableName,"CREATE")}),isReadOnly:!0,style:{justifyContent:"center",border:"none",userSelect:"none"}},{custom:(e,l)=>(0,a.jsx)(O,{icon:o.permissionLevel,onClick:()=>p&&t.toggleTablePermission("TABLE_".concat(n.tableName,"_READ_").concat(o.permissionLevel.toUpperCase()),l,o.RolePermissionId,n.tableName,"READ")}),isReadOnly:!0,style:{justifyContent:"center",border:"none",userSelect:"none"}},{custom:(e,l)=>(0,a.jsx)(O,{icon:d.permissionLevel,onClick:()=>p&&t.toggleTablePermission("TABLE_".concat(n.tableName,"_UPDATE_").concat(d.permissionLevel.toUpperCase()),l,d.RolePermissionId,n.tableName,"UPDATE")}),isReadOnly:!0,style:{justifyContent:"center",border:"none",userSelect:"none"}},{custom:(e,l)=>(0,a.jsx)(O,{icon:u.permissionLevel,onClick:()=>p&&t.toggleTablePermission("TABLE_".concat(n.tableName,"_DELETE_").concat(u.permissionLevel.toUpperCase()),l,u.RolePermissionId,n.tableName,"DELETE")}),isReadOnly:!0,style:{justifyContent:"center",border:"none",userSelect:"none"}},{custom:(e,l)=>(0,a.jsx)(O,{icon:c.permissionLevel,onClick:()=>p&&t.toggleTablePermission("TABLE_".concat(n.tableName,"_ASSIGN_").concat(c.permissionLevel.toUpperCase()),l,c.RolePermissionId,n.tableName,"ASSIGN")}),isReadOnly:!0,style:{justifyContent:"center",border:"none",userSelect:"none"}},{custom:(e,l)=>(0,a.jsx)(O,{icon:m.permissionLevel,onClick:()=>{var e;return p&&t.toggleBinaryPermission(l,"TABLE_".concat(n.tableName,"_IMPORT"),null!=(e=m.RolePermissionId)?e:"","none"!==m.permissionLevel)}}),isReadOnly:!0,style:{justifyContent:"center",border:"none",userSelect:"none"}},{custom:(e,l)=>(0,a.jsx)(O,{icon:f.permissionLevel,onClick:()=>{var e;return p&&t.toggleBinaryPermission(l,"TABLE_".concat(n.tableName,"_EXPORT"),null!=(e=f.RolePermissionId)?e:"","none"!==f.permissionLevel)}}),isReadOnly:!0,style:{justifyContent:"center",border:"none",userSelect:"none"}}]};r.push(h)}t.setRows(r)})(e.state.rolePermissions,e.state.tables)},[e.state.rolePermissions,e.state.tables]),(0,a.jsx)(Q,{rows:t.rows,columnWidths:[300,100,100,100,100,100,100,100],snapRows:1,snapColumns:1,editable:!1,style:{borderBottomRightRadius:"0.2rem"},styletr:{borderTopRightRadius:"0.2rem"},styletl:{borderTopLeftRadius:"0.2rem"},stylebl:{borderBottomLeftRadius:"0.2rem"}})},et=e=>{let t=Z(e);return(0,u.useEffect)(()=>{(()=>{let l=[];l.push({columns:[{value:"Permission Name",isReadOnly:!0},{value:"Access",isReadOnly:!0,style:{justifyContent:"center"}}]});let s=e.roleId!==er;for(let i of e.state.allPermissions){if("System"===i.Tag)continue;let r="",n=!1;for(let t of e.state.rolePermissions)if(t.PermissionId===i.PermissionId){r=t.RolePermissionId,n=!0;break}let o={columns:[{value:i.Name,isReadOnly:!0,style:{border:"none"}},{custom:(e,l)=>(0,a.jsx)(O,{icon:r?"system":"none",onClick:()=>s&&t.toggleBinaryPermission(l,i.Name,r,n)}),style:{justifyContent:"center",border:"none",userSelect:"none"}}]};l.push(o)}t.setRows(l)})()},[]),(0,a.jsx)(Q,{rows:t.rows,columnWidths:[300,150],snapColumns:1,snapRows:1,editable:!1,style:{borderBottomRightRadius:"0.2rem"},styletr:{borderTopRightRadius:"0.2rem"},styletl:{borderTopLeftRadius:"0.2rem"},stylebl:{borderBottomLeftRadius:"0.2rem"}})},el=e=>{let t=Z(e);return(0,u.useEffect)(()=>{(()=>{let l=[];l.push({columns:[{value:"Permission Name",isReadOnly:!0},{value:"Access",isReadOnly:!0,style:{justifyContent:"center"}}]});let s=e.roleId!==er;for(let i of e.state.allPermissions){if("System"!==i.Tag||!i.Name.startsWith("JOB_"))continue;let r="",n=!1;for(let t of e.state.rolePermissions)if(t.PermissionId===i.PermissionId){r=t.RolePermissionId,n=!0;break}let o={columns:[{value:i.Name,isReadOnly:!0,style:{border:"none"}},{custom:(e,l)=>(0,a.jsx)(O,{icon:r?"system":"none",onClick:()=>s&&t.toggleBinaryPermission(l,i.Name,r,n)}),style:{justifyContent:"center",border:"none",userSelect:"none"}}]};l.push(o)}t.setRows(l)})()},[]),(0,a.jsx)(Q,{rows:t.rows,columnWidths:[300,150],snapColumns:1,snapRows:1,editable:!1,style:{borderBottomRightRadius:"0.2rem"},styletr:{borderTopRightRadius:"0.2rem"},styletl:{borderTopLeftRadius:"0.2rem"},stylebl:{borderBottomLeftRadius:"0.2rem"}})},ea=e=>{let t=Z(e);return(0,u.useEffect)(()=>{(()=>{let l=[];l.push({columns:[{value:"Permission Name",isReadOnly:!0},{value:"Access",isReadOnly:!0,style:{justifyContent:"center"}}]});let s=e.roleId!==er;for(let i of e.state.allPermissions){if("System"!==i.Tag||i.Name.startsWith("TABLE_")||i.Name.startsWith("JOB_")||!(i.Name.startsWith("ACTION_ADMIN")||i.Name.startsWith("ACTION_TABLE")||i.Name.startsWith("ACCESS_ADMIN")))continue;let r="",n=!1;for(let t of e.state.rolePermissions)if(t.PermissionId===i.PermissionId){r=t.RolePermissionId,n=!0;break}let o={columns:[{value:i.Name,isReadOnly:!0,style:{border:"none"}},{custom:(e,l)=>(0,a.jsx)(O,{icon:r?"system":"none",onClick:()=>s&&t.toggleBinaryPermission(l,i.Name,r,n)}),style:{justifyContent:"center",border:"none",userSelect:"none"}}]};l.push(o)}t.setRows(l)})()},[]),(0,a.jsx)(Q,{rows:t.rows,columnWidths:[300,150],snapColumns:1,snapRows:1,editable:!1,style:{borderBottomRightRadius:"0.2rem"},styletr:{borderTopRightRadius:"0.2rem"},styletl:{borderTopLeftRadius:"0.2rem"},stylebl:{borderBottomLeftRadius:"0.2rem"}})},es=e=>{let t=Z(e);return(0,u.useEffect)(()=>{(()=>{let l=[];l.push({columns:[{value:"Permission Name",isReadOnly:!0},{value:"Access",isReadOnly:!0,style:{justifyContent:"center"}}]});let s=e.roleId!==er;for(let i of e.state.allPermissions){if("System"!==i.Tag||i.Name.startsWith("ACTION_ADMIN")||i.Name.startsWith("ACTION_TABLE")||i.Name.startsWith("ACCESS_ADMIN")||!i.Name.startsWith("ACTION_"))continue;let r="",n=!1;for(let t of e.state.rolePermissions)if(t.PermissionId===i.PermissionId){r=t.RolePermissionId,n=!0;break}let o={columns:[{value:i.Name,isReadOnly:!0,style:{border:"none"}},{custom:(e,l)=>(0,a.jsx)(O,{icon:r?"system":"none",onClick:()=>s&&t.toggleBinaryPermission(l,i.Name,r,n)}),style:{justifyContent:"center",border:"none",userSelect:"none"}}]};l.push(o)}t.setRows(l)})()},[]),(0,a.jsx)(Q,{rows:t.rows,columnWidths:[300,150],snapColumns:1,snapRows:1,editable:!1,style:{borderBottomRightRadius:"0.2rem"},styletr:{borderTopRightRadius:"0.2rem"},styletl:{borderTopLeftRadius:"0.2rem"},stylebl:{borderBottomLeftRadius:"0.2rem"}})},ei=e=>{let t=Z(e);return(0,u.useEffect)(()=>{(()=>{let l=[];l.push({columns:[{value:"Hub Name",isReadOnly:!0},{value:"Access",isReadOnly:!0,style:{justifyContent:"center"}}]});let s=e.roleId!==er;for(let i of e.state.allPermissions){if(!i.Name.startsWith("HUB_"))continue;let r="",n=!1;for(let t of e.state.rolePermissions)if(t.PermissionId===i.PermissionId){r=t.RolePermissionId,n=!0;break}let o={columns:[{value:i.Name,isReadOnly:!0,style:{border:"none"}},{custom:(e,l)=>(0,a.jsx)(O,{icon:r?"system":"none",onClick:()=>s&&t.toggleBinaryPermission(l,i.Name,r,n)}),style:{justifyContent:"center",border:"none",userSelect:"none"}}]};l.push(o)}t.setRows(l)})()},[]),(0,a.jsx)(Q,{rows:t.rows,columnWidths:[300,150],snapColumns:1,snapRows:1,editable:!1,style:{borderBottomRightRadius:"0.2rem"},styletr:{borderTopRightRadius:"0.2rem"},styletl:{borderTopLeftRadius:"0.2rem"},stylebl:{borderBottomLeftRadius:"0.2rem"}})},er="64589861-0481-4dbb-a96f-9b8b6546c40d",en=e=>{let t=(0,i.A)(),[l,s]=u.useState(!0),[n,o]=(0,u.useState)({tables:[],allPermissions:[],rolePermissions:[],createRolePermissions:[],updateRolePermissions:[],deleteRolePermissions:[],isLoaded:!1}),[d,c]=(0,u.useState)("entities"),m=async()=>{if(null==e.roleId)return void s(!1);let l=await t.tables();if(!l.succeeded)return;let a=new M.Ay(["*"]).top(999999).from("Permission").orderBy("Name","asc").distinct().toReadRequest(),i=await t.read(a),r=new M.Ay(["*"]).top(999999).from("RolePermission").where("RoleId","==",e.roleId).distinct().toReadRequest(),n=await t.read(r);n.succeeded&&(o(e=>({...e,tables:l.data,allPermissions:i.data.results,rolePermissions:n.data.results,isLoaded:!0})),s(!1))},f=(0,u.useCallback)(async()=>{let e=n.createRolePermissions.map(e=>({tableName:"RolePermission",fields:{PermissionId:e.PermissionId,RoleId:e.RoleId}})),l=n.updateRolePermissions.map(e=>({tableName:"RolePermission",fields:e})),a=n.deleteRolePermissions.map(e=>({tableName:"RolePermission",fields:e}));return 0===e.length&&0===l.length&&0===a.length?{continue:!0}:(s(!0),(await t.bulk({creates:e,updates:l,deletes:a})).succeeded)?(s(!1),{continue:!0}):(s(!1),{continue:!1})},[n.deleteRolePermissions,n.createRolePermissions,n.updateRolePermissions]);return(0,u.useEffect)(()=>{m()},[]),e.formBuilder.onPreSaveRef.current=f,(0,a.jsxs)("div",{className:"w-full flex flex-col gap-4",children:[(0,a.jsx)(W.A,{name:"Name"}),(0,a.jsxs)("div",{className:"w-full h-[500px] relative",children:[l&&(0,a.jsx)("div",{className:"w-full h-full absolute flex justify-center items-center",children:(0,a.jsx)(r.a,{})}),null==e.roleId&&(0,a.jsx)("div",{className:"w-full h-full flex justify-center items-center",children:"Save the role to set permissions"}),null!=e.roleId&&n.isLoaded&&(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)(U.t,{defaultValue:"entities",className:"h-full flex flex-col",onChange:c,children:[(0,a.jsxs)(U.t.List,{children:[(0,a.jsx)(U.t.Tab,{value:"entities",children:"Entities"}),(0,a.jsx)(U.t.Tab,{value:"actions",children:"Actions"}),(0,a.jsx)(U.t.Tab,{value:"jobs",children:"Jobs"}),(0,a.jsx)(U.t.Tab,{value:"hubs",children:"Hubs"}),(0,a.jsx)(U.t.Tab,{value:"system",children:"System"}),(0,a.jsx)(U.t.Tab,{value:"permissions",children:"Custom Permissions"})]}),(0,a.jsx)(U.t.Panel,{value:"entities",pt:"xs",className:"h-full",children:(0,a.jsx)("div",{className:"w-full h-full",children:(0,a.jsx)(ee,{roleId:e.roleId,state:n,setState:o})})}),(0,a.jsx)(U.t.Panel,{value:"actions",pt:"xs",className:"h-full",children:(0,a.jsx)("div",{className:"w-full h-full",children:(0,a.jsx)(es,{roleId:e.roleId,state:n,setState:o})})}),(0,a.jsx)(U.t.Panel,{value:"permissions",pt:"xs",className:"h-full",children:(0,a.jsx)("div",{className:"w-full h-full",children:(0,a.jsx)(et,{roleId:e.roleId,state:n,setState:o})})}),(0,a.jsx)(U.t.Panel,{value:"jobs",pt:"xs",className:"h-full",children:(0,a.jsx)("div",{className:"w-full h-full",children:(0,a.jsx)(el,{roleId:e.roleId,state:n,setState:o})})}),(0,a.jsx)(U.t.Panel,{value:"hubs",pt:"xs",className:"h-full",children:(0,a.jsx)("div",{className:"w-full h-full",children:(0,a.jsx)(ei,{roleId:e.roleId,state:n,setState:o})})}),(0,a.jsx)(U.t.Panel,{value:"system",pt:"xs",className:"h-full",children:(0,a.jsx)("div",{className:"w-full h-full",children:(0,a.jsx)(ea,{roleId:e.roleId,state:n,setState:o})})})]})})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsxs)("div",{className:"flex gap-5 w-full",children:[null!=e.roleId&&null!=d&&"entities"===d&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("span",{className:"flex text-sm gap-1 items-center",children:[(0,a.jsx)(O,{icon:"none"}),"None"]}),(0,a.jsxs)("span",{className:"flex text-sm gap-1 items-center",children:[(0,a.jsx)(O,{icon:"user"}),"User"]}),(0,a.jsxs)("span",{className:"flex text-sm gap-1 items-center",children:[(0,a.jsx)(O,{icon:"team"}),"Team"]}),(0,a.jsxs)("span",{className:"flex text-sm gap-1 items-center",children:[(0,a.jsx)(O,{icon:"system"}),"System"]})]}),null!=e.roleId&&null!=d&&("permissions"===d||"system"===d||"hubs"===d)&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("span",{className:"flex text-sm gap-1 items-center whitespace-nowrap",children:[(0,a.jsx)(O,{icon:"none"}),"Doesn't have permission"]}),(0,a.jsxs)("span",{className:"flex text-sm gap-1 items-center whitespace-nowrap",children:[(0,a.jsx)(O,{icon:"system"}),"Has permission"]})]}),null!=e.roleId&&null!=d&&"actions"===d&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("span",{className:"flex text-sm gap-1 items-center whitespace-nowrap",children:[(0,a.jsx)(O,{icon:"none"}),"Can't execute action"]}),(0,a.jsxs)("span",{className:"flex text-sm gap-1 items-center whitespace-nowrap",children:[(0,a.jsx)(O,{icon:"system"}),"Can execute action"]})]}),null!=e.roleId&&null!=d&&"jobs"===d&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("span",{className:"flex text-sm gap-1 items-center whitespace-nowrap",children:[(0,a.jsx)(O,{icon:"none"}),"Can't start job"]}),(0,a.jsxs)("span",{className:"flex text-sm gap-1 items-center whitespace-nowrap",children:[(0,a.jsx)(O,{icon:"system"}),"Can start job"]})]}),"UPDATE"===e.formBuilder.operation&&(0,a.jsx)("div",{className:"w-full flex justify-start items-center pr-2",children:(0,a.jsx)(k,{value:e.formBuilder.data["".concat(e.formBuilder.tableName,"Id")]})})]}),(0,a.jsx)("div",{children:(0,a.jsx)(V.A,{})})]})]})},eo=()=>{var e,t,l,s,i;let r=eX();return(0,a.jsx)(a.Fragment,{children:r.tables.filter(e=>["User","Role","Team","Permission"].includes(e.tableName)).length>0&&!(null==(e=r.props.hiddenMenuItems)?void 0:e.includes("Security"))&&(0,a.jsxs)(C.k,{label:"Security",leftSection:(0,a.jsx)(F.A,{size:16,strokeWidth:2,color:r.color}),children:[r.tables.find(e=>"User"===e.tableName)&&!(null==(t=r.props.hiddenMenuItems)?void 0:t.includes("Users"))&&(0,a.jsx)(C.k,{label:"Users",onClick:()=>r.setActiveComponent({component:(0,a.jsx)("div",{className:"w-full h-full flex flex-col",children:(0,a.jsx)("div",{className:"grow h-1",children:(0,a.jsx)(T,{tableName:"User",maxResults:100,formMaxWidth:72,formAppendButton:e=>(0,a.jsx)(a.Fragment,{children:"UPDATE"===e.operation&&(0,a.jsx)("div",{className:"w-full flex justify-start items-center gap-1",children:(0,a.jsx)(k,{value:e.data["".concat(e.tableName,"Id")]})})}),appendCustomForm:e=>void 0===e.snapshot?(0,a.jsx)(a.Fragment,{}):(0,a.jsxs)("div",{className:" h-96 mt-5 flex justify-stretch gap-4",children:[(0,a.jsx)(T,{title:"Roles",tableName:"UserRole",fields:["RoleId"],filters:[{field:"UserId",value:e.snapshot.UserId}],formZIndex:1e3,formFields:["RoleId"],formFieldDefaults:[{field:"UserId",value:e.snapshot.UserId}],formLookupQueries:[{field:"RoleId",except:[{fromField:"RoleId",query:{tableName:"UserRole",fields:["RoleId"],filters:[{field:"UserId",operator:"==",value:e.snapshot.UserId}]}}]}]}),(0,a.jsx)(T,{title:"Teams",tableName:"TeamUser",fields:["TeamId"],filters:[{field:"UserId",value:e.snapshot.UserId}],formZIndex:1e3,formFields:["TeamId"],formFieldDefaults:[{field:"UserId",value:e.snapshot.UserId}],formLookupQueries:[{field:"TeamId",except:[{fromField:"TeamId",query:{tableName:"TeamUser",fields:["TeamId"],filters:[{field:"UserId",operator:"==",value:e.snapshot.UserId}]}}]}]})]})})})})}),leftSection:(0,a.jsx)(L.A,{size:16,strokeWidth:2,color:r.color})}),r.tables.find(e=>"Team"===e.tableName)&&!(null==(l=r.props.hiddenMenuItems)?void 0:l.includes("Teams"))&&(0,a.jsx)(C.k,{label:"Teams",onClick:()=>r.setActiveComponent({component:(0,a.jsx)("div",{className:"w-full h-full flex flex-col",children:(0,a.jsx)("div",{className:"grow h-1",children:(0,a.jsx)(T,{tableName:"Team",formCloseOnCreate:!1,maxResults:100,formMaxWidth:72,formAppendButton:e=>(0,a.jsx)(a.Fragment,{children:"UPDATE"===e.operation&&(0,a.jsx)("div",{className:"w-full flex justify-start items-center gap-1",children:(0,a.jsx)(k,{value:e.data["".concat(e.tableName,"Id")]})})}),appendCustomForm:e=>void 0===e.snapshot?(0,a.jsx)(a.Fragment,{}):(0,a.jsxs)("div",{className:" h-96 mt-5 flex justify-stretch gap-4",children:[(0,a.jsx)(T,{title:"Roles",tableName:"TeamRole",fields:["RoleId"],filters:[{field:"TeamId",value:e.snapshot.TeamId}],formZIndex:1e3,formFields:["RoleId"],formFieldDefaults:[{field:"TeamId",value:e.snapshot.TeamId}],formLookupQueries:[{field:"RoleId",except:[{fromField:"RoleId",query:{tableName:"TeamRole",fields:["RoleId"],filters:[{field:"TeamId",operator:"==",value:e.snapshot.TeamId}]}}]}]}),(0,a.jsx)(T,{title:"Users",tableName:"TeamUser",fields:["UserId"],filters:[{field:"TeamId",value:e.snapshot.TeamId}],formZIndex:1e3,formFields:["UserId"],formFieldDefaults:[{field:"TeamId",value:e.snapshot.TeamId}],formLookupQueries:[{field:"UserId",except:[{fromField:"UserId",query:{tableName:"TeamUser",fields:["UserId"],filters:[{field:"TeamId",operator:"==",value:e.snapshot.TeamId}]}}]}]})]})})})})}),leftSection:(0,a.jsx)(B.A,{size:16,strokeWidth:2,color:r.color})}),r.tables.find(e=>"Role"===e.tableName)&&!(null==(s=r.props.hiddenMenuItems)?void 0:s.includes("Roles"))&&(0,a.jsx)(C.k,{label:"Roles",onClick:()=>{r.setActiveComponent({component:(0,a.jsx)(T,{tableName:"Role",formMaxWidth:72,maxResults:100,formCloseOnCreate:!1,customForm:e=>{var t,l;return(0,a.jsx)(en,{roleId:null==(t=e.snapshot)?void 0:t.RoleId,formBuilder:e},null==(l=e.snapshot)?void 0:l.RoleId)}})})},leftSection:(0,a.jsx)(P.A,{size:16,strokeWidth:2,color:r.color})}),r.tables.find(e=>"Permission"===e.tableName)&&!(null==(i=r.props.hiddenMenuItems)?void 0:i.includes("Permissions"))&&(0,a.jsx)(C.k,{label:"Permissions",onClick:()=>r.setActiveComponent({component:(0,a.jsx)("div",{className:"w-full h-full flex flex-col",children:(0,a.jsx)("div",{className:"grow h-1",children:(0,a.jsx)(T,{tableName:"Permission",fields:["Name"],filters:[{field:"Tag",operator:"!=",value:"System"}],formFields:["Name"],formCloseOnCreate:!0,formMaxWidth:36,maxResults:100,formAppendButton:e=>(0,a.jsx)(a.Fragment,{children:"UPDATE"===e.operation&&(0,a.jsx)("div",{className:"w-full flex justify-start items-center gap-1",children:(0,a.jsx)(k,{value:e.data["".concat(e.tableName,"Id")]})})})})})})}),leftSection:(0,a.jsx)(h.A,{size:16,strokeWidth:2,color:r.color})})]})})};var ed=l(8019);let eu=()=>{var e;let t=eX();return(0,a.jsx)(a.Fragment,{children:t.tables.filter(e=>"Option"===e.tableName).length>0&&!(null==(e=t.props.hiddenMenuItems)?void 0:e.includes("Options"))&&(0,a.jsx)(C.k,{label:"Options",leftSection:(0,a.jsx)(ed.A,{size:16,strokeWidth:2,color:t.color}),onClick:()=>t.setActiveComponent({component:(0,a.jsx)(T,{tableName:"Option",maxResults:100,formAppendButton:e=>(0,a.jsx)(a.Fragment,{children:"UPDATE"===e.operation&&(0,a.jsx)("div",{className:"w-full flex justify-start items-center gap-1",children:(0,a.jsx)(k,{value:e.data["".concat(e.tableName,"Id")]})})})})})})})};var ec=l(9639),em=l(6394),ef=l(7848);let ep=e=>{var t,l,s,r;let n=(0,i.A)();(0,u.useRef)(null);let[o,c]=(0,u.useState)(!1),[m,f]=(0,u.useState)(!1),p=async()=>{var t;c(!0),e.formBuilder.dispatch({type:"SET_FIELD_VALUE",payload:{field:"Status",value:"Running"}}),await n.action("ADMIN_TriggerJob",{jobName:null==(t=e.formBuilder.snapshot)?void 0:t.Name}),c(!1)};return null==e.formBuilder.snapshot||(null==(t=e.formBuilder.snapshot)?void 0:t.Name)==null||(null==(l=e.formBuilder.snapshot)?void 0:l.name)===""||(null==(s=e.formBuilder.snapshot)?void 0:s._ui_info_)==null?(0,a.jsx)(a.Fragment,{}):(null==(r=e.formBuilder.snapshot)?void 0:r._ui_info_.canTrigger)===!0?(0,a.jsx)(d.$,{variant:"outline",onClick:p,loading:o,children:"Run Job"}):(0,a.jsx)(a.Fragment,{})};var eh=l(2038),ex=l(1054),ev=l(9050),ey=l(1232),eg=l(182),eb=l(3576),ej=l(7206);let eN=e=>{let{log:t}=e,[l,s]=u.useState(!1);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("span",{className:"w-full flex justify-start cursor-pointer items-start",onClick:()=>s(e=>!e),children:[(0,a.jsxs)("div",{className:"w-60 flex-shrink-0 flex justify-between items-center",children:[(0,a.jsx)(eb.E,{size:"sm",children:(0,ej.ki)(t.Timestamp)}),"Warning"==t.Level&&(0,a.jsx)("div",{className:" bg-yellow-500 rounded-full h-3 w-3 mr-4"}),"Error"==t.Level&&(0,a.jsx)("div",{className:"bg-red-500 rounded-full h-3 w-3 mr-4"}),"Critical"==t.Level&&(0,a.jsxs)("div",{className:"flex justify-center items-center mr-4 text-red-500",children:[(0,a.jsx)("div",{className:"bg-red-500 animate-pulse rounded-full h-3 w-3"}),"!"]})]}),(0,a.jsx)("div",{className:"flex-1 min-w-0",children:(0,a.jsx)(eb.E,{size:"sm",className:"break-words whitespace-pre-wrap",children:t.Message})})]}),l&&(0,a.jsxs)("div",{className:"w-full",children:[(0,a.jsxs)("div",{className:"w-full flex justify-start my-1",children:[(0,a.jsx)("div",{className:"w-60 flex-shrink-0"}),t.Properties&&(0,a.jsx)("div",{className:"flex-1 min-w-0",children:Object.entries(t.Properties).map(e=>{let[t,l]=e;return(0,a.jsx)("div",{children:(0,a.jsxs)(eb.E,{size:"sm",className:"break-words",children:[(0,a.jsxs)("strong",{children:[t,":"]})," ",JSON.stringify(l)]})},t)})})]}),(t.Exception||t.StackTrace)&&(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)("div",{className:"w-full flex justify-start my-1",children:[(0,a.jsx)("div",{className:"w-60 flex-shrink-0"}),(0,a.jsx)(eb.E,{size:"sm",className:"break-words whitespace-pre-wrap",children:t.Exception})]})})]})]})};var ew=l(6417),eI=l(4311),eC=l(1491),eE=l(7719);let eA=e=>{var t;let l=(0,ey.Us)(),s=u.useRef(!0),[i,n]=(0,u.useState)(!0),[o,c]=(0,u.useState)([]),[m,f]=(0,u.useState)(null==(t=e.isLive)||t),[h,x]=(0,u.useState)(""),[v,y]=(0,u.useState)(""),[g,b]=(0,u.useState)([null,null]),[j,N]=(0,u.useState)({all:!0,Critical:!1,Error:!1,Warning:!1,Information:!1,Debug:!1}),w=async function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:j;n(!0),c([]);let a=await l.signalR(),s=t.all?["Critical","Error","Warning","Information","Debug"]:Object.entries(t).filter(e=>{let[t,l]=e;return l&&"all"!==t}).map(e=>{let[t]=e;return t}),i=await a.invoke("Logging",JSON.stringify({Type:"initial_load",Message:"",Levels:s,Search:h,UserId:v,StartDate:g[0],EndDate:g[1],JobHistoryId:e.jobHistoryId}));c(null!=i?i:[]),n(!1)},I=(e,t)=>{let l={...j};N(l="all"===e?{all:t,Critical:!1,Error:!1,Warning:!1,Information:!1,Debug:!1}:{...l,all:!1,[e]:t}),w(l)};return(0,u.useEffect)(()=>{let e,t=async()=>{if(console.log("Initializing log viewer"),!m&&s.current&&await w(),m){await w();let t=await l.signalR();t.on("Log",e=>{c(t=>[e,...t].slice(0,250))}),e=()=>t.off("Log")}s.current=!1};return l.signalR(),l.signalRState===eg.j.Connected&&t(),()=>{null==e||e()}},[l.signalRState,m]),(0,a.jsxs)("form",{onSubmit:e=>{e.preventDefault(),w()},className:"relative w-full h-full flex flex-col gap-2",children:[(0,a.jsxs)("div",{className:"w-full items-end flex gap-1",children:[(0,a.jsx)("div",{className:"grow mr-1",children:(0,a.jsxs)(ec.x,{gutter:"xs",children:[(0,a.jsx)(ec.x.Col,{span:5,children:(0,a.jsx)(eh.k,{label:"Search",value:h,onChange:e=>x(e.currentTarget.value)})}),(0,a.jsx)(ec.x.Col,{span:4,children:(0,a.jsx)(eh.k,{label:"UserId",value:v,onChange:e=>y(e.currentTarget.value)})}),(0,a.jsx)(ec.x.Col,{span:3,children:(0,a.jsx)(eE.t,{type:"range",label:"Date Range",placeholder:"Pick dates range",clearable:!0,value:g,onChange:b})})]})}),(0,a.jsx)("div",{className:m?"hidden":"block",children:(0,a.jsx)(X.m,{label:"Go",children:(0,a.jsx)(d.$,{type:"submit",variant:"outline",children:(0,a.jsx)(ew.A,{size:12})})})}),(0,a.jsx)("div",{className:m?"block":"hidden",children:(0,a.jsx)(X.m,{label:"Stop",children:(0,a.jsx)(d.$,{variant:"outline",color:"red",onClick:e=>{m&&(e.preventDefault(),f(!1))},children:(0,a.jsx)(eI.A,{size:12})})})}),(0,a.jsx)(X.m,{label:"Live",children:(0,a.jsx)(d.$,{variant:m?"filled":"outline",onClick:()=>f(!0),children:(0,a.jsx)(eC.A,{size:16})})})]}),(0,a.jsxs)("div",{className:"flex gap-6",children:[(0,a.jsx)(p.S,{label:"All",checked:j.all,onChange:e=>I("all",e.currentTarget.checked)}),(0,a.jsx)(p.S,{label:"Critical",checked:j.Critical,onChange:e=>I("Critical",e.currentTarget.checked)}),(0,a.jsx)(p.S,{label:"Error",checked:j.Error,onChange:e=>I("Error",e.currentTarget.checked)}),(0,a.jsx)(p.S,{label:"Warning",checked:j.Warning,onChange:e=>I("Warning",e.currentTarget.checked)}),(0,a.jsx)(p.S,{label:"Information",checked:j.Information,onChange:e=>I("Information",e.currentTarget.checked)}),(0,a.jsx)(p.S,{label:"Debug",checked:j.Debug,onChange:e=>I("Debug",e.currentTarget.checked)})]}),(0,a.jsxs)(ex.t,{styles:{root:{flexGrow:1,overflowY:"scroll",position:"relative"}},withBorder:!0,children:[i&&(0,a.jsx)("div",{className:"absolute w-full h-full flex justify-center items-center",children:(0,a.jsx)(r.a,{})}),(0,a.jsx)(ev.a,{p:"xs",children:o.map(e=>(0,a.jsx)(eN,{log:e},e.LogId))})]})]})},eT=()=>{var e;let t=eX();return(0,a.jsx)(a.Fragment,{children:t.tables.filter(e=>"Job"===e.tableName).length>0&&!(null==(e=t.props.hiddenMenuItems)?void 0:e.includes("Jobs"))&&(0,a.jsx)(C.k,{label:"Jobs",leftSection:(0,a.jsx)(ef.A,{size:16,strokeWidth:2,color:t.color}),onClick:()=>t.setActiveComponent({component:(0,a.jsx)(T,{tableName:"Job",orderBy:[{field:"Name",order:"asc"}],fields:["Name","Queue","IsActive","LastExecution"],filters:[{field:"Tag",operator:"!=",value:"System"}],canCreate:!1,canDelete:!1,formCloseOnEscape:!0,customForm:e=>(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(ec.x,{children:[(0,a.jsx)(ec.x.Col,{span:4,children:(0,a.jsx)(W.A,{name:"Name"})}),(0,a.jsx)(ec.x.Col,{span:4,children:(0,a.jsx)(W.A,{name:"Queue"})}),(0,a.jsx)(ec.x.Col,{span:4,children:(0,a.jsx)(W.A,{name:"LastExecution"})})]}),(0,a.jsxs)(ec.x,{children:[(0,a.jsx)(ec.x.Col,{span:4,children:(0,a.jsx)(W.A,{name:"IsActive"})}),(0,a.jsx)(ec.x.Col,{span:4}),(0,a.jsx)(ec.x.Col,{span:4})]})]}),appendCustomForm:e=>{var t;return"CREATE"===e.operation&&a.Fragment,(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"w-full h-96 mt-4",children:(0,a.jsx)(T,{title:"History",tableName:"JobHistory",fields:["ServerName","Status","Message","CreatedDate","CompletedDate"],filters:[{field:"JobId",value:null==(t=e.snapshot)?void 0:t.JobId}],orderBy:[{field:"CreatedDate",order:"desc"}],maxResults:100,canUpdate:!1,canCreate:!1,formFullScreen:!0,refreshInterval:1e3,formClassNames:"h-full flex grow",customForm:e=>{var t;return(0,a.jsxs)("div",{className:"w-full flex flex-col gap-2",children:[(0,a.jsxs)(ec.x,{children:[(0,a.jsx)(ec.x.Col,{span:2.4,children:(0,a.jsx)(W.A,{name:"Name"})}),(0,a.jsx)(ec.x.Col,{span:2.4,children:(0,a.jsx)(W.A,{name:"JobId"})}),(0,a.jsx)(ec.x.Col,{span:2.4,children:(0,a.jsx)(W.A,{name:"Status"})}),(0,a.jsx)(ec.x.Col,{span:2.4,children:(0,a.jsx)(W.A,{name:"CreatedDate"})}),(0,a.jsx)(ec.x.Col,{span:2.4,children:(0,a.jsx)(W.A,{name:"CompletedDate"})})]}),(0,a.jsx)("div",{className:"w-full grow flex flex-col",children:(0,a.jsx)(em.L,{legend:"Logs",styles:{root:{flexGrow:1}},children:(0,a.jsx)(eA,{jobHistoryId:null==(t=e.snapshot)?void 0:t.JobHistoryId})})})]})}})}),(0,a.jsxs)("div",{className:"w-full flex justify-between mt-3",children:["UPDATE"===e.operation&&(0,a.jsx)("div",{className:"w-full flex justify-start items-center gap-1",children:(0,a.jsx)(k,{value:e.data["".concat(e.tableName,"Id")]})}),(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)("div",{className:"mr-2",children:(0,a.jsx)(ep,{formBuilder:e})}),(0,a.jsx)(V.A,{})]})]})]})}})})})})};var eS=l(9391);let eR=()=>{var e;let t=eX();return(0,a.jsx)(a.Fragment,{children:t.tables.filter(e=>"Setting"===e.tableName).length>0&&!(null==(e=t.props.hiddenMenuItems)?void 0:e.includes("Settings"))&&(0,a.jsx)(C.k,{label:"Settings",leftSection:(0,a.jsx)(eS.A,{size:16,strokeWidth:2,color:t.color}),onClick:()=>t.setActiveComponent({component:(0,a.jsx)(T,{tableName:"Setting",maxResults:100,formAppendButton:e=>(0,a.jsx)(a.Fragment,{children:"UPDATE"===e.operation&&(0,a.jsx)("div",{className:"w-full flex justify-start items-center gap-1",children:(0,a.jsx)(k,{value:e.data["".concat(e.tableName,"Id")]})})})})})})})};var eD=l(7786),ek=l(8150),e_=l(9181),eF=l(8728);let eL=e=>{var t,l;let s=(0,i.A)(),r=(0,u.useRef)(null),[n,o]=(0,u.useState)(!1),[d,c]=(0,u.useState)(!1),[m,f]=(0,u.useState)(!1),h=async e=>{var t;return!0===(await s.bulkUpdate(e.map(e=>({tableName:"AuditField",fields:{...e}})))).succeeded||(null==(t=r.current)||t.refresh(),!1)},x=async e=>{var t;return!0===(await s.update("AuditField",e)).succeeded||(null==(t=r.current)||t.refresh(),!1)};return(0,a.jsxs)("div",{className:"w-full flex flex-col gap-4",children:[(0,a.jsx)(ek.F,{icon:(0,a.jsx)(eF.A,{size:"1rem"}),color:"yellow",children:"In a multi-server environment, audit configuration changes may take up to one minute to propagate."}),(null==(t=e.formBuilder.snapshot)?void 0:t.IsTable)&&(0,a.jsxs)(ec.x,{children:[(0,a.jsx)(ec.x.Col,{span:4,children:(0,a.jsx)(W.A,{name:"Name"})}),(0,a.jsx)(ec.x.Col,{span:2,children:(0,a.jsx)(W.A,{name:"IsCreate"})}),(0,a.jsx)(ec.x.Col,{span:2,children:(0,a.jsx)(W.A,{name:"IsRead"})}),(0,a.jsx)(ec.x.Col,{span:2,children:(0,a.jsx)(W.A,{name:"IsUpdate"})}),(0,a.jsx)(ec.x.Col,{span:2,children:(0,a.jsx)(W.A,{name:"IsDelete"})})]}),(0,a.jsx)("div",{className:"w-full h-[550px]",children:(0,a.jsx)(e_.default,{tableName:"AuditField",columnWidths:["100%","130px","130px","130px"],additionalFields:["IsCreate","IsUpdate","IsDelete"],canDelete:!1,fields:["Name",{header:e=>(0,a.jsx)("div",{children:(0,a.jsx)(p.S,{label:"Create",checked:n,onChange:t=>{o(t.target.checked),e.setRecords(e=>{let l=e.map(e=>({...e,IsCreate:t.target.checked}));return h(l),l})}})}),body:(e,t)=>(0,a.jsx)(p.S,{checked:e.IsCreate,onChange:l=>{t.setRecords(t=>{let a=t.map(t=>t.AuditFieldId===e.AuditFieldId?{...t,IsCreate:l.target.checked}:t);return a.filter(e=>e.IsCreate).length===t.length?o(!0):o(!1),x(a.find(t=>t.AuditFieldId===e.AuditFieldId)),a})}})},{header:e=>(0,a.jsx)("div",{children:(0,a.jsx)(p.S,{label:"Update",checked:d,onChange:t=>{c(t.target.checked),e.setRecords(e=>{let l=e.map(e=>({...e,IsUpdate:t.target.checked}));return h(l),l})}})}),body:(e,t)=>(0,a.jsx)(p.S,{checked:e.IsUpdate,onChange:l=>{t.setRecords(t=>{let a=t.map(t=>t.AuditFieldId===e.AuditFieldId?{...t,IsUpdate:l.target.checked}:t);return a.filter(e=>e.IsUpdate).length===t.length?c(!0):c(!1),x(a.find(t=>t.AuditFieldId===e.AuditFieldId)),a})}})},{header:e=>(0,a.jsx)("div",{children:(0,a.jsx)(p.S,{label:"Delete",checked:m,onChange:t=>{f(t.target.checked),e.setRecords(e=>{let l=e.map(e=>({...e,IsDelete:t.target.checked}));return h(l),l})}})}),body:(e,t)=>(0,a.jsx)(p.S,{checked:e.IsDelete,onChange:l=>{t.setRecords(t=>{let a=t.map(t=>t.AuditFieldId===e.AuditFieldId?{...t,IsDelete:l.target.checked}:t);return a.filter(e=>e.IsDelete).length===t.length?f(!0):f(!1),x(a.find(t=>t.AuditFieldId===e.AuditFieldId)),a})}})}],maxResults:99999,onRowClick:e=>!1,filters:[{field:"AuditId",operator:"==",value:null==(l=e.formBuilder.snapshot)?void 0:l.AuditId}],orderBy:[{field:"Name",order:"asc"}],onDataLoaded:e=>{(e=>{e.filter(e=>e.IsCreate).length===e.length?o(!0):o(!1),e.filter(e=>e.IsUpdate).length===e.length?c(!0):c(!1),e.filter(e=>e.IsDelete).length===e.length?f(!0):f(!1)})(e.results)}})}),(0,a.jsxs)("div",{className:"w-full flex justify-between",children:["UPDATE"===e.formBuilder.operation&&(0,a.jsx)("div",{className:"w-full flex justify-start items-center gap-1",children:(0,a.jsx)(k,{value:e.formBuilder.data["".concat(e.formBuilder.tableName,"Id")]})}),(0,a.jsx)("div",{children:(0,a.jsx)(V.A,{})})]})]})},eB=()=>(0,a.jsxs)("div",{className:"w-full",children:[(0,a.jsxs)(ec.x,{children:[(0,a.jsx)(ec.x.Col,{span:4,children:(0,a.jsx)(W.A,{name:"TableName"})}),(0,a.jsx)(ec.x.Col,{span:4,children:(0,a.jsx)(W.A,{name:"FieldName"})}),(0,a.jsx)(ec.x.Col,{span:4,children:(0,a.jsx)(W.A,{name:"FieldType"})})]}),(0,a.jsxs)(ec.x,{children:[(0,a.jsx)(ec.x.Col,{span:4,children:(0,a.jsx)(W.A,{name:"OldValue"})}),(0,a.jsx)(ec.x.Col,{span:4,children:(0,a.jsx)(W.A,{name:"NewValue"})}),(0,a.jsx)(ec.x.Col,{span:4})]}),(0,a.jsxs)(ec.x,{children:[(0,a.jsx)(ec.x.Col,{span:4,children:(0,a.jsx)(W.A,{name:"OldValueId"})}),(0,a.jsx)(ec.x.Col,{span:4,children:(0,a.jsx)(W.A,{name:"NewValueId"})}),(0,a.jsx)(ec.x.Col,{span:4})]})]}),eP=e=>{var t,l,s,i,r,n,o;return(0,u.useEffect)(()=>{var t,l,a;if((null==(t=e.formBuilder.snapshot)?void 0:t.Operation)!=="Read")return;let s=JSON.stringify(JSON.parse(null==(l=e.formBuilder.snapshot)?void 0:l.Query),null,4),i=JSON.stringify(JSON.parse(null==(a=e.formBuilder.snapshot)?void 0:a.Results),null,4);e.formBuilder.setField("Query",s),e.formBuilder.setField("Results",i)},[null==(t=e.formBuilder.snapshot)?void 0:t.Query,null==(l=e.formBuilder.snapshot)?void 0:l.Results]),(0,a.jsxs)("div",{className:"w-full flex flex-col gap-4",children:[(0,a.jsxs)(ec.x,{children:[(0,a.jsx)(ec.x.Col,{span:4,children:(0,a.jsx)(W.A,{name:"TableName"})}),(0,a.jsx)(ec.x.Col,{span:4,children:(0,a.jsx)(W.A,{name:"Operation"})}),(0,a.jsx)(ec.x.Col,{span:4,children:(0,a.jsx)(W.A,{name:"CreatedDate"})})]}),(0,a.jsxs)(ec.x,{children:[(0,a.jsx)(ec.x.Col,{span:4,children:(0,a.jsx)(W.A,{name:"UserId"})}),(0,a.jsx)(ec.x.Col,{span:4,children:(0,a.jsx)(eh.k,{label:"UserId",value:null==(s=e.formBuilder.snapshot)?void 0:s.UserId,readOnly:!0})})]}),(0,a.jsx)(ec.x,{children:(null==(i=e.formBuilder.snapshot)?void 0:i.Operation)!=="Read"&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(ec.x.Col,{span:4,children:(0,a.jsx)(W.A,{name:"Name"})}),(0,a.jsx)(ec.x.Col,{span:4,children:(0,a.jsx)(W.A,{name:"EntityId"})})]})}),(null==(r=e.formBuilder.snapshot)?void 0:r.Operation)==="Read"&&(0,a.jsxs)(ec.x,{children:[(0,a.jsx)(ec.x.Col,{span:6,children:(0,a.jsx)("div",{className:"w-full h-[60vh]",children:(0,a.jsx)(W.A,{name:"Query",varient:"textarea"})})}),(0,a.jsx)(ec.x.Col,{span:6,children:(0,a.jsx)("div",{className:"w-full h-[60vh]",children:(0,a.jsx)(W.A,{name:"Results",varient:"textarea"})})})]}),(null==(n=e.formBuilder.snapshot)?void 0:n.Operation)!=="Read"&&(0,a.jsx)("div",{className:"w-full h-[500px] mt-2",children:(0,a.jsx)(e_.default,{tableName:"AuditHistoryDetail",disabledMessage:null==e.formBuilder.snapshot?"Loading...":void 0,fields:["FieldName","TableName","OldValue","NewValue"],maxResults:100,orderBy:[{field:"FieldName",order:"ASC"}],filters:[{field:"AuditHistoryId",value:null==(o=e.formBuilder.snapshot)?void 0:o.AuditHistoryId}],canCreate:!1,canDelete:!1,canUpdate:!1,customForm:()=>(0,a.jsx)(eB,{})})}),"UPDATE"===e.formBuilder.operation&&(0,a.jsx)("div",{className:"w-full flex justify-start items-center gap-1",children:(0,a.jsx)(k,{value:e.formBuilder.data["".concat(e.formBuilder.tableName,"Id")]})})]})},eO=()=>{var e;let t=eX();return(0,a.jsx)(a.Fragment,{children:t.tables.filter(e=>"Option"===e.tableName).length>0&&!(null==(e=t.props.hiddenMenuItems)?void 0:e.includes("Options"))&&(0,a.jsx)(C.k,{label:"Audit",leftSection:(0,a.jsx)(eD.A,{size:16,strokeWidth:2,color:t.color}),onClick:()=>t.setActiveComponent({component:(0,a.jsxs)(U.t,{defaultValue:"history",styles:{root:{display:"flex",flexDirection:"column",height:"100%",flexGrow:1},panel:{display:"flex",flexDirection:"column",flexGrow:1,height:1}},children:[(0,a.jsxs)(U.t.List,{children:[(0,a.jsx)(U.t.Tab,{value:"history",children:"History"}),(0,a.jsx)(U.t.Tab,{value:"field-history",children:"Field History"}),(0,a.jsx)(U.t.Tab,{value:"config",children:"Config"})]}),(0,a.jsx)(U.t.Panel,{value:"history",children:(0,a.jsx)("div",{className:"w-full h-full pt-4",children:(0,a.jsx)(T,{tableName:"AuditHistory",fields:["Operation","TableName","User","Name","CreatedDate","EntityId"],columnWidths:["125px","100%","100%","100%","100%","100%"],title:"History",maxResults:100,canCreate:!1,orderBy:[{field:"CreatedDate",order:"desc"}],customForm:e=>(0,a.jsx)(eP,{formBuilder:e})})})}),(0,a.jsx)(U.t.Panel,{value:"field-history",children:(0,a.jsx)("div",{className:"w-full h-full pt-4",children:(0,a.jsx)(T,{tableName:"AuditHistoryDetail",fields:["ah.Operation","ah.Name","ah.TableName","FieldName","OldValue","NewValue","ah.CreatedDate","ah.EntityId"],columnWidths:["125px","100%","100%","100%","100%","100%","100%","100px"],title:"Field History",maxResults:100,canCreate:!1,canUpdate:!1,canDelete:!1,joins:[{fromTable:"AuditHistoryDetail",fromField:"AuditHistoryId",toTable:"AuditHistory",toField:"AuditHistoryId",fields:["EntityId","TableName","Name","CreatedDate","Operation"],alias:"ah"}],orderBy:[{field:"ah.CreatedDate",order:"desc"}],customForm:e=>(0,a.jsx)(eB,{})})})}),(0,a.jsx)(U.t.Panel,{value:"config",children:(0,a.jsx)("div",{className:"w-full h-full pt-4",children:(0,a.jsx)(T,{tableName:"Audit",title:"Audit",formTitle:"Audit",maxResults:100,orderBy:[{field:"Name",order:"asc"}],fields:["Name","IsCreate","IsRead","IsUpdate","IsDelete"],columnWidths:["350px","100%","100%","100%","100%"],canCreate:!1,canDelete:!1,formMaxWidth:55,formCloseOnEscape:!0,customForm:e=>(0,a.jsx)(eL,{formBuilder:e})})})})]})})})})};var eM=l(8981);let eU=()=>{var e;let t=eX();return(0,a.jsx)(a.Fragment,{children:t.tables.filter(e=>"Server"===e.tableName).length>0&&!(null==(e=t.props.hiddenMenuItems)?void 0:e.includes("Servers"))&&(0,a.jsx)(C.k,{label:"Servers",leftSection:(0,a.jsx)(eM.A,{size:16,strokeWidth:2,color:t.color}),onClick:()=>t.setActiveComponent({component:(0,a.jsx)(T,{tableName:"Server",orderBy:[{field:"Name",order:"ASC"}],maxResults:100,canDelete:!1,canCreate:!1,canUpdate:!1,refreshInterval:1e3,formAppendButton:e=>(0,a.jsx)(a.Fragment,{children:"UPDATE"===e.operation&&(0,a.jsx)("div",{className:"w-full flex justify-start items-center gap-1",children:(0,a.jsx)(k,{value:e.data["".concat(e.tableName,"Id")]})})})})})})})};var eW=l(5950),eV=l(543);let ez=()=>{let e=(0,i.A)(),[t,l]=(0,u.useState)(""),s=async()=>{let t=await e.action("ADMIN_GetTypes");t.succeeded&&l(t.data)};return(0,u.useEffect)(()=>{s()},[]),(0,a.jsx)(eV.T,{styles:{root:{width:"100%",height:"100%"},input:{width:"100%",height:"100%"},wrapper:{width:"100%",height:"100%"}},readOnly:!0,value:t})},eH=()=>{var e;let t=eX();return(0,a.jsx)(a.Fragment,{children:!(null==(e=t.props.hiddenMenuItems)?void 0:e.includes("Development"))&&(0,a.jsx)(C.k,{label:"Development",leftSection:(0,a.jsx)(eW.A,{size:16,strokeWidth:2,color:t.color}),onClick:()=>t.setActiveComponent({component:(0,a.jsxs)(U.t,{defaultValue:"types",styles:{root:{display:"flex",flexDirection:"column",height:"100%",flexGrow:1},panel:{display:"flex",flexDirection:"column",flexGrow:1,height:1}},children:[(0,a.jsx)(U.t.List,{children:(0,a.jsx)(U.t.Tab,{value:"types",children:"Types"})}),(0,a.jsx)(U.t.Panel,{value:"types",children:(0,a.jsx)("div",{className:"w-full h-full pt-4",children:(0,a.jsx)(ez,{})})})]})})})})};var eG=l(8713);let eq=()=>{var e;let t=eX();return(0,a.jsx)(a.Fragment,{children:!(null==(e=t.props.hiddenMenuItems)?void 0:e.includes("Logs"))&&(0,a.jsx)(C.k,{label:"Logs",leftSection:(0,a.jsx)(eG.A,{size:16,strokeWidth:2,color:t.color}),onClick:()=>t.setActiveComponent({component:(0,a.jsx)(eA,{})})})})},eJ={tableName:"",appendCustomForm:void 0,formAppendButton:void 0,formMaxWidth:void 0,formCloseOnCreate:void 0,formTitle:void 0,fields:void 0,filters:void 0,formFields:void 0,formLookupQueries:void 0,orderBy:void 0,refreshInterval:void 0,canCreate:void 0,canDelete:void 0,maxResults:50},eK=u.createContext(null),eX=()=>{let e=u.useContext(eK);if(!e)throw Error("useAdminDashContext must be used within a AdminDashContextProvider");return e},eY=e=>{var t;let l=(0,i.A)(),[s,{toggle:m}]=(0,c.j)(),[f,p]=u.useState(void 0),[h,v]=u.useState(void 0),[g,b]=u.useState([]),[j,N]=(0,c.j)(!1),[C,E]=(0,c.j)(!1),[A,T]=u.useState({canImport:!1,canExport:!1}),S=(0,I.A)().getIconColor(),R=async()=>{let e=await l.tables();!0===e.succeeded&&b(e.data)},D=async()=>{let e=l.hasAllPermissions(["ACCESS_ADMIN_DASHBOARD"]),t=l.hasAllPermissions(["ACCESS_ADMIN_DEVELOPMENT"]),[a,s]=await Promise.all([e,t]);if(!a)return void p({Dashboard:!1,Development:!1});p({Dashboard:a,Development:s});let i=!1,r=!1;await l.hasAllPermissions(["ACTION_ADMIN_ExportDependencies","ACTION_ADMIN_ExportData"])===!0&&(i=!0),await l.hasAllPermissions(["ACTION_ADMIN_ImportData"])&&(r=!0),T({canImport:r,canExport:i})};if((0,u.useEffect)(()=>{D(),R()},[]),(null==f?void 0:f.Dashboard)===void 0)return(0,a.jsx)("div",{className:"w-full h-full flex justify-center items-center",children:(0,a.jsx)(r.a,{})});if(!f.Dashboard)if(e.accessDeniedMessage)return(0,a.jsx)(a.Fragment,{children:e.accessDeniedMessage});else return(0,a.jsx)("div",{className:"w-full h-full flex justify-center items-center",children:"You don't have permission to view this page. Please contact your system administrator."});let k=null!=g.find(e=>"Log"===e.tableName),F=[{order:100,navLink:(0,a.jsx)(_,{})},{order:200,navLink:(0,a.jsx)(eo,{})},{order:300,navLink:(0,a.jsx)(eu,{})},{order:400,navLink:(0,a.jsx)(eO,{})},{order:600,navLink:(0,a.jsx)(eT,{})},{order:700,navLink:(0,a.jsx)(eR,{})},{order:800,navLink:(0,a.jsx)(eU,{})},...k?[{order:900,navLink:(0,a.jsx)(eq,{})}]:[],...!0===f.Development?[{order:1e3,navLink:(0,a.jsx)(eH,{})}]:[]];void 0!==e.addMenuItems&&(F=F.concat(e.addMenuItems));let L=F.sort((e,t)=>e.order-t.order);return(0,a.jsxs)(eK.Provider,{value:{props:e,tables:g,color:S,setActiveComponent:v,emptyTableInfo:eJ},children:[(0,a.jsx)(x,{opened:j,close:N.close}),(0,a.jsx)(y,{opened:C,close:E.close}),(0,a.jsxs)(n.G,{padding:"md",header:{height:60},navbar:{width:300,breakpoint:"sm",collapsed:{mobile:!s}},styles:{navbar:{overflowY:"auto"}},children:[(0,a.jsx)(n.G.Header,{children:(0,a.jsxs)("div",{className:"w-full h-full flex items-center justify-between text-xl px-2",children:[(0,a.jsxs)("div",{className:"flex pl-2",children:[(0,a.jsx)(o.w,{opened:s,onClick:m,hiddenFrom:"sm",size:"sm"}),null!=(t=e.title)?t:"Admin Dashboard"]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[!e.forceHideToggleMode&&(0,a.jsx)(w,{}),!0===A.canImport&&!e.forceHideImportData&&(0,a.jsx)(d.$,{variant:"outline",onClick:E.open,children:"Import Data"}),!0===A.canExport&&!e.forceHideExportData&&(0,a.jsx)(d.$,{onClick:N.open,children:"Export Data"})]})]})}),(0,a.jsx)(n.G.Navbar,{className:" p-2",children:(0,a.jsxs)("div",{className:"w-full h-full flex flex-col justify-between",children:[(0,a.jsx)("div",{className:" overflow-y-scroll",children:L.map((e,t)=>(0,a.jsx)("span",{children:e.navLink},t))}),e.userCard&&(0,a.jsx)("div",{children:e.userCard})]})}),(0,a.jsx)(n.G.Main,{styles:{main:{width:"100%",height:"100%",display:"flex",flexDirection:"column"}},children:(0,a.jsx)("div",{className:"w-full h-1 grow",children:null!=h?h.component:(0,a.jsx)(a.Fragment,{children:k&&(0,a.jsx)(eA,{})})})})]})]})};var e$=l(5304),eQ=l(4200),eZ=l(6225),e0=l.n(eZ),e1=l(1413),e2=l(6676),e4=l(792),e3=l(5953),e6=l(1922),e9=l(9781),e5=l(3142);let e7=()=>{var e;let t=(0,e5.A)();return t.isReady?(0,a.jsx)(e2.Ay,{apiUrl:"",getAccessToken:t.authConfig.getAccessToken,children:(0,a.jsx)(ey.Ay,{children:(0,a.jsx)(eY,{addMenuItems:[{order:1e4,navLink:(0,a.jsx)(C.k,{label:"Logout",leftSection:(0,a.jsx)(e6.A,{size:16}),onClick:()=>{t.signOut(),e0().push("/")}})}],userCard:(0,a.jsxs)(ev.a,{children:[(0,a.jsx)(e4.c,{}),(0,a.jsx)(C.k,{label:(null===e1.firebaseAuth||void 0===e1.firebaseAuth||null==(e=e1.firebaseAuth.currentUser)?void 0:e.email)||"User",leftSection:(0,a.jsx)(e3.e,{size:"sm"}),rightSection:(0,a.jsx)(e9.A,{size:14,stroke:1.5}),onClick:()=>e0().push("/profile"),p:"md"})]}),accessDeniedMessage:(0,a.jsxs)("div",{className:"w-full h-full flex flex-col gap-2 justify-center items-center",children:["You don't have permission to view this page. Please contact your system administrator.",null!=e1.firebaseApp&&(0,a.jsx)(d.$,{onClick:()=>{(0,eQ.xI)(e1.firebaseApp).signOut(),e0().push("/")},children:"Logout"})]})})})}):(0,a.jsx)("div",{className:"w-full h-full flex justify-center items-center",children:(0,a.jsx)(r.a,{})})};var e8=l(722);function te(){let e=(0,eZ.useRouter)(),t=(0,e$.I)({queryKey:["auth-settings"],queryFn:async()=>{let e=await fetch("".concat("").concat(s.i3,"?name=firebase"));return e.ok?e.json():null}});return t.isLoading?(0,a.jsx)("div",{className:"w-full h-full flex justify-center items-center",children:(0,a.jsx)(r.a,{})}):t.data?(0!==Object.keys(t.data).length&&null===e1.firebaseApp&&(0,e1.initializeFirebase)(t.data),0!==Object.keys(t.data).length&&null!=e1.firebaseApp)?null===(0,eQ.xI)(e1.firebaseApp).currentUser?(e.push("/login"),(0,a.jsx)(a.Fragment,{})):(0,a.jsx)(e8.OJ,{authConfig:e1.firebaseAuthConfig,children:(0,a.jsx)(e7,{})}):(0,a.jsx)(eY,{}):(0,a.jsx)("div",{children:"Error loading auth settings"})}},6444:(e,t,l)=>{"use strict";l.d(t,{I7:()=>o,Lx:()=>r,N$:()=>f,Q3:()=>a,UK:()=>d,V8:()=>n,Wf:()=>u,i3:()=>p,nm:()=>m,qK:()=>i,rG:()=>s,vh:()=>c});let a="/xams/WhoAmI",s="/xams/Permissions",i="/xams/MetaData",r="/xams/Create",n="/xams/Read",o="/xams/Update",d="/xams/Delete",u="/xams/Upsert",c="/xams/Bulk",m="/xams/Action",f="/xams/File",p="/xams/Config"},6915:(e,t,l)=>{"use strict";l.d(t,{A:()=>R});var a=l(6514),s=l(5834),i=l(336),r=l(543),n=l(2038),o=l(4180),d=l(6313),u=l(9692),c=l(9076),m=l(4102),f=l(3576),p=l(304),h=l(8718),x=l(2894);let v=e=>{let{option:t,checked:l}=e;return(0,a.jsx)(m.Y,{flex:"1",gap:"xs",children:(0,a.jsxs)("div",{children:[(0,a.jsx)(f.E,{size:"sm",children:t.label}),(0,a.jsx)(f.E,{size:"xs",opacity:.65,children:t.description})]})})},y=(0,s.forwardRef)((e,t)=>{let l=(0,s.useRef)(null),i=(0,c.A)(),[r,n]=(0,s.useState)(!0),[o,d]=(0,s.useState)(!1),[u,m]=(0,s.useState)(void 0!==e.defaultLabelValue?e.defaultLabelValue:null),[f,y]=(0,s.useState)(void 0!==e.defaultLabelValue?[e.defaultLabelValue]:[]),[g,b]=s.useState(null),[j]=(0,h.o)(g,200,{leading:!0});(0,s.useImperativeHandle)(t,()=>l.current);let N=async()=>{var t,l,a,s,o,d,c;let m=[e.metaDataField.lookupTablePrimaryKeyField];null!=e.metaDataField.lookupTableNameField&&m.push(e.metaDataField.lookupTableNameField),null!=e.metaDataField.lookupTableDescriptionField&&m.push(e.metaDataField.lookupTableDescriptionField),""!==e.metaDataField.option&&m.push("Value");let f={tableName:e.metaDataField.lookupTable,maxResults:20,page:1,fields:m,orderBy:[...""!==e.metaDataField.option?[{field:"Order",order:"asc"}]:[],{field:null!=(o=e.metaDataField.lookupTableNameField)?o:e.metaDataField.lookupTablePrimaryKeyField,order:null==(t=e.query)?void 0:t.order}],filters:[r?{}:{logicalOperator:"OR",filters:[{field:null!=(d=e.metaDataField.lookupTableNameField)?d:e.metaDataField.lookupTablePrimaryKeyField,operator:"contains",value:null!=u&&u.label===j?"":j},...null!=e.metaDataField.lookupTableDescriptionField?[{field:e.metaDataField.lookupTableDescriptionField,operator:"contains",value:null!=u&&u.label===j?"":j}]:[{}]]},...e.metaDataField.lookupTableHasActiveField?[{field:"IsActive",operator:"==",value:"true"}]:[],...null!=(c=null==(l=e.query)?void 0:l.filters)?c:[],...""!==e.metaDataField.option?[{field:"Name",value:e.metaDataField.option}]:[]],joins:null==(a=e.query)?void 0:a.joins,except:null==(s=e.query)?void 0:s.except,..."OwningUserId"===e.metaDataField.name||"OwningTeamId"===e.metaDataField.name?{parameters:{isOwnerField:!0,tableName:e.owningTableName}}:{}},p=await i.read(f);if(!p||!p.succeeded)return;let h=p.data.results.map(t=>{var l,a;return{value:"".concat(t[e.metaDataField.lookupTablePrimaryKeyField]),label:(null!=(l=t[e.metaDataField.lookupTableNameField])?l:t[e.metaDataField.lookupTablePrimaryKeyField]).toString(),...null!=e.metaDataField.lookupTableDescriptionField?{description:"".concat(null!=(a=t[e.metaDataField.lookupTableDescriptionField])?a:"")}:{},...""!==e.metaDataField.option?{data:t.Value}:{}}});void 0!==e.excludeValues&&(h=h.filter(t=>{var l;return(null==(l=e.excludeValues)?void 0:l.find(e=>e===t.value))===void 0})),null!=u&&void 0===h.find(e=>e.value===(null==u?void 0:u.value))&&h.push(u),h=h.map(e=>(void 0===e.label&&(e.label=e.value),e)),r&&n(!1),y(h)},w=async t=>{var l;let a=[e.metaDataField.lookupTablePrimaryKeyField];e.metaDataField.lookupTableNameField&&a.push(e.metaDataField.lookupTableNameField),e.metaDataField.lookupTableDescriptionField&&a.push(e.metaDataField.lookupTableDescriptionField);let s=new x.Ay(a).top(1).from(e.metaDataField.lookupTable).where(e.metaDataField.lookupTablePrimaryKeyField,"==",t).toReadRequest(),r=await i.read(s);if(!r||!r.succeeded)return;let n=r.data.results[0];if(null==n)return;let o={value:"".concat(n[e.metaDataField.lookupTablePrimaryKeyField]),label:(null!=(l=n[e.metaDataField.lookupTableNameField])?l:n[e.metaDataField.lookupTablePrimaryKeyField]).toString()};return null!=e.metaDataField.lookupTableDescriptionField&&(o.description=n[e.metaDataField.lookupTableDescriptionField]),o},I=async()=>{if(void 0!==e.defaultLabelValue&&null!=e.defaultLabelValue.value&&""===e.defaultLabelValue.label){let t=f.find(t=>{var l;return t.value===(null==(l=e.defaultLabelValue)?void 0:l.value)});if(null!=t&&""===t.label){let l=await w(e.defaultLabelValue.value);null!=l&&(m(l),y(e=>e.map(e=>e.value===t.value?{...e,...l}:e)))}}if(void 0!==e.defaultLabelValue&&void 0===f.find(t=>{var l;return t.value===(null==(l=e.defaultLabelValue)?void 0:l.value)})){if(f.find(t=>{var l,a,s;return t.value===("number"==typeof(null==(l=e.defaultLabelValue)?void 0:l.value)?"".concat(null==(a=e.defaultLabelValue)?void 0:a.value):null==(s=e.defaultLabelValue)?void 0:s.value)}))return;y([...f,e.defaultLabelValue])}};for(let t of((0,s.useEffect)(()=>{o&&null!==j&&!["CreatedById","UpdatedById"].includes(e.metaDataField.name)&&N()},[j,o]),(0,s.useEffect)(()=>{I()},[e.defaultLabelValue]),f))null==t.label&&(t.label=t.value),"number"==typeof t.value&&(t.value="".concat(t.value));return(0,a.jsx)(p.l,{label:e.label,size:e.size,data:f,className:e.className,renderOption:null!=e.metaDataField.lookupTableDescriptionField?v:void 0,defaultValue:void 0!==e.defaultLabelValue?e.defaultLabelValue.value:void 0,value:"number"==typeof e.value?"".concat(e.value):e.value,onSearchChange:b,onChange:t=>{var l,a,s,i,r;void 0!==e.onChange&&e.onChange({id:t,value:null!=(s=null==(l=f.find(e=>e.value===t))?void 0:l.data)?s:null,label:null!=(i=null==(a=f.find(e=>e.value===t))?void 0:a.label)?i:null}),m(null!=(r=f.find(e=>e.value===t))?r:null)},onClick:()=>{d(!0)},onBlur:e.onBlur,searchable:!0,clearable:e.metaDataField.isNullable,ref:l,readOnly:e.readOnly,withAsterisk:e.required,error:e.error,disabled:e.disabled,filter:null!=e.metaDataField.lookupTableDescriptionField?e=>{let{options:t,search:l}=e;return t}:void 0})});y.displayName="XLookup";var g=l(5856),b=l(567),j=l(395),N=l(8625),w=l(2127),I=l(1369),C=l(3378),E=l(9241),A=l(1290);let T=e=>{let t=(0,g.hG)({extensions:[w.A,I.A,b.N,E.A,A.A,N.Ay,C.A.configure({types:["heading","paragraph"]})]});return(0,s.useEffect)(()=>(null==t||t.on("update",()=>{if(null!=e.onChange){var l;e.onChange(null!=(l=null==t?void 0:t.getHTML())?l:"")}}),()=>{null==t||t.off("update")}),[t]),(0,s.useEffect)(()=>{var l;null==t||t.commands.setContent(null!=(l=e.value)?l:"")},[t]),(0,a.jsxs)(j.d,{editor:t,styles:{root:{height:"100%",display:"flex",flexDirection:"column"},toolbar:{position:"static"},content:{flexGrow:1,display:"flex",flexDirection:"column",overflow:"auto"}},onChange:e=>{console.log(e)},children:[(0,a.jsxs)(j.d.Toolbar,{sticky:!0,stickyOffset:60,children:[(0,a.jsxs)(j.d.ControlsGroup,{children:[(0,a.jsx)(j.d.Bold,{}),(0,a.jsx)(j.d.Italic,{}),(0,a.jsx)(j.d.Underline,{}),(0,a.jsx)(j.d.Strikethrough,{}),(0,a.jsx)(j.d.ClearFormatting,{}),(0,a.jsx)(j.d.Highlight,{}),(0,a.jsx)(j.d.Code,{})]}),(0,a.jsxs)(j.d.ControlsGroup,{children:[(0,a.jsx)(j.d.H1,{}),(0,a.jsx)(j.d.H2,{}),(0,a.jsx)(j.d.H3,{}),(0,a.jsx)(j.d.H4,{})]}),(0,a.jsxs)(j.d.ControlsGroup,{children:[(0,a.jsx)(j.d.Blockquote,{}),(0,a.jsx)(j.d.Hr,{}),(0,a.jsx)(j.d.BulletList,{}),(0,a.jsx)(j.d.OrderedList,{}),(0,a.jsx)(j.d.Subscript,{}),(0,a.jsx)(j.d.Superscript,{})]}),(0,a.jsxs)(j.d.ControlsGroup,{children:[(0,a.jsx)(j.d.Link,{}),(0,a.jsx)(j.d.Unlink,{})]}),(0,a.jsxs)(j.d.ControlsGroup,{children:[(0,a.jsx)(j.d.AlignLeft,{}),(0,a.jsx)(j.d.AlignCenter,{}),(0,a.jsx)(j.d.AlignJustify,{}),(0,a.jsx)(j.d.AlignRight,{})]})]}),(0,a.jsx)(j.d.Content,{onChange:e=>{console.log(e)}})]})};function S(e,t){if(!e||!/^[-+]?[0-9]*\.?[0-9]*([eE][-+]?[0-9]+)?$/.test(e))return"NaN";let l={Single:{min:-34e37,max:34e37,precision:7},Double:{min:-17e307,max:17e307,precision:15},Decimal:{min:Number("-7.9e28"),max:Number("7.9e28"),precision:28},Byte:{min:0,max:255},SByte:{min:-128,max:127},Int16:{min:-32768,max:32767},UInt16:{min:0,max:65535},Int32:{min:-0x80000000,max:0x7fffffff},UInt32:{min:0,max:0xffffffff},Int64:{min:Number.MIN_SAFE_INTEGER,max:Number.MAX_SAFE_INTEGER},UInt64:{min:0,max:Number.MAX_SAFE_INTEGER}},a=parseFloat(e);if(isNaN(a)||!isFinite(a))throw Error("Invalid numeric value for ".concat(t,": ").concat(e));if("Int64"===t||"UInt64"===t||"Decimal"===t)if(e.includes(".")||e.includes("e")||e.includes("E")){if("Decimal"===t){if(Math.abs(a)>79e27)throw Error("Value out of range for Decimal: ".concat(e));if(e.replace(/^[-+]/,"").replace(/^0+/,"").replace(/\./,"").replace(/[eE][-+]?[0-9]+$/,"").replace(/0+$/,"").length>29)throw Error("Precision exceeds Decimal's 28-29 significant digits: ".concat(e))}}else try{let l=BigInt(e);if("Int64"===t&&(l<BigInt("-9223372036854775808")||l>BigInt("9223372036854775807")))throw Error("Value out of range for Int64: ".concat(e));if("UInt64"===t&&(l<BigInt(0)||l>BigInt("18446744073709551615")))throw Error("Value out of range for UInt64: ".concat(e));if("Decimal"===t&&(l<BigInt("-79228162514264337593543950335")||l>BigInt("79228162514264337593543950335")))throw Error("Value out of range for Decimal: ".concat(e))}catch(e){if(String(e).includes("out of range"))throw e}else{let s=l[t];if(a<s.min||a>s.max)throw Error("Value out of range for ".concat(t,": ").concat(e));if(["Byte","SByte","Int16","UInt16","Int32","UInt32"].includes(t)&&!Number.isInteger(a))throw Error("Value must be an integer for ".concat(t,": ").concat(e))}let s=e,i=e.endsWith("."),r=e.startsWith("-"),n=r?e.substring(1):e;return/^0[0-9]/.test(n)&&(n.includes(".")?n.startsWith("0.")||(n=n.replace(/^0+(?=\d)/,"")).startsWith(".")&&(n="0"+n):""===(n=n.replace(/^0+/,""))&&(n="0"),s=r?"-"+n:n),i&&!s.endsWith(".")&&(s+="."),s}let R=e=>{var t,l,s,c,m,f,p,h,x,v;let g=(0,u.xW)(),b=null==(t=g.formBuilder.metadata)?void 0:t.fields.find(t=>t.name===e.name);if(null==g.formBuilder.metadata)return(0,a.jsx)(a.Fragment,{});if(null==b)throw Error("Field ".concat(e.name," not found on ").concat(g.formBuilder.metadata.tableName," metadata."));e.required?g.formBuilder.addRequiredField(b.name):g.formBuilder.removeRequiredField(b.name);let j=b.isReadOnly||e.readOnly,N=(t,l)=>{let a=!1,s=t.name,i=t.type,r=t.isNullable,n=g.formBuilder.data[s],o=["Single","Double","Decimal","Byte","SByte","Int16","UInt16","Int32","UInt32","Int64","UInt64"];if(o.includes(i)&&""===l&&(l="0"),o.includes(i)&&"-"===l&&n.length>1&&(l="0"),o.includes(i)&&l.includes("-")&&(l="-"+l.replace("-","")),o.includes(i)&&(!1===e.allowNegative&&l.startsWith("-")&&""===(l=l.replace("-",""))&&(l="0"),null!=t.numberRange)){let e=t.numberRange.split("-"),a=parseFloat(S(e[0],i)),s=parseFloat(S(e[1],i));try{let e=parseFloat(S(l,i));e<=a&&(l=a.toString()),e>s&&(l=s.toString())}catch(e){console.log(e)}}if("Char"==i&&(l=l.replace(n,""),r||""!==l||(l="A"),a=!0),("String"===i||"Guid"===i)&&(t.characterLimit&&(l.length<=t.characterLimit||(l=l.substring(0,t.characterLimit))),a=!0),["Single","Double","Decimal"].includes(i))try{let e=S(l,i);Number.isNaN(e)||"NaN"===e||(l=e.toString(),a=!0)}catch(e){}if(["Byte","SByte","Int16","UInt16","Int32","UInt32","Int64","UInt64"].includes(i))try{let e=function(e,t){let l,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;if(!e||!/^[-+]?[0-9a-fA-F]+$/.test(e))return NaN;let s={Byte:{min:0,max:255},SByte:{min:-128,max:127},Int16:{min:-32768,max:32767},UInt16:{min:0,max:65535},Int32:{min:-0x80000000,max:0x7fffffff},UInt32:{min:0,max:0xffffffff},Int64:{min:BigInt("-9223372036854775808"),max:BigInt("9223372036854775807")},UInt64:{min:BigInt(0),max:BigInt("18446744073709551615")},Single:{min:-34e37,max:34e37},Double:{min:-17e307,max:17e307},Decimal:{min:BigInt("-79228162514264337593543950335"),max:BigInt("79228162514264337593543950335")}};if("Int64"===t||"UInt64"===t||"Decimal"===t){try{l=BigInt(e)}catch(e){return NaN}let a=s[t];if(l<a.min||l>a.max)throw Error("Value out of range for ".concat(t,": ").concat(e))}else if(l=parseInt(e,a),["Byte","SByte","Int16","UInt16","Int32","UInt32"].includes(t)){let a=s[t];if(l<a.min||l>a.max)throw Error("Value out of range for ".concat(t,": ").concat(e))}return l}(l,i);Number.isNaN(e)||(l=e.toString(),a=!0)}catch(e){}a&&w(s,l)},w=function(t,l){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;g.formBuilder.dispatch({type:"SET_FIELD_VALUE",payload:{field:t,value:l}}),null!=e.onChange&&((null==b?void 0:b.type)==="Lookup"?e.onChange(l,a):e.onChange(l))},I=e=>null==e||!["h","m","s","A","a","H","k","K","m","s","S","Z","X","LT","LTS","LLL","LLLL","lll","llll"].some(t=>e.includes(t));if(null==b||void 0===g.formBuilder.data||void 0===g.formBuilder.data[b.name])return(0,a.jsx)(a.Fragment,{});let C=t=>{let{field:l}=t;return(0,a.jsxs)(a.Fragment,{children:[null!=e.label?e.label:l.displayName," ",!0===l.isRecommended?(0,a.jsx)(i.m,{label:"Recommended",withArrow:!0,children:(0,a.jsx)("span",{className:" text-blue-600",children:"+"})}):(0,a.jsx)(a.Fragment,{})]})};return(0,a.jsxs)(a.Fragment,{children:["Lookup"===b.type&&(0,a.jsx)(y,{label:(0,a.jsx)(C,{field:b}),size:e.size,className:!1===g.formBuilder.canRead.canRead?"invisible":"",metaDataField:b,owningTableName:null==(l=g.formBuilder.metadata)?void 0:l.tableName,ref:!0===e.focus?g.formBuilder.firstInputRef:void 0,onChange:t=>{w(b.name,null==t?void 0:t.id,null==t?void 0:t.value),null!=e.onChange&&e.onChange(null==t?void 0:t.id,null==t?void 0:t.label)},onBlur:e.onBlur,defaultLabelValue:void 0!==g.formBuilder.snapshot?((e,t)=>null==e&&null!=t?{label:t,value:t}:null!=e&&null!=t?{label:e,value:t}:void 0)(g.formBuilder.snapshot[b.lookupName],g.formBuilder.snapshot[b.name]):(e=>{var t;let l=null==(t=g.formBuilder.defaults)?void 0:t.find(t=>t.field===e);if(void 0!==l)return{label:"",value:l.value}})(b.name),value:g.formBuilder.data[b.name],excludeValues:null==(c=g.formBuilder.lookupExclusions)||null==(s=c.find(e=>e.fieldName===b.name))?void 0:s.values,query:null==(m=g.formBuilder.lookupQueries)?void 0:m.find(e=>e.field===b.name),readOnly:["CreatedById","UpdatedById"].includes(b.name)||!1===g.formBuilder.canUpdate&&void 0!==g.formBuilder.snapshot||["OwningUserId","OwningTeamId"].includes(b.name)&&void 0!==g.formBuilder.snapshot&&!1===g.formBuilder.snapshot._ui_info_.canAssign||j,required:!1===b.isNullable&&!["CreatedById","UpdatedById"].includes(b.name)||!0===b.isRequired||!0===e.required,error:null==(f=g.formBuilder.validationMessages.find(e=>e.field===b.name))?void 0:f.message,disabled:e.disabled}),"String"===b.type&&"rich"===e.varient&&(0,a.jsx)(T,{value:g.formBuilder.data[b.name],onChange:e=>{N(b,e)}}),"String"===b.type&&"textarea"===e.varient&&(0,a.jsx)(r.T,{size:e.size,styles:{root:{height:"100%",display:"flex",flexDirection:"column"},wrapper:{flexGrow:1},input:{height:"100%"}},label:(0,a.jsx)(C,{field:b}),placeholder:e.placeholder,value:g.formBuilder.data[b.name],required:!0===b.isRequired||!0===e.required||!b.isNullable,onChange:e=>{N(b,e.currentTarget.value)},onBlur:e.onBlur,readOnly:!1===g.formBuilder.canUpdate&&void 0!==g.formBuilder.snapshot||j,error:null==(p=g.formBuilder.validationMessages.find(e=>e.field===b.name))?void 0:p.message,disabled:e.disabled}),["String","Guid","Int32","Single","Int64","Double","Decimal","Byte","SByte","UInt32","UInt64","Int16","UInt16","Char"].includes(b.type)&&null==e.varient&&null!=g.formBuilder.data[b.name]&&(0,a.jsx)(n.k,{label:(0,a.jsx)(C,{field:b}),size:e.size,ref:!0===e.focus?g.formBuilder.firstInputRef:void 0,value:g.formBuilder.data[b.name],onChange:e=>{N(b,e.currentTarget.value)},onBlur:e.onBlur,readOnly:!1===g.formBuilder.canUpdate&&void 0!==g.formBuilder.snapshot||j,error:null==(h=g.formBuilder.validationMessages.find(e=>e.field===b.name))?void 0:h.message,required:!0===b.isRequired||!0===e.required||!b.isNullable,placeholder:e.placeholder,disabled:e.disabled}),"DateTime"===b.type&&(0,a.jsx)(d.J,{ref:!0===e.focus?g.formBuilder.firstInputRef:void 0,size:e.size,label:(0,a.jsx)(C,{field:b}),...null!=b.dateFormat&&""!==b.dateFormat?{valueFormat:b.dateFormat}:{},value:void 0!==g.formBuilder.data&&void 0!==g.formBuilder.data[b.name]&&null!==g.formBuilder.data[b.name]&&"0001-01-01T00:00:00"!==g.formBuilder.data[b.name]?I(b.dateFormat)?g.formBuilder.data[b.name].replace("Z","").split("T")[0]:g.formBuilder.data[b.name].replace("Z",""):null,onChange:e=>{w(b.name,null==e?null:I(b.dateFormat)?e+"T00:00:00":e)},onBlur:e.onBlur,clearable:b.isNullable,readOnly:["CreatedDate","UpdatedDate"].includes(b.name)||void 0!==g.formBuilder.snapshot&&!1===g.formBuilder.canUpdate||j,required:!0===b.isRequired||e.required||!b.isNullable,error:null==(x=g.formBuilder.validationMessages.find(e=>e.field===b.name))?void 0:x.message,...e.dateInput,disabled:e.disabled}),"Boolean"===b.type&&(0,a.jsx)("div",{className:"w-full h-full flex items-end",children:(0,a.jsx)("div",{className:"w-full h-9 flex items-center",children:(0,a.jsx)(o.S,{ref:!0===e.focus?g.formBuilder.firstInputRef:void 0,label:(0,a.jsx)(C,{field:b}),size:e.size,checked:void 0!==g.formBuilder.data&&void 0!==g.formBuilder.data[b.name]&&null!==g.formBuilder.data[b.name]?g.formBuilder.data[b.name]:void 0,onChange:t=>{void 0!==g.formBuilder.snapshot&&!1===g.formBuilder.canUpdate||j||w(b.name,t.currentTarget.checked),null!=e.onChange&&e.onChange(t.currentTarget.checked)},onBlur:e.onBlur,readOnly:void 0!==g.formBuilder.snapshot&&!1===g.formBuilder.canUpdate||j,error:null==(v=g.formBuilder.validationMessages.find(e=>e.field===b.name))?void 0:v.message,required:!0===b.isRequired||e.required,disabled:e.disabled})})})]})}},7206:(e,t,l)=>{"use strict";function a(e){return null!==e}function s(){return-(new Date().getTimezoneOffset()/60)}function i(e){let t=new Date(e),l=t.getDate(),a=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][t.getMonth()],s=t.getFullYear(),i=t.getHours(),r=i>=12?"PM":"AM";i%=12,i=i||12;let n=t.getMinutes().toString().padStart(2,"0"),o=t.getSeconds().toString().padStart(2,"0"),d=t.getMilliseconds().toString().padStart(3,"0");return"".concat(l," ").concat(a," ").concat(s," ").concat(i,":").concat(n,":").concat(o,".").concat(d," ").concat(r)}l.d(t,{Pe:()=>a,ki:()=>i,qn:()=>s})},8002:(e,t,l)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return l(5216)}])},9076:(e,t,l)=>{"use strict";l.d(t,{A:()=>n});var a=l(5834),s=l(1232),i=l(6444),r=l(6676);let n=e=>{let t=(0,a.useContext)(s.BR),l=(0,a.useContext)(r.cy),n=async e=>{try{var a,s,i;let r=(null!=(a=null==l?void 0:l.apiUrl)?a:"")+e.url;void 0!==e.searchParams&&(r+="?".concat(e.searchParams.toString()));let n="";(null==l?void 0:l.getAccessToken)!==void 0&&(n=null!=(s=await l.getAccessToken())?s:"");let o=await fetch(r,{method:e.method,headers:{Authorization:"Bearer ".concat(n),...void 0!==e.body&&!(e.body instanceof FormData)&&{"Content-Type":"application/json"},...e.headers,...(null==l?void 0:l.headers)!==void 0&&(null==l?void 0:l.headers)},...(null==l?void 0:l.withCredentials)&&{credentials:"include"},...void 0!==e.body&&!(e.body instanceof FormData)&&{body:JSON.stringify(e.body)},...void 0!==e.body&&e.body instanceof FormData&&{body:e.body}});if(401===o.status)return(null==l?void 0:l.onUnauthorized)!==void 0&&l.onUnauthorized(),{succeeded:!1,data:void 0,friendlyMessage:"",logMessage:"",response:o};if(400===o.status&&!e.hideFailureMessage)if(void 0!==e.failureMessage)null==t||t.showError(e.failureMessage);else{let e=await o.json();return null==t||t.showError(e.friendlyMessage),console.error(e.logMessage),e}if(!1===o.ok){let e=await o.text();return null==t||t.showError(e),{succeeded:!1,data:void 0,friendlyMessage:e,logMessage:e,response:o}}let d=o.headers.get("content-type");if(d&&-1!==d.indexOf("application/octet-stream")&&((e,t)=>{let l=document.createElement("a");l.href=URL.createObjectURL(e),l.download=t,document.body.appendChild(l),l.click(),setTimeout(()=>{document.body.removeChild(l),URL.revokeObjectURL(l.href)},0)})(await o.blob(),null!=(i=e.fileName)?i:"file"),!d||-1===d.indexOf("application/json"))return{succeeded:!0,data:o.body,friendlyMessage:"",logMessage:"",response:o};{let l=await o.json();return!1===l.succeeded&&((void 0===e.hideFailureMessage||!1===e.hideFailureMessage)&&(null==t||t.showError(l.friendlyMessage)),console.error(l.logMessage)),l}}catch(l){return console.error(l),(void 0===e.hideFailureMessage||!1===e.hideFailureMessage)&&void 0!==e.failureMessage&&(null==t||t.showError(JSON.stringify(l))),{succeeded:!1,data:void 0,friendlyMessage:"",logMessage:"",response:void 0}}},o=async()=>await n({url:i.Q3,method:"GET"}),d=async e=>{let t=await n({url:i.rG,method:"POST",body:{method:"has_permissions",parameters:{permissionNames:e}}});return!0===t.succeeded&&t.data.length===e.length||!1},u=async e=>{let t=await n({url:i.rG,method:"POST",body:{method:"has_permissions",parameters:{permissionNames:e}}});return!0===t.succeeded&&!!(t.data.length>0)||!1},c=async e=>{let t=await n({url:i.qK,method:"POST",body:{method:"table_metadata",parameters:{tableName:e}}});return null==t?void 0:t.data},m=async e=>await n({url:i.qK,method:"POST",body:{method:"table_list",parameters:{tag:e}}}),f=async function(e,t){let l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return await n({method:"POST",url:i.Lx,body:{tableName:e,fields:t,parameters:l}})},p=async(e,t,l)=>await n({method:"PATCH",url:i.I7,body:{tableName:e,fields:t,parameters:l}}),h=async(e,t,l)=>await n({method:"DELETE",url:i.UK,body:{tableName:e,id:t,fields:{},parameters:l}}),x=async(e,t,l)=>await n({method:"POST",url:i.Wf,body:{tableName:e,fields:t,parameters:l}}),v=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return await n({method:"POST",url:i.Lx,body:{entities:e,parameters:t}})},y=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return await n({method:"PATCH",url:i.I7,body:{entities:e,parameters:t}})},g=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return await n({method:"DELETE",url:i.UK,body:{entities:e,parameters:t}})},b=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return await n({method:"POST",url:i.Wf,body:{entities:e,parameters:t}})},j=async function(e){return arguments.length>1&&void 0!==arguments[1]&&arguments[1],await n({url:i.vh,method:"POST",body:e})},N=async e=>await n({method:"POST",url:i.V8,body:e}),w=async(e,t,l)=>await n({method:"POST",url:i.nm,body:{name:e,parameters:t},fileName:l}),I=async e=>await n({method:"POST",url:i.N$,body:e});return(0,a.useMemo)(()=>({execute:n,whoAmI:o,hasAllPermissions:d,hasAnyPermissions:u,tables:m,metadata:c,create:f,read:N,update:p,delete:h,upsert:x,bulkCreate:v,bulkUpdate:y,bulkDelete:g,bulkUpsert:b,bulk:j,action:w,file:I}),[null==l?void 0:l.apiUrl,null==l?void 0:l.headers,null==l?void 0:l.onUnauthorized])}},9181:(e,t,l)=>{"use strict";l.r(t),l.d(t,{DataTableContext:()=>em,default:()=>eh,useDataTableContext:()=>ef});var a=l(6514),s=l(9076),i=l(5834),r=l(9641),n=l(8633),o=l(9631),d=l(7232);let u={page:1,fields:null,orderBy:null,searchField:null,searchValue:null,setData:null,active:null};var c=l(304),m=l(2038),f=l(8718),p=l(7206);let h=()=>{var e,t,l;let s=ef(),[r,n]=(0,i.useState)({searchField:null,searchValue:null}),[o]=(0,f.o)(r.searchValue,500),d=()=>s.getFields().filter(e=>"string"==typeof e.displayName&&null!=e.metadataField).map((e,t)=>{var l,a,s,i;let r=null!=(i=null==(l=e.metadataField)?void 0:l.lookupName)?i:null==(a=e.metadataField)?void 0:a.name;return{value:"".concat(e.alias).concat(""!==e.alias?".":"").concat(r),label:null==(s=e.metadataField)?void 0:s.displayName}}),h=async()=>{var e,t;let l=null==(t=s.state.metadata)||null==(e=t.fields.find(e=>e.name===r.searchField))?void 0:e.type,a="";if("DateTime"===l&&(null==o?void 0:o.trim())!==""){let e=(0,p.qn)();a="~".concat(e)}let i=o+a,n=await s.getData({...u,page:1,searchField:r.searchField,searchValue:i,active:"Active"===s.state.activeSwitch,orderBy:s.state.data.orderBy});s.dispatch({type:"SEARCH_VALUE_CHANGE",payload:{searchValue:i,searchField:r.searchField,data:n.data}})};return(0,i.useEffect)(()=>{null!=o&&h()},[o,r.searchField]),(0,i.useEffect)(()=>{if(null!=s.props.tableName&&""!==s.props.tableName){var e,t,l;n({searchField:null!=(l=null==(t=d())||null==(e=t[0])?void 0:e.value)?l:null,searchValue:null})}},[s.props.tableName]),(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)(c.l,{placeholder:"Search",style:{width:"auto"},data:null!=(e=d())?e:[],value:null!=(t=r.searchField)?t:"",onChange:e=>{n({...r,searchField:e})}}),(0,a.jsx)(m.k,{placeholder:"Search...",style:{width:"auto"},value:null!=(l=r.searchValue)?l:"",onChange:e=>{n({...r,searchValue:e.currentTarget.value})}})]})};var x=l(7211),v=l(7376),y=l(6443),g=l(7188);let b=e=>{let t=(0,y.xd)(),l=ef(),{colorScheme:s,toggleColorScheme:i}=(0,g.C)(),r="dark"===s?t.colors.gray[4]:t.colors.dark[7],o="",d="";null!=l.state.data.orderBy&&l.state.data.orderBy.length>0&&(o=l.state.data.orderBy[0].field,d=l.state.data.orderBy[0].order);let u=l.getFields();return(0,a.jsx)(a.Fragment,{children:u.map((e,t)=>{if(null==e.metadataField)return(0,a.jsx)(n.X.Th,{style:{width:e.width},className:"".concat(e.width.endsWith("px")?"flex-none":""," truncate"),children:(0,a.jsx)("div",{className:"flex items-center",children:"string"==typeof e.displayName?e.displayName:e.displayName(l.refHandle)})},t);let s=e.metadataField,i=(null==s?void 0:s.lookupName)!=null?s.lookupName:s.name,u="".concat(e.alias).concat(""!==e.alias?".":"").concat(i);if(null!=s)return(0,a.jsx)(n.X.Th,{style:{width:e.width},className:"".concat(e.width.endsWith("px")?"flex-none":""," truncate"),children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("span",{className:"cursor-pointer",onClick:()=>{l.sort(u)},children:s.displayName}),o===u&&"desc"===d&&(0,a.jsx)(x.A,{size:16,strokeWidth:2,color:r,className:" ml-2"}),o===u&&"asc"===d&&(0,a.jsx)(v.A,{size:16,strokeWidth:2,color:r,className:"ml-2"})]})},u)})})};var j=l(5261);let N=e=>{let t=ef();return void 0!==e.disabledMessage?(0,a.jsx)("div",{className:"w-full h-full flex flex-col justify-center items-center",children:e.disabledMessage}):e.isLoadingData?(0,a.jsx)("div",{className:"w-full h-full flex justify-center items-center",children:(0,a.jsx)(j.a,{})}):"MISSING_READ_PERMISSIONS"===t.state.type?(0,a.jsx)("div",{className:"w-full h-full flex flex-col justify-center items-center",children:(0,a.jsxs)("div",{children:["Missing read permission for ",e.tableName,"."]})}):void 0};var w=l(4658),I=l(9967),C=l(742),E=l(4243),A=l(40),T=l(9005),S=l(964),R=l(91),D=l(6444),k=l(8647);let _={getHighestPermissionLevel:e=>void 0!==e.find(e=>e.endsWith("_SYSTEM"))?"SYSTEM":void 0!==e.find(e=>e.endsWith("_TEAM"))?"TEAM":void 0!==e.find(e=>e.endsWith("_USER"))?"USER":"NONE"};var F=l(2894);let L=(0,k.vt)()((e,t)=>({tablePermissions:[],teams:[],getTablePermissions:async(e,l)=>{let a=t().tablePermissions.find(e=>e.tableName===l);if(void 0!==a)return a.permissions;let s="".concat("TABLE_{tableName}_READ_SYSTEM, TABLE_{tableName}_READ_TEAM, TABLE_{tableName}_READ_USER".replaceAll("{tableName}",l),", ").concat("TABLE_{tableName}_CREATE_SYSTEM, TABLE_{tableName}_CREATE_TEAM, TABLE_{tableName}_CREATE_USER".replaceAll("{tableName}",l),", ").concat("TABLE_{tableName}_DELETE_SYSTEM, TABLE_{tableName}_DELETE_TEAM, TABLE_{tableName}_DELETE_USER".replaceAll("{tableName}",l),", ").concat("TABLE_{tableName}_UPDATE_SYSTEM, TABLE_{tableName}_UPDATE_TEAM, TABLE_{tableName}_UPDATE_USER".replaceAll("{tableName}",l)),i=await e.execute({url:D.rG,method:"POST",body:{method:"has_permissions",parameters:{permissionNames:s.split(",").map(e=>e.trim())}}});if((null==i?void 0:i.succeeded)===!0){let e=i.data;if(e.length>0){let t=e.filter(e=>e.startsWith("TABLE_".concat(l,"_READ"))),a=e.filter(e=>e.startsWith("TABLE_".concat(l,"_CREATE"))),s=e.filter(e=>e.startsWith("TABLE_".concat(l,"_DELETE"))),i=e.filter(e=>e.startsWith("TABLE_".concat(l,"_UPDATE")));return{read:_.getHighestPermissionLevel(t),create:_.getHighestPermissionLevel(a),delete:_.getHighestPermissionLevel(s),update:_.getHighestPermissionLevel(i)}}}return{read:"NONE",create:"NONE",delete:"NONE",update:"NONE"}},getPermissions:async(e,l)=>{let a=t().tablePermissions,s=l.filter(e=>null!=a.find(t=>t.tableName===e));if(s.length===l.length)return s;let i=await e.execute({url:D.rG,method:"POST",body:{method:"has_permissions",parameters:{permissionNames:l}}});return(null==i?void 0:i.succeeded)===!0?i.data:[]},getTeams:async l=>{var a,s;if(t().teams.length>0)return t().teams;let i=new F.Ay(["Name"]).top(99999).from("Team").join("Team.TeamId","TeamUser.TeamId","tu").join("tu.UserId","User.UserId","u").distinct().toReadRequest(),r=await l.read(i);return r.succeeded?(e({teams:null!=(a=r.data.results.map(e=>e.Name))?a:[]}),null!=(s=r.data.results.map(e=>e.Name))?s:[]):[]}}));var B=l(2651),P=l(9590);let O=e=>{let t=(0,s.A)(),l=ef(),[r,n]=i.useState(null),[o,d]=i.useState(!1),[u,m]=i.useState("create,update"),[f,p]=i.useState([]),h=async()=>{if(null===r)return;d(!0);let a=new FormData;a.append("file",r),a.append("name","TABLE_ImportData"),a.append("parameters",JSON.stringify({tableName:l.props.tableName,operation:u}));let s=await t.execute({url:D.N$,method:"POST",body:a,hideFailureMessage:!0});if((null==s?void 0:s.succeeded)===!1){let e=s.data;if(null!=e&&null!=e.errors&&e.errors.length>0)p(e.errors);else{var i;p([null!=(i=s.friendlyMessage)?i:"Unknown error"])}}else(null==s?void 0:s.succeeded)===!0&&(l.refresh(),e.close());d(!1)};return(0,i.useEffect)(()=>{!0===e.opened&&(d(!1),n(null),p([]))},[e.opened]),(0,a.jsx)(B.a,{opened:e.opened,onClose:e.close,title:"Import Data",size:"lg",closeOnEscape:!o,closeOnClickOutside:!o,withCloseButton:!o,centered:!0,styles:{overlay:{zIndex:4e3},inner:{zIndex:4001}},children:f.length>0?(0,a.jsx)("div",{className:"w-full flex flex-col gap-4 h-96",children:(0,a.jsx)("div",{className:"w-full h-full flex flex-col gap-2 overflow-y-auto",children:f.map((e,t)=>(0,a.jsx)("div",{className:"w-full bg-red-100 py-2 rounded-md",children:e},t))})}):(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)("div",{className:"w-full relative",children:[!0===o&&(0,a.jsx)("div",{className:"absolute w-full h-full flex justify-center items-center",children:(0,a.jsx)(j.a,{})}),(0,a.jsxs)("div",{className:"w-full flex flex-col gap-4 ".concat(o?"invisible":""),children:[(0,a.jsx)(c.l,{label:"Operation",placeholder:"Select Operation",data:[{value:"create,update",label:"Create and Update"},{value:"create",label:"Create Only"},{value:"update",label:"Update Only"}],value:u,onChange:e=>{m(e)}}),(0,a.jsx)(P.z,{placeholder:"Click to choose import file",label:"File Upload",required:!0,value:r,onChange:e=>{n(e)}}),(0,a.jsx)("div",{className:"w-full flex justify-end",children:(0,a.jsx)(I.$,{onClick:h,disabled:null===r,children:"Upload"})})]})]})})})};var M=l(4918),U=l(4180);let W=e=>{var t,l;let s=ef(),r=s.getFields(),[n,o]=(0,i.useState)(null!=(l=null==(t=s.state.metadata)?void 0:t.fields.filter(e=>{var t;return e.name!==(null==(t=s.state.metadata)?void 0:t.primaryKey)}).map(e=>({metadataField:e,isVisible:null!=r.find(t=>{var l;return(null==(l=t.metadataField)?void 0:l.name)===e.name})})))?l:[]);return(0,a.jsx)(B.a,{opened:e.opened,onClose:e.close,title:"Columns",size:"xs",centered:!0,styles:{overlay:{zIndex:4e3},inner:{zIndex:4001}},children:(0,a.jsxs)("div",{className:"w-full flex flex-col max-h-[80vh]",children:[(0,a.jsx)("div",{className:"w-full overflow-y-scroll flex flex-col gap-2",children:n.map(e=>(0,a.jsx)("div",{className:"flex gap-2",children:(0,a.jsx)(U.S,{label:e.metadataField.displayName,checked:e.isVisible,onChange:t=>{var l,a;return l=e.metadataField.name,a=t.currentTarget.checked,void o(e=>e.map(e=>e.metadataField.name===l?{...e,isVisible:a}:e))}})},e.metadataField.name))}),(0,a.jsx)("div",{className:"w-full flex justify-end py-1",children:(0,a.jsx)(I.$,{onClick:()=>{s.dispatch({type:"SET_VISIBLE_FIELDS",payload:{visibleFields:n.filter(e=>e.isVisible).map(e=>e.metadataField.name)}}),e.close()},children:"Set"})})]})})},V=()=>{let[e,t]=(0,i.useState)(void 0),l=(0,R.A)().getIconColor(),r=(0,s.A)(),n=ef(),o=L(),[d,u]=(0,M.j)(!1),[c,m]=(0,M.j)(!1),f=async()=>{let e=await o.getPermissions(r,["TABLE_".concat(n.props.tableName,"_IMPORT"),"TABLE_".concat(n.props.tableName,"_EXPORT"),"ACTION_TABLE_ImportData","ACTION_TABLE_ExportData"]),l=await o.getTablePermissions(r,n.props.tableName),a=!1,s=!1;e.find(e=>e==="TABLE_".concat(n.props.tableName,"_IMPORT"))&&e.find(e=>"ACTION_TABLE_ImportData"===e)&&"NONE"!==l.create&&"NONE"!==l.update&&(null==n.props.canImport||n.props.canImport)&&(a=!0),e.find(e=>e==="TABLE_".concat(n.props.tableName,"_EXPORT"))&&e.find(e=>"ACTION_TABLE_ExportData"===e)&&"NONE"!==l.read&&(null==n.props.canExport||n.props.canExport)&&(s=!0),t({Import:a,Export:s})},p=async()=>{await r.action("TABLE_ImportTemplate",{tableName:n.props.tableName},"ImportTemplate_".concat(n.props.tableName,".xlsx"))},h=async()=>{await r.action("TABLE_ExportData",{query:{tableName:n.props.tableName,fields:["*"],orderBy:n.props.orderBy,filters:n.props.filters,joins:n.props.joins,except:n.props.except,maxResults:999999}},"ExportData_".concat(n.props.tableName,".xlsx"))};return((0,i.useEffect)(()=>{e||f()},[e,n.state.isLoadingData]),n.props.disabledMessage||null==n.state.metadata)?(0,a.jsx)(a.Fragment,{}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(O,{opened:d,close:u.close}),null!=n.state.metadata&&(0,a.jsx)(W,{opened:c,close:m.close}),(0,a.jsxs)(w.W,{shadow:"md",width:200,children:[(0,a.jsx)(w.W.Target,{children:(0,a.jsx)(I.$,{radius:"xl",variant:"subtle",styles:{root:{padding:6}},children:(0,a.jsx)(C.A,{size:24,strokeWidth:2,color:l})})}),(0,a.jsxs)(w.W.Dropdown,{children:[(0,a.jsx)(w.W.Label,{children:"View"}),(0,a.jsx)(w.W.Item,{onClick:m.open,leftSection:(0,a.jsx)(E.A,{size:14}),children:"Columns"}),((null==e?void 0:e.Import)||(null==e?void 0:e.Export))&&(0,a.jsx)(w.W.Label,{children:"Data"}),(null==e?void 0:e.Import)&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(w.W.Item,{leftSection:(0,a.jsx)(A.A,{size:14}),onClick:p,children:"Import Template"}),(0,a.jsx)(w.W.Item,{leftSection:(0,a.jsx)(T.A,{size:14}),onClick:u.open,children:"Import Data"})]}),(null==e?void 0:e.Export)&&(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(w.W.Item,{leftSection:(0,a.jsx)(S.A,{size:14}),onClick:h,children:"Export Data"})})]})]})]})},z=e=>{var t,l,s,i,c,m,f,p,x,v;let y=ef(),g=(0,R.A)(),j=void 0!==y.state.metadata,w=!0===y.props.scrollable||void 0===y.props.scrollable,I=(void 0===y.props.canCreate||!0===y.props.canCreate)&&"NONE"!==y.state.permissions.create&&void 0===y.props.disabledMessage,C=null==y.props.disabledMessage&&"NONE"!==y.state.permissions.read,E=null!=y.props.customCreateButton?null==(t=(l=y.props).customCreateButton)?void 0:t.call(l,()=>y.openForm(void 0)):void 0,A="NONE"!==y.state.permissions.read&&void 0===y.props.disabledMessage&&(null==y.props.searchable||!0===y.props.searchable),T=!0===y.props.showActiveSwitch&&"NONE"!==y.state.permissions.read&&void 0===y.props.disabledMessage&&(null==(s=y.state.metadata)?void 0:s.fields.find(e=>"IsActive"===e.name))!=null,S=!0===y.props.showOptions||null==y.props.showOptions,D=void 0!==y.props.disabledMessage||"NONE"===y.state.permissions.read||!0===y.state.isLoadingData?(0,a.jsx)(N,{tableName:y.props.tableName,permissions:y.state.permissions,isLoadingData:y.state.isLoadingData,disabledMessage:y.props.disabledMessage}):void 0,k=void 0===y.props.title||""!==y.props.title||S||T||A||I||null!=E,_=async e=>{await y.getData({...u,page:e,orderBy:y.state.data.orderBy,setData:!0}),void 0!==y.props.onPageChange&&y.props.onPageChange(e)},F=async e=>{let t=await y.getData({...u,page:1,active:"Active"===e,setData:!0,searchField:y.state.searchField,searchValue:y.state.searchValue,orderBy:y.state.data.orderBy});y.dispatch({type:"ACTIVE_SWITCH_CHANGE",payload:{activeSwitch:e,data:t.data}})};return(0,a.jsxs)("div",{className:"relative flex flex-col h-full w-full rtable",children:[void 0!==D&&(0,a.jsx)("div",{className:" absolute w-full h-full pt-11",children:(0,a.jsx)("div",{className:"w-full h-full",children:D})}),(0,a.jsxs)("div",{className:"text-lg flex justify-between items-center",children:[(0,a.jsx)("div",{className:"flex items-center",children:j?void 0!==y.props.title?y.props.title:"Manage ".concat(void 0===y.state.metadata?y.props.tableName:null==(i=y.state.metadata)?void 0:i.displayName,"s"):""}),(0,a.jsxs)("div",{className:"".concat(k?"flex":"hidden"," items-center gap-2"),children:[S&&(0,a.jsx)(V,{}),T&&(0,a.jsx)("div",{className:" m-2",children:(0,a.jsx)(r.I,{data:["Active","Inactive"],size:"sm",styles:{label:{paddingLeft:"0.5125rem",paddingRight:"0.5125rem",paddingTop:0,paddingBottom:0}},onChange:e=>{F(e)}})}),!0===A?(0,a.jsx)(h,{}):(0,a.jsx)("div",{className:" w-1 h-9"}),I&&null==E&&(0,a.jsx)("div",{onClick:()=>{y.openForm(void 0),null!=y.props.formOnOpen&&y.props.formOnOpen("CREATE",void 0)},className:"p-1 rounded-full w-8 h-8 flex justify-center items-center cursor-pointer",style:{backgroundColor:g.getPrimaryColor()},children:(0,a.jsx)(d.A,{size:22,strokeWidth:2,color:"white"})}),I&&null!=E&&(0,a.jsx)("div",{children:E})]})]}),(0,a.jsxs)(n.X,{"aria-label":y.props.title,highlightOnHover:null==(p=null==(c=y.props.tableStyle)?void 0:c.highlighOnHover)||p,striped:null!=(x=null==(m=y.props.tableStyle)?void 0:m.striped)&&x,withColumnBorders:null!=(v=null==(f=y.props.tableStyle)?void 0:f.withColumnBorders)&&v,className:"".concat(w?"  overflow-x-hidden":""," flex flex-col grow"),children:[(0,a.jsx)(n.X.Thead,{className:"".concat(w?"px-2":""),children:!y.state.isLoadingData&&(0,a.jsx)(n.X.Tr,{className:"flex",children:(0,a.jsx)(b,{})})}),(0,a.jsx)(n.X.Tbody,{className:"relative overflow-x-hidden ".concat(w?"grow overflow-y-scroll pl-2 pr-0.5":""," "),children:e.children})]}),!0===C&&(0,a.jsxs)("div",{className:"w-full flex justify-between items-center mt-4 px-2",children:[(0,a.jsx)("div",{className:" text-sm",children:void 0!==y.state.data.totalResults&&y.state.data.maxResults&&y.state.data.currentPage&&(0,a.jsxs)(a.Fragment,{children:[0===y.state.data.results.length?0:y.state.data.currentPage*y.state.data.maxResults-(y.state.data.maxResults-1)," - ",y.state.data.currentPage*y.state.data.maxResults>y.state.data.totalResults?y.state.data.totalResults:y.state.data.currentPage*y.state.data.maxResults," of ",y.state.data.totalResults]})}),(null==y.props.pagination||!0===y.props.pagination)&&(0,a.jsx)(o.d,{value:y.state.data.currentPage,total:y.state.data.pages<1?1:y.state.data.pages,onChange:e=>{_(e)},size:"sm",withEdges:!0})]})]})};var H=l(9639),G=l(6915);let q=()=>({type:"INSTANTIATED",tableName:void 0,data:void 0,snapshot:void 0,dirtyFields:[],validationMessages:[],metadata:void 0,canUpdate:!0,canCreate:!0,canRead:{canRead:!0,message:""},isLoading:!0,forceIsLoading:!1,isSubmitted:!1,eventListeners:[]}),J=(e,t)=>{var l,a,s;switch(console.log("FormBuilder: "+t.type),t.type){case"START_INITIAL_LOAD":return{...q(),data:t.payload.data,snapshot:void 0,metadata:e.metadata,isLoading:!0,forceIsLoading:null!=(l=t.payload.forceIsLoading)&&l,type:"START_INITIAL_LOAD"};case"INITIAL_LOAD_COMPLETE":return{...e,...t.payload,isLoading:!1,dirtyFields:[],type:"INITIAL_LOAD_COMPLETE"};case"SET_FIELD_VALUE":let i=t.payload.field;return{...e,...e.dirtyFields.includes(i)?{dirtyFields:[...e.dirtyFields]}:{dirtyFields:[...e.dirtyFields,i]},data:{...e.data,[i]:t.payload.value},type:"SET_FIELD_VALUE"};case"SET_IS_LOADING":return{...e,isLoading:!0,type:"SET_IS_LOADING"};case"SUBMIT_COMPLETE":return{...e,isLoading:!1,isSubmitted:!0,validationMessages:[],dirtyFields:[],type:"SUBMIT_COMPLETE"};case"SUBMIT_COMPLETE_LOADING":return{...e,isSubmitted:!0,validationMessages:[],dirtyFields:[],type:"SUBMIT_COMPLETE"};case"SUBMIT_CANCELLED":return{...e,isLoading:!1,type:"SUBMIT_CANCELLED"};case"SET_VALIDATION_MESSAGES":return{...e,validationMessages:t.payload,type:"SET_VALIDATION_MESSAGES"};case"SET_VALIDATION_MESSAGE":let r=t.payload;return{...e,validationMessages:[...e.validationMessages.filter(e=>e.field!==r.field),r],type:"SET_VALIDATION_MESSAGE"};case"SET_DATA_TO_EDIT":let n=t.payload;return{...e,validationMessages:[],snapshot:t.payload.snapshot,data:t.payload.data,canUpdate:null!=t.payload.data&&(null==n.canUpdate||!1!=n.canUpdate)&&null!=(a=null==n?void 0:n.data._ui_info_.canUpdate)&&a,forceIsLoading:null!=(s=n.forceIsLoading)&&s,type:"SET_DATA_TO_EDIT"};case"CLEAR_EDIT_DATA":return{...e,type:"CLEAR_EDIT_DATA",data:e.snapshot};case"CLEAR":return{...e,type:"CLEAR",data:void 0,snapshot:void 0};case"SET_SHOW_FORCE_LOADING":return{...e,forceIsLoading:t.payload.forceIsLoading,type:"SET_SHOW_FORCE_LOADING"}}return{...e}};var K=l(492),X=l(2676);let Y=()=>({get:()=>(0,K.A)(),validate:e=>(0,X.A)(e)});var $=l(2822),Q=l(9692);let Z=e=>{let t=(()=>{if(!0===e.formBuilder.isLoading)return!0;if(void 0!==e.formBuilder&&void 0!==e.formBuilder.metadata&&void 0!==e.formBuilder.data){for(let t of e.formBuilder.metadata.fields.filter(t=>{var l;return t.name!==(null==(l=e.formBuilder.metadata)?void 0:l.primaryKey)}))if(void 0===e.formBuilder.data[t.name])return console.warn("No data for field: "+t.name+". Ensure lookup fields are spelled correctly."),!0}return!1})()||!0===e.showLoading;return(0,a.jsx)(Q.Ay,{formBuilder:e.formBuilder,children:(0,a.jsxs)("form",{onSubmit:t=>{t.preventDefault(),t.stopPropagation(),e.formBuilder.save(e.onPreValidate,e.onPreSave,e.onPostSave)},className:"".concat(t||!0===e.showLoading||!e.formBuilder.canRead.canRead||!e.formBuilder.canCreate?"relative overflow-hidden":""," ").concat(e.className),children:[t&&(0,a.jsx)("div",{className:"absolute w-full h-full flex justify-center items-center",style:{zIndex:4e3},children:(0,a.jsx)(j.a,{})}),!t&&!1===e.formBuilder.canRead.canRead&&(0,a.jsx)("div",{className:"absolute w-full h-full flex justify-center items-center text-center",style:{zIndex:10},children:e.formBuilder.canRead.message}),!t&&"CREATE"===e.formBuilder.operation&&!1===e.formBuilder.canCreate&&(0,a.jsx)("div",{className:"absolute w-full h-full flex justify-center items-center text-center",style:{zIndex:10},children:"This record doesn't exist or you are missing the required permissions to create ".concat(e.formBuilder.tableName)}),(0,a.jsx)("div",{className:"".concat(t||!1===e.formBuilder.canRead.canRead||"CREATE"===e.formBuilder.operation&&!1===e.formBuilder.canCreate?"invisible":""," ").concat(e.className),children:e.children})]})})},ee=(0,i.forwardRef)((e,t)=>{var l,r,n,o;let d=ef(),c=(e=>{var t,l;let a=(0,s.A)(),r=L(),n=Y(),o=(0,i.useRef)(null),[d,u]=(0,i.useReducer)(J,q()),[c,m]=(0,i.useState)([]),f=(0,i.useRef)(null),p=(0,i.useRef)(null),h=(0,i.useRef)(null),x=[],v=[],y=async t=>{if(null==e.tableName||""===e.tableName)return;if(console.log("LOADING FORM: "+e.tableName),!t.refresh){var l,s;u({type:"START_INITIAL_LOAD",payload:{tableName:e.tableName,data:null!=d.metadata?await g(d.metadata,void 0):void 0,forceIsLoading:null!=(s=null!=(l=t.forceShowLoading)?l:e.forceShowLoading)&&s}})}let i=e.metadata;null==i&&(i=await a.metadata(e.tableName));let n=e.snapshot,o=!1,f=!1,p=!1;if(null==e.snapshot&&null!=t.id||t.refresh){let l=await a.read({tableName:e.tableName,fields:["*"],maxResults:1,page:1,id:t.refresh&&d.metadata?d.snapshot[d.metadata.primaryKey]:t.id});if(null==l||!l.succeeded)return;null==l.data.results||0===l.data.results.length?o=!0:((n=l.data.results[0])._parameters_=l.data.parameters,f=n._ui_info_.canUpdate)}null!=e.snapshot&&(f=e.snapshot._ui_info_.canUpdate);let h=await g(i,n);"NONE"!==(await r.getTablePermissions(a,e.tableName)).create&&(p=!0),null!=e.canUpdate&&!1===e.canUpdate&&(f=!1),null!=e.canCreate&&!1===e.canCreate&&(p=!1),t.refreshDatatables&&await N(),u({type:"INITIAL_LOAD_COMPLETE",payload:{metadata:i,snapshot:n,data:h,canUpdate:f,canCreate:p,canRead:{canRead:!o,message:o?"This record doesn't exist or you are missing the required permissions to access ".concat(e.tableName):""}}}),c.length>0&&(j(c.pop()),m([]))},g=async(t,l)=>{if(void 0!==t){if(void 0===l){var a;return{...await b(t),...null==(a=e.defaults)?void 0:a.reduce((e,t)=>({...e,[t.field]:t.value}),{})}}if(null!=l){let e=Object.keys(l).reduce((e,a)=>(null!==l[a]&&(void 0!==t.fields.find(e=>e.name===a)||["_ui_info_"].includes(a)||a===t.primaryKey)&&(e[a]=l[a]),e),{});return{...await b(t),...e}}}},b=async t=>{let l=t.fields.filter(e=>["Single","Int32","Int64","Double","Decimal","Byte","SByte","UInt32","UInt64","Int16","UInt16"].includes(e.type)).map(e=>({field:e.name,value:e.isNullable?"":0})),a=null==t?void 0:t.fields.filter(e=>e.name!==t.primaryKey).filter(e=>["String","Guid","Char"].includes(e.type)).map(e=>({field:e.name,value:"Char"!==e.type||e.isNullable?"":"A"})),s=null==t?void 0:t.fields.filter(e=>"Boolean"===e.type).map(e=>({field:e.name,value:!1})),i=new Date;i.setUTCHours(0,0,0,0);let r=null==t?void 0:t.fields.filter(e=>"DateTime"===e.type).map(e=>({field:e.name,value:e.isNullable?null:i.toISOString()})),n=null==t?void 0:t.fields.filter(e=>"Lookup"===e.type).map(t=>{var l,a,s;return{field:t.name,value:null!=(s=null==(a=e.defaults)||null==(l=a.find(e=>e.field===t.name))?void 0:l.value)?s:null}});return{...null==l?void 0:l.reduce((e,t)=>({...e,[t.field]:t.value}),{}),...null==a?void 0:a.reduce((e,t)=>({...e,[t.field]:t.value}),{}),...null==s?void 0:s.reduce((e,t)=>({...e,[t.field]:t.value}),{}),...null==r?void 0:r.reduce((e,t)=>({...e,[t.field]:t.value}),{}),...null==n?void 0:n.reduce((e,t)=>({...e,[t.field]:t.value}),{}),_ui_info_:{canUpdate:!0,canDelete:!0}}},j=async(t,l)=>{void 0!==d.metadata?u({type:"SET_DATA_TO_EDIT",payload:{data:await g(d.metadata,t),snapshot:t,...null!=e.canUpdate?{canUpdate:e.canUpdate}:{},forceIsLoading:null!=l&&l}}):m(e=>[...e,t])},N=()=>{for(let e of x)e.refresh()},w=async(t,l,s)=>{var i;let r={...d.data},n={};for(let l of[e.onPreValidate,t,f.current]){if(null==l)continue;let e=await l(r);if(!1===e.continue)return void u({type:"SUBMIT_CANCELLED"});n={...n,...e.parameters}}if(!C())return;for(let t of(u({type:"SET_IS_LOADING"}),[e.onPreSave,l,p.current])){if(null==t)continue;let e=await t(r);if(!1===e.continue)return void u({type:"SUBMIT_CANCELLED"});n={...n,...e.parameters}}let o=await a.execute({url:void 0===d.snapshot?D.Lx:D.I7,method:void 0===d.snapshot?"POST":"PATCH",body:{tableName:null==(i=d.metadata)?void 0:i.tableName,fields:r,parameters:n}}),c=[e.onPostSave,s,h.current];if((null==o?void 0:o.succeeded)===!0)for(let e of c)null!=e&&await e(void 0===d.snapshot?"CREATE":"UPDATE",d.metadata?o.data[d.metadata.primaryKey]:"",o.data);else for(let e of c)null!=e&&await e("FAILED","",{});o.succeeded&&e.keepLoadingOnSuccess?u({type:"SUBMIT_COMPLETE_LOADING"}):u({type:"SUBMIT_COMPLETE"}),N()},I=async e=>{var t;return(await a.execute({url:void 0===d.snapshot?D.Lx:D.I7,method:void 0===d.snapshot?"POST":"PATCH",body:{tableName:null==(t=d.metadata)?void 0:t.tableName,fields:d.data,parameters:e}})).data},C=()=>{var e,t;let l=[];for(let a of null!=(t=null==(e=d.metadata)?void 0:e.fields.filter(e=>{var t;return e.name!==(null==(t=d.metadata)?void 0:t.primaryKey)}))?t:[]){let e=d.data[a.name];if(!["CreatedById","UpdatedById"].includes(a.name)){if(["Single","Int32","Int64","Double","Decimal"].includes(a.type)&&("-"===e||"."===e)){let t='"'.concat(e,'" is not a valid number');l.push({field:a.name,message:t})}if(("Lookup"===a.type||"DateTime"===a.type)&&(!1===a.isNullable||a.isRequired||v.includes(a.name))&&null==e){let e="".concat(a.displayName," is required");l.push({field:a.name,message:e}),console.warn(e)}if((!0===a.isRequired||v.includes(a.name))&&(null==e||""===e)){let e="".concat(a.displayName," is required");l.push({field:a.name,message:e}),console.warn(e)}if("Guid"===a.type&&""!==e&&!n.validate(e)){let e="".concat(a.displayName," is not a valid Id");l.push({field:a.name,message:e}),console.warn(e)}}}return!(l.length>0)||(u({type:"SET_VALIDATION_MESSAGES",payload:l}),!1)},E=async(e,t)=>{await y({id:e,refresh:!1,refreshDatatables:!0,forceShowLoading:t})};return(0,i.useEffect)(()=>{null!=e.tableName&&""!==e.tableName&&y({id:e.id,refresh:!1,refreshDatatables:!1})},[e.tableName,e.id]),(0,i.useEffect)(()=>{d.snapshot!=e.snapshot&&j(e.snapshot)},[e.snapshot]),(0,i.useEffect)(()=>{c.length>0&&"INITIAL_LOAD_COMPLETE"===d.type&&(j(c.pop()),m([]))},[d.type,c]),{metadata:d.metadata,dispatch:u,data:d.data,snapshot:d.snapshot,setSnapshot:j,firstInputRef:o,lookupExclusions:null!=(t=e.lookupExclusions)?t:[],lookupQueries:null!=(l=e.lookupQueries)?l:[],canUpdate:d.canUpdate,canCreate:d.canCreate,canRead:d.canRead,defaults:e.defaults,validationMessages:d.validationMessages,isLoading:d.isLoading||d.forceIsLoading,isSubmitted:d.isSubmitted,operation:null!=e.snapshot||null!=d.snapshot?"UPDATE":"CREATE",stateType:d.type,tableName:e.tableName,onPreValidateRef:f,onPreSaveRef:p,onPostSaveRef:h,reload:async function(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];d.metadata&&d.snapshot&&await y({id:d.snapshot[d.metadata.primaryKey],refresh:!0,refreshDatatables:e})},setField:(e,t)=>{var l;let a=null==(l=d.metadata)?void 0:l.fields.find(t=>t.name===e);if(null==a)throw Error("Field ".concat(e," doesn't exist on ").concat(d.tableName));if(!a.isNullable&&null===t)throw Error("Field ".concat(e," cannot be null"));u({type:"SET_FIELD_VALUE",payload:{field:e,value:t}})},setFieldError:(e,t)=>{u({type:"SET_VALIDATION_MESSAGE",payload:{field:e,message:t}})},isDirty:e=>null==e?d.dirtyFields.length>0:d.dirtyFields.includes(e),addDataTable:e=>{null!=x.find(t=>t.dataTableId===e.dataTableId)&&(x=x.filter(t=>t.dataTableId!==e.dataTableId)),x.push(e)},addRequiredField:e=>{v.includes(e)||v.push(e)},removeRequiredField:e=>{v=v.filter(t=>t!==e)},reloadDataTables:N,save:w,saveSilent:I,load:E,clearEdits:()=>{u({type:"CLEAR_EDIT_DATA"})},clear:()=>{u({type:"CLEAR"})},validate:C,setShowForceLoading:e=>{u({type:"SET_FORCE_LOADING",payload:{forceIsLoading:e}})}}})({tableName:null!=(r=null==(l=d.state.metadata)?void 0:l.tableName)?r:"",id:d.state.editRecordId,metadata:d.state.metadata,defaults:d.props.formFieldDefaults,lookupExclusions:d.props.formLookupExclusions,lookupQueries:d.props.formLookupQueries,canCreate:"NONE"!==d.state.permissions.create,canUpdate:d.props.canUpdate,onPreSave:async e=>(!0===d.props.formCloseOnCreate||d.props.formCloseOnCreate,null!=d.props.formOnPreSave&&d.props.formOnPreSave(e),{continue:!0}),onPostSave:async(e,t,l)=>{if("FAILED"===e);else if("CREATE"===e&&!1===d.props.formCloseOnCreate&&c.setSnapshot(l),"UPDATE"===e&&!1===d.props.formCloseOnUpdate&&c.setSnapshot(l),null!=d.props.formOnPostSave&&d.props.formOnPostSave(e,c.data),"CREATE"===e&&(!0===d.props.formCloseOnCreate||void 0===d.props.formCloseOnCreate)||"UPDATE"===e&&(!0===d.props.formCloseOnUpdate||void 0===d.props.formCloseOnUpdate)){var a,s;d.closeForm(),d.getData({...u,page:null==(a=d.state.data)?void 0:a.currentPage,orderBy:null==(s=d.state.data)?void 0:s.orderBy,setData:!0})}}});(0,i.useImperativeHandle)(t,()=>({formBuilder:c}));let m=!0!==d.props.formHideSaveButton&&(void 0!==c.snapshot&&!0===c.canUpdate||void 0===c.snapshot&&!0===c.canCreate);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(B.a,{opened:"START_INITIAL_LOAD"===c.stateType,onClose:()=>{},withCloseButton:!1,size:"auto",closeOnClickOutside:!1,closeOnEscape:!1,overlayProps:{blur:3},styles:{content:{display:"none"}},centered:!0}),(0,a.jsx)(B.a,{title:(()=>{var e;if(null!=d.props.formTitle)return d.props.formTitle;let t="";"UPDATE"===c.operation&&null!=c.data&&!0===c.data._ui_info_.canUpdate&&(t="Edit"),"CREATE"===c.operation&&"NONE"!==d.state.permissions.create&&(t="Create");let l=void 0===d.state.metadata?d.props.tableName:null==(e=d.state.metadata)?void 0:e.displayName;return""!==t?"".concat(t," ").concat(l):l})(),opened:d.formDisclosure.opened&&null!=c.metadata&&"START_INITIAL_LOAD"!==c.stateType,onClose:()=>{if(null!=d.props.formOnClose&&d.props.formOnClose(),c.isSubmitted){var e,t;d.closeForm(),d.getData({...u,page:null==(e=d.state.data)?void 0:e.currentPage,orderBy:null==(t=d.state.data)?void 0:t.orderBy,setData:!0})}else d.formDisclosure.close()},transitionProps:{transition:"fade",duration:100},closeOnClickOutside:!1,closeOnEscape:null==(n=d.props.formCloseOnEscape)||n,size:(()=>{if(null!=d.props.formMaxWidth)return"".concat(d.props.formMaxWidth,"rem");if(void 0!==d.state.metadata){let e=d.state.metadata.fields.filter(e=>{var t;return(null==(t=d.state.metadata)?void 0:t.primaryKey)!==e.name&&(void 0===d.props.formFields||d.props.formFields.includes(e.name))});if(e.length<=3){let t=e.length/3*72;return void 0!==d.props.formMaxWidth&&t<d.props.formMaxWidth?"".concat(d.props.formMaxWidth,"rem"):null!=d.props.formMinWidth&&t<d.props.formMinWidth?"".concat(d.props.formMinWidth,"rem"):"".concat(t,"rem")}}return void 0!==d.props.formMaxWidth&&d.props.formMaxWidth>72?"".concat(d.props.formMaxWidth,"rem"):"72rem"})(),overlayProps:{blur:3},fullScreen:null!=(o=d.props.formFullScreen)&&o,styles:{root:{overflow:"visible"},body:{...!0===c.isLoading&&{position:"relative",overflow:"hidden",paddingLeft:0,paddingRight:0},flexGrow:1},content:{display:"flex",flexDirection:"column"}},centered:!0,children:(0,a.jsxs)(Z,{formBuilder:c,className:d.props.formClassNames,children:[void 0!==d.props.customForm?d.props.customForm(c,d.formDisclosure):void 0!==d.state.metadata&&(void 0!==d.props.formFields?d.props.formFields:d.state.metadata.fields.filter(e=>{var t;return e.name!==(null==(t=d.state.metadata)?void 0:t.primaryKey)})).map((e,t)=>{if(t%3==0){var l,s;return(0,a.jsx)(H.x,{children:void 0!==d.state.metadata&&(null==(l=void 0!==d.props.formFields?d.props.formFields:null==(s=d.state.metadata)?void 0:s.fields.filter(e=>{var t;return e.name!==(null==(t=d.state.metadata)?void 0:t.primaryKey)}).map(e=>e.name))?void 0:l.slice(t,t+3).map((e,l)=>{var s;let i=null==(s=d.state.metadata)?void 0:s.fields.find(t=>t.name===e);return void 0===i?("function"!=typeof e&&"object"!=typeof e&&console.warn("Couldn't find field named ".concat(e,".")),(0,a.jsx)("div",{className:"hidden"},"".concat(t).concat(l))):("function"==typeof e&&"".concat(t).concat(l),(0,a.jsx)(H.x.Col,{span:(()=>{if(void 0!==d.state.metadata){let e=d.state.metadata.fields.filter(e=>{var t;return e.name!==(null==(t=d.state.metadata)?void 0:t.primaryKey)}).filter(e=>void 0===d.props.formFields||d.props.formFields.includes(e.name));if(e.length<=3)return 12/e.length}return 4})(),children:(0,a.jsx)(G.A,{focus:0===t&&0===l,name:i.name})},"".concat(i.name).concat(t).concat(l,"}")))}))},t)}return(0,a.jsx)("div",{className:"hidden"},t)}),void 0!==d.props.appendCustomForm?(0,a.jsx)("div",{className:"mt-2",children:d.props.appendCustomForm(c)}):(0,a.jsx)(a.Fragment,{}),null==d.props.customForm&&(0,a.jsxs)("div",{className:"w-full flex justify-end ".concat(null!=d.props.formAppendButton||m?"mt-3":""),children:[null!=d.props.formAppendButton?(0,a.jsx)(a.Fragment,{children:d.props.formAppendButton(c)}):(0,a.jsx)(a.Fragment,{}),!0!==d.props.formHideSaveButton&&(void 0!==c.snapshot&&!0===c.canUpdate||void 0===c.snapshot&&!0===c.canCreate)?(0,a.jsx)("div",{children:(0,a.jsx)($.A,{})}):(0,a.jsx)(a.Fragment,{})]})]})})]})});ee.displayName="DataForm";let et={type:"START_INITIAL_LOAD",id:"",isLoadingData:!0,permissions:{read:"NONE",create:"NONE",delete:"NONE",update:"NONE"},isTableNotFound:!1,isFormOpen:!1,metadata:void 0,joinMetadata:[],data:{pages:0,currentPage:1,totalResults:0,orderBy:[],tableName:"",maxResults:10,results:[],parameters:{}},searchField:"",searchValue:"",activeSwitch:"Active",editRecordId:null,visibleFields:void 0},el=(e,t)=>{switch(console.log("DataTable: "+t.type),t.type){case"START_INITIAL_LOAD":return{...et,isLoadingData:!0,visibleFields:e.visibleFields,type:"START_INITIAL_LOAD"};case"MISSING_READ_PERMISSIONS":return{...et,isLoadingData:!1,permissions:{...e.permissions,read:"NONE"},type:"MISSING_READ_PERMISSIONS"};case"TABLE_NOT_FOUND":return{...et,isLoadingData:!1,isTableNotFound:!0,type:"TABLE_NOT_FOUND"};case"INITIAL_LOAD_COMPLETE":return{...et,...t.payload,editRecordId:e.editRecordId,type:e.editRecordId?"OPEN_FORM":"INITIAL_LOAD_COMPLETE",visibleFields:e.visibleFields};case"SET_IS_LOADING":return{...e,isLoadingData:!0,type:"SET_IS_LOADING"};case"SET_DONE_LOADING":return{...e,isLoadingData:!1,data:t.payload,type:"SET_DONE_LOADING"};case"SEARCH_VALUE_CHANGE":return{...e,searchValue:t.payload.searchValue,searchField:t.payload.searchField,data:t.payload.data,type:"SEARCH_VALUE_CHANGE"};case"ACTIVE_SWITCH_CHANGE":return{...e,activeSwitch:t.payload.activeSwitch,type:"ACTIVE_SWITCH_CHANGE"};case"SET_METADATA":return{...e,metadata:t.payload.metadata,joinMetadata:t.payload.joinMetadata,type:"SET_METADATA"};case"SET_DATA":return{...e,data:{...e.data,results:t.payload.setDataFunction(e.data.results)},type:"SET_DATA"};case"OPEN_FORM":var l;return{...e,isFormOpen:!0,editRecordId:t.payload.editRecordId,formTableName:null==(l=e.metadata)?void 0:l.tableName,type:"OPEN_FORM"};case"CLOSE_FORM":return{...e,isFormOpen:!1,editRecordId:void 0,formTableName:void 0,type:"CLOSE_FORM"};case"SET_VISIBLE_FIELDS":return{...e,visibleFields:t.payload.visibleFields,type:"SET_VISIBLE_FIELDS"}}return{...e,...t.payload}};var ea=l(1232),es=l(9296),ei=l(9601),er=l(2702),en=l(336),eo=l(6707),ed=l.n(eo);let eu=e=>{var t,l,r,o,d;let u=(0,s.A)(),c=(0,i.useContext)(ea.BR),m=ef(),f=(0,y.xd)(),{colorScheme:p,toggleColorScheme:h}=(0,g.C)(),x=null!=e.record.IsActive&&!0===e.record.IsActive,v="dark"===p?f.colors[f.primaryColor][f.primaryShade-3]:f.colors[f.primaryColor][f.primaryShade],b=!0===e.record._ui_info_.canDelete&&(void 0===m.props.canDelete||!0===m.props.canDelete),j=!0===e.record._ui_info_.canUpdate&&(null==(t=m.state.metadata)?void 0:t.fields.find(e=>"IsActive"===e.name))!=null&&!0===m.props.canDeactivate,N=async e=>{var t,l,a,s;let i=e[null!=(l=null==(t=m.state.metadata)?void 0:t.primaryKey)?l:""];if(void 0===m.props.confirmDelete||!0===m.props.confirmDelete){let t="Confirm",l="Are you sure you want to delete this record?",r=!0;if(null!=m.props.deleteConfirmation){let i=await m.props.deleteConfirmation(e);t=null!=(a=i.title)?a:t,l=null!=(s=i.message)?s:l,r=void 0===i.showPrompt||i.showPrompt}r?null==c||c.showConfirm(l,async()=>{await C(e,m.props.tableName,i)},()=>{},t):await C(e,m.props.tableName,i)}else await C(e,m.props.tableName,i)},w=async e=>{var t,l;let a=e[null!=(l=null==(t=m.state.metadata)?void 0:t.primaryKey)?l:""];await I(m.props.tableName,a,!x)},I=async(e,t,l)=>{m.dispatch({type:"SET_IS_LOADING"}),await u.update(e,{["".concat(m.props.tableName,"Id")]:t,IsActive:l}),await m.refresh()},C=async(e,t,l)=>{m.dispatch({type:"SET_IS_LOADING"}),await u.delete(t,l),null!=m.props.onPostDelete&&m.props.onPostDelete(e),await m.refresh()},E="";if(null!=e.fieldInfo.metadataField){let t="".concat(e.fieldInfo.alias).concat(""!==e.fieldInfo.alias?".":"").concat(e.fieldInfo.metadataField.name);void 0!==e.record[e.fieldInfo.metadataField.lookupName]?E=e.record[e.fieldInfo.metadataField.lookupName]:void 0!==e.record[t]&&(E=((t,l)=>{if("Boolean"===t)return l?"Yes":"No";if("DateTime"===t){var a;if(null==l||"0001-01-01T00:00:00"===l)return"";if((null==(a=e.fieldInfo.metadataField)?void 0:a.dateFormat)!=null)return ed()(Date.parse(l)).format(e.fieldInfo.metadataField.dateFormat);let t=new Date(l.replace("Z","")),s=String(t.getMonth()+1).padStart(2,"0"),i=String(t.getDate()).padStart(2,"0"),r=t.getFullYear();return"".concat(s,"/").concat(i,"/").concat(r)}return l})(e.fieldInfo.metadataField.type,e.record[t]))}return(0,a.jsxs)(n.X.Td,{className:"".concat((null==(l=m.props.tableStyle)?void 0:l.truncate)===!0||(null==(r=m.props.tableStyle)?void 0:r.truncate)==null?"truncate":""," cursor-pointer relative ").concat(e.fieldInfo.width.endsWith("px")?"flex-none":""),style:{width:e.fieldInfo.width,height:(null==(o=m.props.tableStyle)?void 0:o.truncate)===!0||(null==(d=m.props.tableStyle)?void 0:d.truncate)==null?"36.7px":""},children:[null!=e.fieldInfo.body?e.fieldInfo.body(e.record,m.refHandle):E,(j||b)&&(0,a.jsx)(e=>{let{children:t}=e;return(0,a.jsx)("div",{className:"absolute right-0 top-0 bottom-0 flex items-center cursor-pointer xams_delete",children:(0,a.jsx)("div",{className:"flex items-center p-0.5 rounded gap-1",style:{backgroundColor:"dark"===p?f.colors.gray[f.primaryShade+2]:f.colors.gray[f.primaryShade-5]},children:t})})},{children:(0,a.jsxs)(a.Fragment,{children:[j&&(0,a.jsx)(e=>{let{record:t}=e;return x?(0,a.jsx)(en.m,{label:"Deactivate",withArrow:!0,children:(0,a.jsx)(ei.A,{onClick:e=>{e.stopPropagation(),w(t)},size:26,strokeWidth:2,color:v})}):(0,a.jsx)(en.m,{label:"Activate",withArrow:!0,children:(0,a.jsx)(er.A,{onClick:e=>{e.stopPropagation(),w(t)},size:26,strokeWidth:2,color:v})})},{record:e.record}),b&&(0,a.jsx)(e=>{let{record:t}=e;return(0,a.jsx)(en.m,{label:"Delete",withArrow:!0,children:(0,a.jsx)(es.A,{onClick:e=>{e.stopPropagation(),N(t)},size:26,strokeWidth:2,color:v})})},{record:e.record})]})})]})},ec=()=>{var e;let t=ef();return(0,a.jsx)(a.Fragment,{children:!1===t.state.isLoadingData&&(null==(e=t.state.data)?void 0:e.results)!=null&&t.state.data.results.filter(e=>{var l;return t.props.tableName===(null==(l=t.state.metadata)?void 0:l.tableName)}).map((e,l)=>void 0!==t.props.customRow?(0,a.jsx)(n.X.Tr,{className:"w-full",children:t.props.customRow(e)},t.state.metadata?e[t.state.metadata.primaryKey]:l):(0,a.jsx)(n.X.Tr,{className:"flex relative items-start",onClick:()=>{t.openForm(e),null!=t.props.formOnOpen&&t.props.formOnOpen("UPDATE",e)},children:t.getFields().map((s,i)=>{let r="".concat(t.state.metadata?e[t.state.metadata.primaryKey]:l,"-").concat(i);return(0,a.jsx)(eu,{record:e,fieldInfo:s},r)})},t.state.metadata?e[t.state.metadata.primaryKey]:l))})},em=i.createContext(null),ef=()=>{let e=i.useContext(em);if(null==e)throw Error("useDataTableContext must be used within a DataTableContextProvider");return e},ep=(0,i.forwardRef)((e,t)=>{let l=(0,s.A)(),r=(0,i.useContext)(Q.cK),n=L(),o=Y(),d=(0,i.useRef)(null),[c,m]=(0,i.useState)(o.get()),[f,h]=(0,i.useReducer)(el,{...et,id:c}),x=(0,i.useRef)(!1),v=(0,i.useRef)(f);if(null!=e.fields&&null!=e.columnWidths&&e.fields.length!==e.columnWidths.length)throw Error("Fields and columnWidths must be the same length in DataTable");let y=async()=>{h({type:"START_INITIAL_LOAD"});let t=null!=f.metadata&&f.metadata.tableName===e.tableName?f.metadata:await l.metadata(e.tableName),a=[];if(null!=e.joins)for(let t of e.joins){let e=await l.metadata(t.toTable);null!=e&&a.push(e)}if(null==t)return void h({type:"TABLE_NOT_FOUND"});if(e.disabledMessage)return void h({type:"SET_METADATA",payload:{metadata:t,joinMetadata:a}});let s=await n.getTablePermissions(l,e.tableName);if("NONE"===s.read)return void h({type:"MISSING_READ_PERMISSIONS"});let i=await j({...u,metadata:t,joinMetadata:a,fields:g(t),page:1,active:!0===e.showActiveSwitch||null,orderBy:e.orderBy,searchField:"",searchValue:""});(null==i?void 0:i.succeeded)&&(b(t),null!=e.onInitialLoad&&e.onInitialLoad(i.data.results),h({type:"INITIAL_LOAD_COMPLETE",payload:{permissions:s,metadata:t,joinMetadata:a,data:i.data,isLoadingData:!1,activeSwitch:!0===e.showActiveSwitch?"Active":null}}))},g=t=>{var l,a;let s=2*t.fields.filter(e=>null!=e.lookupName&&""!==e.lookupName).length+t.fields.filter(e=>null==e.lookupName||""===e.lookupName).length,i=null!=(a=e.fields)?a:t.fields.map(e=>e.name).slice(0,s+1);return null!=f.visibleFields&&(null==(l=f.visibleFields)?void 0:l.length)>0&&(i=f.visibleFields),i},b=t=>{void 0!==e.fields&&e.fields.forEach(l=>{"function"!=typeof l&&(void 0!==t.fields.find(e=>e.name===l)||l===e.tableName+"Id"||"object"==typeof l||l.includes(".")||console.warn("Field ".concat(l," not found in metadata for table ").concat(e.tableName)))})},j=async t=>{var a,s,i,r,n,o,d,u,c,m,p,x,v,y,b;(null==t?void 0:t.setData)!=null&&!0===t.setData&&!1===f.isLoadingData&&(null==t.showLoading||!0===t.showLoading)&&h({type:"SET_IS_LOADING"});let j=null!=(r=null!=(i=null==t?void 0:t.metadata)?i:f.metadata)?r:await l.metadata(e.tableName),N=[];0===(N=null!=(o=null==(a=null!=(n=f.visibleFields)?n:e.fields)?void 0:a.filter(e=>"string"==typeof e&&!e.includes(".")))?o:[]).length&&(N=null!=(u=null==t||null==(d=t.fields)?void 0:d.filter(e=>"string"==typeof e&&!e.includes(".")))?u:[]),0===N.length&&(N=g(j));let w=[];if(null==N||N.forEach(e=>{if(e.endsWith("Id")){let t=null==j?void 0:j.fields.find(t=>t.name===e);(null==t?void 0:t.type)==="Lookup"&&void 0===N.find(e=>e===t.lookupName)&&w.push(t.lookupName)}}),null==N||N.push(...w),null!=e.additionalFields)for(let t of e.additionalFields)void 0===N.find(e=>e===t)&&N.push(t);j&&(null==N?void 0:N.find(e=>e===j.primaryKey))===void 0&&(null==N||N.push(j.primaryKey)),e.canDeactivate&&void 0===N.find(e=>"IsActive"===e)&&(null==j?void 0:j.fields.find(e=>"IsActive"===e.name))!==void 0&&N.push("IsActive");let I=await l.read({tableName:e.tableName,page:null==t?1:t.page,fields:N,maxResults:null!=(c=e.maxResults)?c:10,except:e.except,orderBy:null!=(p=null!=(m=null==t?void 0:t.orderBy)?m:null==(s=f.data)?void 0:s.orderBy)?p:[],filters:[{field:null==t?"":null!=(v=null!=(x=t.searchField)?x:f.searchField)?v:"",value:null==t?"":null!=(b=null!=(y=t.searchValue)?y:f.searchValue)?b:""},...!0===e.showActiveSwitch&&j.fields.find(e=>"IsActive"===e.name)?[{field:"IsActive",operator:"==",value:(null==t?void 0:t.active)!=null?null==t?void 0:t.active.toString():"Active"===f.activeSwitch?"true":"false"}]:[],...void 0!==e.filters?e.filters.map(e=>({field:e.field,operator:e.operator,value:e.value})):[]],joins:void 0!==e.joins?e.joins:[]});return(null==t?void 0:t.setData)!=null&&!0===t.setData&&h({type:"SET_DONE_LOADING",payload:I.data}),null!=e.onDataLoaded&&e.onDataLoaded(I.data),I},N=async t=>{if(null==e.disabledMessage){var l,a;let s=null==(l=v.current.data)?void 0:l.orderBy;(null==s||0===s.length)&&(s=null!=(a=e.orderBy)?a:[]),await j({...u,page:v.current.data.currentPage,showLoading:t,searchField:v.current.searchField,searchValue:v.current.searchValue,orderBy:s,active:"Active"===v.current.activeSwitch,setData:!0})}},w=t=>null!=e.columnWidths&&e.columnWidths.length>=t?e.columnWidths[t]:"100%",I=function(t){let l=!(arguments.length>1)||void 0===arguments[1]||arguments[1];(void 0===e.onRowClick||!0!==l||!1!==e.onRowClick(t))&&h({type:"OPEN_FORM",payload:{editRecordId:null!=t&&f.metadata?t[f.metadata.primaryKey]:null}})},C=()=>{h({type:"CLOSE_FORM"})},E=async e=>{null!=f.data.orderBy&&f.data.orderBy.length>0&&f.data.orderBy[0].field===e&&"asc"===f.data.orderBy[0].order?j({...u,page:f.data.currentPage,orderBy:[{field:e,order:"desc"}],setData:!0}):j({...u,page:f.data.currentPage,orderBy:[{field:e,order:"asc"}],setData:!0})};(0,i.useEffect)(()=>{v.current=f},[f.data]),(0,i.useEffect)(()=>{void 0!==e.tableName&&y()},[e.tableName,e.disabledMessage,f.visibleFields]),(0,i.useEffect)(()=>{if(null!=e.refreshInterval){let t=setInterval(async()=>{!1===x.current&&(x.current=!0,await N(!1),x.current=!1)},e.refreshInterval);return()=>{x.current=!1,clearInterval(t)}}},[e.refreshInterval]);let A={refresh:N,openForm:e=>I(e,!1),dataTableId:c,getRecords:()=>{var e;return null==(e=f.data)?void 0:e.results},setRecords:e=>{h({type:"SET_DATA",payload:{setDataFunction:e}})},showLoading:()=>{h({type:"SET_IS_LOADING"})},sort:E,Metadata:f.metadata};return(null!=r&&r.formBuilder.addDataTable(A),(0,i.useImperativeHandle)(t,()=>A),!0===f.isTableNotFound)?(0,a.jsx)("div",{className:"w-full h-full flex justify-center items-center",children:"Table not found."}):(0,a.jsxs)(em.Provider,{value:{props:e,state:f,refHandle:A,dispatch:h,openForm:I,closeForm:C,refresh:N,formDisclosure:{opened:f.isFormOpen,close:C},getData:j,getFields:()=>{if(null!=f.visibleFields)return f.visibleFields.map((e,t)=>{var l;let a=null==(l=f.metadata)?void 0:l.fields.find(t=>t.name===e);return null==a?null:{displayName:null==a?void 0:a.displayName,metadataField:a,body:null,width:"100%",alias:""}}).filter(p.Pe);if(null!=e.fields&&null!=f.metadata)return e.fields.filter(e=>{var t;return e!==(null==(t=f.metadata)?void 0:t.primaryKey)}).map((t,l)=>{if("string"==typeof t){let s=t,i=f.metadata,r="";if(t.includes(".")){var a;let l=t.split(".");r=l[0],s=l[1];let n=null==(a=e.joins)?void 0:a.find(e=>e.alias===r);null!=n&&(i=f.joinMetadata.find(e=>e.tableName===n.toTable))}let n=null==i?void 0:i.fields.find(e=>e.name===s);return null==n?null:{displayName:s,metadataField:n,body:null,width:w(l),alias:r}}return"object"==typeof t?{displayName:t.header,body:t.body,width:w(l),alias:""}:null}).filter(p.Pe);if(null==e.fields&&null!=f.metadata){var t;return null==(t=f.metadata)?void 0:t.fields.filter(e=>{var t;return e.name!==(null==(t=f.metadata)?void 0:t.primaryKey)}).map((e,t)=>t<=6?{displayName:e.name,metadataField:e,body:null,width:w(t),alias:""}:null).filter(p.Pe)}return[]},sort:E},children:[f.isFormOpen&&(0,a.jsx)(ee,{ref:d}),f.data&&(0,a.jsx)(z,{children:(0,a.jsx)(ec,{})})]})});ep.displayName="DataTable";let eh=ep},9692:(e,t,l)=>{"use strict";l.d(t,{Ay:()=>n,cK:()=>i,xW:()=>r});var a=l(6514),s=l(5834);let i=s.createContext(null),r=()=>{let e=s.useContext(i);if(!e)throw Error("useFormContext must be used within a FormContextProvider");return e},n=e=>(0,a.jsx)(i.Provider,{value:{formBuilder:e.formBuilder},children:e.children})}},e=>{e.O(0,[31,352,864,964,291,991,255,593,792],()=>e(e.s=8002)),_N_E=e.O()}]);